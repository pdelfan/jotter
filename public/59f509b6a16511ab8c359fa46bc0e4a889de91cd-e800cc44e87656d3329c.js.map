{"version":3,"sources":["webpack://jotter/./node_modules/@babel/runtime/helpers/typeof.js","webpack://jotter/./node_modules/core-js/internals/classof.js","webpack://jotter/./node_modules/core-js/internals/create-property.js","webpack://jotter/./node_modules/core-js/internals/function-bind-context.js","webpack://jotter/./node_modules/core-js/internals/get-iterator-method.js","webpack://jotter/./node_modules/core-js/internals/is-array-iterator-method.js","webpack://jotter/./node_modules/core-js/internals/iterate.js","webpack://jotter/./node_modules/core-js/internals/iterator-close.js","webpack://jotter/./node_modules/core-js/internals/iterators.js","webpack://jotter/./node_modules/core-js/internals/to-string-tag-support.js","webpack://jotter/./node_modules/core-js/modules/es.object.from-entries.js","webpack://jotter/./src/components/Book/LibraryBook.js","webpack://jotter/./src/components/Loading.js","webpack://jotter/./src/components/Routing.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/AwaitValue.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/AsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/asyncIterator.js","webpack://jotter/./node_modules/realm-web/dist/bundle.dom.es.js","webpack://jotter/./src/services/realm/userAuth.js","webpack://jotter/./src/pages/index.js","webpack://jotter/./src/assets/jotter-logo.svg","webpack://jotter/./src/pages/library.js","webpack://jotter/./src/services/realm/API.js","webpack://jotter/./src/assets/loading.svg"],"names":["_typeof","obj","Symbol","iterator","module","exports","__esModule","constructor","prototype","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","CORRECT_ARGUMENTS","arguments","it","O","tag","result","undefined","key","error","tryGet","Object","callee","toPrimitive","definePropertyModule","createPropertyDescriptor","object","value","propertyKey","f","aFunction","fn","that","length","call","a","b","c","apply","classof","Iterators","ITERATOR","ArrayPrototype","Array","anObject","isArrayIteratorMethod","toLength","bind","getIteratorMethod","iteratorClose","Result","stopped","this","iterable","unboundFunction","options","iterFn","index","next","step","AS_ENTRIES","IS_ITERATOR","INTERRUPTED","stop","condition","callFn","TypeError","done","returnMethod","test","String","$","iterate","createProperty","target","stat","fromEntries","k","v","Book","styled","Info","BookLink","Link","BookItem","isbn","cover","title","author","date","isLink","percentageRead","children","to","ConditionalLink","state","src","alt","className","BookList","Wrapper","props","minHeight","Loading","RedirectHome","component","navigate","RedirectToLibrary","Component","path","rest","useAuth0","loading","isAuthenticated","loginWithRedirect","useEffect","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","e","_construct","Parent","args","Class","push","instance","Function","_wrapNativeSuper","_cache","Map","toString","indexOf","has","get","set","create","enumerable","writable","configurable","_inherits","subClass","superClass","_possibleConstructorReturn","self","ReferenceError","_slicedToArray","arr","i","isArray","_i","_s","_e","_arr","_n","_d","err","unsupportedIterableToArray","_objectWithoutProperties","source","excluded","objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_classCallCheck","Constructor","_defineProperties","descriptor","defineProperty","_createClass","protoProps","staticProps","_AwaitValue","wrapped","_awaitAsyncGenerator","AsyncGenerator","gen","front","back","resume","arg","wrappedAwait","Promise","resolve","then","settle","type","reject","_invoke","request","_wrapAsyncGenerator","_asyncIterator","method","asyncIterator","_DATA_MAPPING","_createForOfIteratorHelper","allowArrayLike","minLen","_arrayLikeToArray","n","slice","name","from","_unsupportedIterableToArray","F","s","normalCompletion","didErr","_e2","return","len","arr2","_createSuper","Derived","hasNativeReflectConstruct","Super","NewTarget","ownKeys","enumerableOnly","keys","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","forEach","getOwnPropertyDescriptors","defineProperties","__spreadArrays","il","r","j","jl","BrowserInfo","version","os","NodeInfo","process","platform","SearchBotDeviceInfo","bot","BotInfo","ReactNativeInfo","SEARCHBOT_OS_REGEX","userAgentRules","operatingSystemRules","parseUserAgent","ua","matchedRule","reduce","matched","_a","browser","regex","uaMatch","exec","matchUserAgent","match","versionParts","split","count","output","ii","createVersionParts","join","detectOS","searchBotMatch","DefaultNetworkTransport","fetch","Error","AbortController","_fetch","handler","_ref","_callee","response","decodedBody","responseHeaders","_context","prev","text","sent","headers","abrupt","statusCode","status","body","_x","onSuccess","catch","onError","_callee2","timeoutMs","url","_this$createTimeoutSi","signal","cancelTimeout","_context2","createTimeoutSignal","finish","_x2","controller","timeout","setTimeout","abort","clearTimeout","DEFAULT_HEADERS","window","commonjsGlobal","globalThis","g","basedir","UserType","DataKey","base64","global","fromUint8Array","_Base64","Base64","b64chars","b64tab","bin","t","l","charAt","fromCharCode","cb_utob","cc","charCodeAt","re_utob","utob","u","replace","cb_encode","ccc","padlen","ord","btoa","RangeError","_encode","mkUriSafe","b64","m0","encode","urisafe","encodeURI","Uint8Array","a0","a1","a2","toUint8Array","re_btou","cb_btou","cccc","offset","btou","cb_decode","chars","_atob","atob","_decode","_fromURI","decode","noConflict","VERSION","fromBase64","toBase64","noEnum","extendString","factory","require","base","commonjsRequire","SERIALIZATION_OPTIONS","relaxed","serialize","deserialize","map","doc","DATA_MAPPING","NAME","EMAIL","PICTURE","FIRST_NAME","LAST_NAME","GENDER","BIRTHDAY","MIN_AGE","MAX_AGE","UserProfile","Normal","identities","data","identity","id","providerType","mappedData","entries","_ref2","_ref3","PrefixedStorage","storage","keyPart","PART_SEPARATOR","remove","prefix","clear","listener","addListener","ACCESS_TOKEN_STORAGE_KEY","REFRESH_TOKEN_STORAGE_KEY","PROFILE_STORAGE_KEY","PROVIDER_TYPE_STORAGE_KEY","UserStorage","_PrefixedStorage","_super","userId","concat","profile","assign","JSON","parse","stringify","removeKeysWithUndefinedValues","entry","encodeQueryString","params","prefixed","cleanedParams","_ref4","_ref5","encodeURIComponent","RESERVED_NAMES","getOwnPropertyNames","cleanArgsAndSerialize","_step2","_iterator2","_Object$entries","_Object$entries$_i","cleanArgs","FunctionsFactory","fetcher","config","serviceName","argsTransformation","_callFunction","_callee3","_len","_key","appRoute","_args3","_context3","service","fetchJSON","functionsCall","_x3","_len2","_key2","qs","fetchStream","p","receiver","callFunction","prop","EmailPasswordAuth","providerName","_callResetPasswordFunction","_sendResetPasswordEmail","_resetPassword","_resendConfirmationEmail","_confirmUser","_registerUser","_callee4","email","password","_context4","emailPasswordAuth","register","_x4","_x5","_callee5","token","tokenId","_context5","confirm","_x6","_x7","_callee6","_context6","confirmSend","_x8","_callee7","_context7","reset","_x9","_x10","_x11","_callee8","_context8","resetSend","_x12","_callee9","_len3","_key3","_args9","_context9","resetCall","_x13","_x14","routes","api","app","appId","location","authProvider","login","auth","apiKeys","enable","disable","session","ApiKeyAuth","_disable","_enable","_delete2","tokenType","keyId","_callee10","_context10","_x15","_callee11","_context11","_x16","_callee12","_context12","_x17","environment","getEnvironment","WatchStreamState","WatchError","_Error","_super2","_ref8","_this2","message","code","WatchStream","_state","NEED_DATA","_error","_textDecoder","_buffer","_bufferOffset","_eventType","_dataBuffer","buffer","assertState","stream","advanceBufferState","line","endsWith","substr","feedSse","eventType","colon","field","startsWith","sse","firstPercentIndex","start","percentIndex","encoded","HAVE_ERROR","_EJSON$parse","errorCode","error_code","_unused2","parsed","_nextEvent","HAVE_EVENT","_unused","out","nextNewlineIndex","feedLine","MongoDBCollection","databaseName","collectionName","functions","find","database","collection","query","project","projection","sort","limit","findOne","update","findOneAndUpdate","upsert","returnNewDocument","replacement","findOneAndReplace","pipeline","aggregate","document","insertOne","documents","insertMany","deleteOne","deleteMany","updateOne","updateMany","_this","_ref9","ids","_callee13","watchStream","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_value","chunk","_context13","callFunctionStreaming","feedBuffer","nextEvent","t0","createCollection","createDatabase","UserState","UserType$1","User","parameters","_accessToken","accessToken","_refreshToken","refreshToken","_profile","clone","userContext","currentUser","_refreshCustomData","_refreshAccessToken","_linkCredentials","_logOut","_refreshProfile","allUsers","LoggedOut","Active","Removed","decodeAccessToken","userData","payload","deviceId","_callee14","_context14","_callee15","_context15","_callee16","credentials","details","_context16","authenticator","authenticate","refreshProfile","_x18","_callee17","_context17","access_token","_callee18","_context18","refreshAccessToken","customData","_this$functions","_len4","_key4","db","createService","parts","encodedPayload","decodedPayload","parsedPayload","expires","exp","issuedAt","iat","subject","sub","_parsedPayload$user_d","user_data","Credentials","username","derivePayload","includes","redirectUrl","authCode","idToken","id_token","redirectUrlOrAccessToken","redirectUrlOrIdToken","USER_IDS_STORAGE_KEY","DEVICE_ID_STORAGE_KEY","AppStorage","_PrefixedStorage2","_super3","userIdsString","userIds","Set","mergeWithExisting","_step3","_iterator3","getUserIds","setUserIds","REDIRECT_HASH_TO_RESULT","_stitch_client_app_id","_baas_client_app_id","_stitch_ua","_baas_ua","_stitch_link","_baas_link","_stitch_error","_baas_error","_stitch_state","_baas_state","OAuth2Helper","openWindow","_this3","stateStorage","getStateStorage","windowClosedInterval","redirectWindow","handleStorageUpdate","parsedResult","removeListener","clearInterval","close","console","warn","setInterval","closed","alphabet","Math","floor","random","generateRandomString","queryString","str","cleanStr","kvp","_ref6","_ref7","decodeURIComponent","_i2","_Object$entries2","_Object$entries2$_i","defaultStorage","parseRedirectLocation","oauth2Storage","authInfo","_parts","REDIRECT_LOCATION_HEADER","Authenticator","getDeviceInformation","oauth2","_openWindowAndWaitForAuthResponse","_getLogInUrl","_authenticate","_callee19","linkingUser","deviceInformation","isLinking","logInUrl","_response","_response$refresh_tok","_context19","generateState","getLogInUrl","redirect","providerRedirectHeader","device","user","mode","openWindowAndWaitForAuthResponse","toJSON","user_id","refresh_token","device_id","_x19","_x20","_callee20","link","extraQueryParams","loginRoute","locationUrl","_args20","_context20","_x21","_callee21","redirectResult","_context21","openWindowAndWaitForRedirect","decodeAuthInfo","userAuth","_x22","_x23","MongoDBRealmError","_Error2","_fromRequestAndResponse","_super4","statusText","_this4","summary","_callee22","_context22","json","_x24","_x25","asyncIteratorFromResponseBody","reader","getReader","read","_callee23","_context23","cancel","DeviceFields","Fetcher","_ref11","transport","locationUrlContext","_fetchStream","_fetchJSON","_fetch2","_callee24","_request$tokenType","_request$user","restOfRequest","_url","_context24","t1","buildAuthorizationHeader","ok","fromRequestAndResponse","_x26","_callee25","serializedBody","contentTypeHeaders","contentType","responseBody","_context25","buildBody","buildJsonHeader","Accept","_x27","_callee26","_yield$this$fetch","_context26","_x28","Authorization","log","DEVICE_ID_STORAGE_KEY$1","DeviceInformation","_ref12","appVersion","sdkVersion","platformVersion","App","idOrConfiguration","_this5","users","_locationUrl","configuration","baseUrl","localApp","_configuration$transp","baseStorage","hydrate","_removeUser","_logIn","nextUser","findIndex","splice","unshift","_callee27","fetchProfile","_args27","_context27","createOrUpdateUser","switchUser","_x29","_callee28","_context28","logOut","removeUserId","_x30","activeUsers","_this6","_ref13","hostname","deviceIdStr","getDeviceId","existingUser","_this7","appCache","userAgent","LocalStorage","localStorage","getItem","setItem","removeItem","_i3","_keys","_key5","addEventListener","removeEventListener","navigator","product","environment$1","open","TextDecoder","Realm","apiKey","MDB_AUTH_USER","logIn","Logo","Greeting","LoginBtn","LoginButton","handleSignIn","Login","onClick","isLoading","LoadingIcon","Router","Library","useState","libraryBooks","setLibraryBooks","isFetching","setIsFetching","getLibrary","nickname","heading","subheading","book","bookTitle","shouldHover","year","axios","baseurl","books","library","addBookToLibrary","addDate","bookAuthor","bookYear","bookCover","bookAddedDate","bookIsbn","getToRead","toRead","addBookToToRead","updatePercentageRead","readPercentage","bookID","getPercentageRead"],"mappings":"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","file":"59f509b6a16511ab8c359fa46bc0e4a889de91cd-e800cc44e87656d3329c.js","sourcesContent":["function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var classof = require('../internals/classof');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","var anObject = require('../internals/an-object');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that, 1 + AS_ENTRIES + INTERRUPTED);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (typeof iterFn != 'function') throw TypeError('Target is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = toLength(iterable.length); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && result instanceof Result) return result;\n      } return new Result(false);\n    }\n    iterator = iterFn.call(iterable);\n  }\n\n  next = iterator.next;\n  while (!(step = next.call(iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator);\n      throw error;\n    }\n    if (typeof result == 'object' && result && result instanceof Result) return result;\n  } return new Result(false);\n};\n","var anObject = require('../internals/an-object');\n\nmodule.exports = function (iterator) {\n  var returnMethod = iterator['return'];\n  if (returnMethod !== undefined) {\n    return anObject(returnMethod.call(iterator)).value;\n  }\n};\n","module.exports = {};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { Link } from \"gatsby\";\n\nconst Book = styled.div`\n  transition: 0.2s;\n  flex: 0 0 17rem;\n\n  .cover {\n    box-shadow: var(--book-shadow);\n    border: var(--book-border);\n    border-radius: var(--book-round);\n    max-height: 200px;\n  }\n\n  h3 {\n    font-weight: 600;\n    color: var(--book-title);\n    line-height: 1.5rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.3rem;\n  }\n\n  h4 {\n    font-size: 0.8rem;\n    font-weight: 600;\n    color: var(--book-author);\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n  }\n\n  h5 {\n    font-weight: 500;\n    color: var(--book-date);\n    margin-top: 0;\n  }\n`;\n\nconst Info = styled.div`\n  max-width: 14rem;\n  word-wrap: break-word;\n`;\n\nconst BookLink = styled(Link)`\n  transition: 0.2s;\n  flex: 0 1 17rem;\n  margin-bottom: 10rem;\n\n  &:hover {\n    transform: translateY(-0.5rem);\n    transition: 0.2s;\n  }\n`;\n\nexport default function BookItem({\n  isbn,\n  cover,\n  title,\n  author,\n  date,\n  isLink,\n  percentageRead,\n  children,\n  to,\n}) {\n  const ConditionalLink = ({ children, to, isLink }) =>\n    isLink ? (\n      <BookLink to={to} state={{ isbn: isbn, percentageRead: percentageRead }}>\n        {children}\n      </BookLink>\n    ) : (\n      <>{children}</>\n    );\n\n  return (\n    <ConditionalLink isLink={isLink} to={to}>\n      <Book>\n        <img src={cover} alt=\"Book cover\" className=\"cover\" />\n        <Info>\n          <h3>{title}</h3>\n          <h4>{author}</h4>\n          <h5>{date}</h5>\n        </Info>\n        {children}\n      </Book>\n    </ConditionalLink>\n  );\n}\n\nexport const BookList = styled.div`\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  margin-top: 5rem;\n`;\n","import styled from \"styled-components\";\n\nexport const Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: ${(props) => props.minHeight || \"50rem\"};\n`;\n\nexport const Loading = styled.img`\n  width: 8rem;\n  margin: 1rem auto 1rem auto;\n  -webkit-animation: spin 4s linear infinite;\n  -moz-animation: spin 4s linear infinite;\n  animation: spin 4s linear infinite;\n  min-height: ${(props) => props.minHeight || \"50rem\"};\n`;\n","import React, { useEffect } from \"react\";\nimport { useAuth0 } from \"../services/auth\";\nimport { navigate } from \"gatsby\";\nimport Library from \"../pages/library\";\n\n// redirect\n\nexport const RedirectHome = ({ component: Component, ...rest }) => {\n  navigate(\"/\");\n  return <Library />;\n};\n\n// redirect if user isn't logged in (authenticated)\n\nexport const RedirectToLibrary = ({ component: Component, path, ...rest }) => {\n  const { loading, isAuthenticated, loginWithRedirect } = useAuth0();\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      return;\n    }\n    navigate(\"/library\");\n  }, [loading, isAuthenticated, loginWithRedirect, path]);\n\n  return isAuthenticated === true ? <Component {...rest} /> : null;\n};\n\nconst PrivateRoute = ({ component: Component, path, ...rest }) => {\n  const { loading, isAuthenticated, loginWithRedirect } = useAuth0();\n\n  useEffect(() => {\n    if (loading || isAuthenticated) {\n      return;\n    }\n    navigate(\"/\");\n  }, [loading, isAuthenticated, loginWithRedirect, path]);\n\n  return isAuthenticated === true ? <Component {...rest} /> : null;\n};\n\nexport default PrivateRoute;\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _AwaitValue(value) {\n  this.wrapped = value;\n}","import AwaitValue from \"./AwaitValue.js\";\nexport default function _awaitAsyncGenerator(value) {\n  return new AwaitValue(value);\n}","import AwaitValue from \"./AwaitValue.js\";\nexport default function AsyncGenerator(gen) {\n  var front, back;\n\n  function send(key, arg) {\n    return new Promise(function (resolve, reject) {\n      var request = {\n        key: key,\n        arg: arg,\n        resolve: resolve,\n        reject: reject,\n        next: null\n      };\n\n      if (back) {\n        back = back.next = request;\n      } else {\n        front = back = request;\n        resume(key, arg);\n      }\n    });\n  }\n\n  function resume(key, arg) {\n    try {\n      var result = gen[key](arg);\n      var value = result.value;\n      var wrappedAwait = value instanceof AwaitValue;\n      Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n        if (wrappedAwait) {\n          resume(key === \"return\" ? \"return\" : \"next\", arg);\n          return;\n        }\n\n        settle(result.done ? \"return\" : \"normal\", arg);\n      }, function (err) {\n        resume(\"throw\", err);\n      });\n    } catch (err) {\n      settle(\"throw\", err);\n    }\n  }\n\n  function settle(type, value) {\n    switch (type) {\n      case \"return\":\n        front.resolve({\n          value: value,\n          done: true\n        });\n        break;\n\n      case \"throw\":\n        front.reject(value);\n        break;\n\n      default:\n        front.resolve({\n          value: value,\n          done: false\n        });\n        break;\n    }\n\n    front = front.next;\n\n    if (front) {\n      resume(front.key, front.arg);\n    } else {\n      back = null;\n    }\n  }\n\n  this._invoke = send;\n\n  if (typeof gen[\"return\"] !== \"function\") {\n    this[\"return\"] = undefined;\n  }\n}\n\nAsyncGenerator.prototype[typeof Symbol === \"function\" && Symbol.asyncIterator || \"@@asyncIterator\"] = function () {\n  return this;\n};\n\nAsyncGenerator.prototype.next = function (arg) {\n  return this._invoke(\"next\", arg);\n};\n\nAsyncGenerator.prototype[\"throw\"] = function (arg) {\n  return this._invoke(\"throw\", arg);\n};\n\nAsyncGenerator.prototype[\"return\"] = function (arg) {\n  return this._invoke(\"return\", arg);\n};","import AsyncGenerator from \"./AsyncGenerator.js\";\nexport default function _wrapAsyncGenerator(fn) {\n  return function () {\n    return new AsyncGenerator(fn.apply(this, arguments));\n  };\n}","export default function _asyncIterator(iterable) {\n  var method;\n\n  if (typeof Symbol !== \"undefined\") {\n    if (Symbol.asyncIterator) method = iterable[Symbol.asyncIterator];\n    if (method == null && Symbol.iterator) method = iterable[Symbol.iterator];\n  }\n\n  if (method == null) method = iterable[\"@@asyncIterator\"];\n  if (method == null) method = iterable[\"@@iterator\"];\n  if (method == null) throw new TypeError(\"Object is not async iterable\");\n  return method.call(iterable);\n}","import _wrapNativeSuper from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _toConsumableArray from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _inherits from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _awaitAsyncGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator\";\nimport _wrapAsyncGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator\";\nimport _asyncIterator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/asyncIterator\";\n\nvar _DATA_MAPPING;\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport \"core-js/modules/es.object.from-entries.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/regenerator\";\nimport { EJSON, ObjectId } from 'bson';\nimport * as bson from 'bson';\nexport { bson as BSON };\n\nvar __spreadArrays = undefined && undefined.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nvar BrowserInfo =\n/** @class */\nfunction () {\n  function BrowserInfo(name, version, os) {\n    this.name = name;\n    this.version = version;\n    this.os = os;\n    this.type = 'browser';\n  }\n\n  return BrowserInfo;\n}();\n\nvar NodeInfo =\n/** @class */\nfunction () {\n  function NodeInfo(version) {\n    this.version = version;\n    this.type = 'node';\n    this.name = 'node';\n    this.os = process.platform;\n  }\n\n  return NodeInfo;\n}();\n\nvar SearchBotDeviceInfo =\n/** @class */\nfunction () {\n  function SearchBotDeviceInfo(name, version, os, bot) {\n    this.name = name;\n    this.version = version;\n    this.os = os;\n    this.bot = bot;\n    this.type = 'bot-device';\n  }\n\n  return SearchBotDeviceInfo;\n}();\n\nvar BotInfo =\n/** @class */\nfunction () {\n  function BotInfo() {\n    this.type = 'bot';\n    this.bot = true; // NOTE: deprecated test name instead\n\n    this.name = 'bot';\n    this.version = null;\n    this.os = null;\n  }\n\n  return BotInfo;\n}();\n\nvar ReactNativeInfo =\n/** @class */\nfunction () {\n  function ReactNativeInfo() {\n    this.type = 'react-native';\n    this.name = 'react-native';\n    this.version = null;\n    this.os = null;\n  }\n\n  return ReactNativeInfo;\n}(); // tslint:disable-next-line:max-line-length\n\n\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\\ Jeeves\\/Teoma|ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [['aol', /AOLShield\\/([0-9\\._]+)/], ['edge', /Edge\\/([0-9\\._]+)/], ['edge-ios', /EdgiOS\\/([0-9\\._]+)/], ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/], ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/], ['samsung', /SamsungBrowser\\/([0-9\\.]+)/], ['silk', /\\bSilk\\/([0-9._-]+)\\b/], ['miui', /MiuiBrowser\\/([0-9\\.]+)$/], ['beaker', /BeakerBrowser\\/([0-9\\.]+)/], ['edge-chromium', /Edg\\/([0-9\\.]+)/], ['chromium-webview', /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/], ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/], ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/], ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/], ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/], ['fxios', /FxiOS\\/([0-9\\.]+)/], ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/], ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/], ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/], ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/], ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/], ['ie', /MSIE\\s(7\\.0)/], ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/], ['android', /Android\\s([0-9\\.]+)/], ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/], ['safari', /Version\\/([0-9\\._]+).*Safari/], ['facebook', /FBAV\\/([0-9\\.]+)/], ['instagram', /Instagram\\s([0-9\\.]+)/], ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/], ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/], ['searchbot', SEARCHBOX_UA_REGEX]];\nvar operatingSystemRules = [['iOS', /iP(hone|od|ad)/], ['Android OS', /Android/], ['BlackBerry OS', /BlackBerry|BB10/], ['Windows Mobile', /IEMobile/], ['Amazon OS', /Kindle/], ['Windows 3.11', /Win16/], ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/], ['Windows 98', /(Windows 98)|(Win98)/], ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/], ['Windows XP', /(Windows NT 5.1)|(Windows XP)/], ['Windows Server 2003', /(Windows NT 5.2)/], ['Windows Vista', /(Windows NT 6.0)/], ['Windows 7', /(Windows NT 6.1)/], ['Windows 8', /(Windows NT 6.2)/], ['Windows 8.1', /(Windows NT 6.3)/], ['Windows 10', /(Windows NT 10.0)/], ['Windows ME', /Windows ME/], ['Open BSD', /OpenBSD/], ['Sun OS', /SunOS/], ['Chrome OS', /CrOS/], ['Linux', /(Linux)|(X11)/], ['Mac OS', /(Mac_PowerPC)|(Macintosh)/], ['QNX', /QNX/], ['BeOS', /BeOS/], ['OS/2', /OS\\/2/]];\n\nfunction detect(userAgent) {\n  if (!!userAgent) {\n    return parseUserAgent(userAgent);\n  }\n\n  if (typeof document === 'undefined' && typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    return new ReactNativeInfo();\n  }\n\n  if (typeof navigator !== 'undefined') {\n    return parseUserAgent(navigator.userAgent);\n  }\n\n  return getNodeVersion();\n}\n\nfunction matchUserAgent(ua) {\n  // opted for using reduce here rather than Array#first with a regex.test call\n  // this is primarily because using the reduce we only perform the regex\n  // execution once rather than once for the test and for the exec again below\n  // probably something that needs to be benchmarked though\n  return ua !== '' && userAgentRules.reduce(function (matched, _a) {\n    var browser = _a[0],\n        regex = _a[1];\n\n    if (matched) {\n      return matched;\n    }\n\n    var uaMatch = regex.exec(ua);\n    return !!uaMatch && [browser, uaMatch];\n  }, false);\n}\n\nfunction parseUserAgent(ua) {\n  var matchedRule = matchUserAgent(ua);\n\n  if (!matchedRule) {\n    return null;\n  }\n\n  var name = matchedRule[0],\n      match = matchedRule[1];\n\n  if (name === 'searchbot') {\n    return new BotInfo();\n  }\n\n  var versionParts = match[1] && match[1].split(/[._]/).slice(0, 3);\n\n  if (versionParts) {\n    if (versionParts.length < REQUIRED_VERSION_PARTS) {\n      versionParts = __spreadArrays(versionParts, createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length));\n    }\n  } else {\n    versionParts = [];\n  }\n\n  var version = versionParts.join('.');\n  var os = detectOS(ua);\n  var searchBotMatch = SEARCHBOT_OS_REGEX.exec(ua);\n\n  if (searchBotMatch && searchBotMatch[1]) {\n    return new SearchBotDeviceInfo(name, version, os, searchBotMatch[1]);\n  }\n\n  return new BrowserInfo(name, version, os);\n}\n\nfunction detectOS(ua) {\n  for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n    var _a = operatingSystemRules[ii],\n        os = _a[0],\n        regex = _a[1];\n    var match = regex.exec(ua);\n\n    if (match) {\n      return os;\n    }\n  }\n\n  return null;\n}\n\nfunction getNodeVersion() {\n  var isNode = typeof process !== 'undefined' && process.version;\n  return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\n\nfunction createVersionParts(count) {\n  var output = [];\n\n  for (var ii = 0; ii < count; ii++) {\n    output.push('0');\n  }\n\n  return output;\n} ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar DefaultNetworkTransport = /*#__PURE__*/function () {\n  function DefaultNetworkTransport() {\n    _classCallCheck(this, DefaultNetworkTransport);\n\n    if (!DefaultNetworkTransport.fetch) {\n      throw new Error(\"DefaultNetworkTransport.fetch must be set before it's used\");\n    }\n\n    if (!DefaultNetworkTransport.AbortController) {\n      throw new Error(\"DefaultNetworkTransport.AbortController must be set before it's used\");\n    }\n  }\n\n  _createClass(DefaultNetworkTransport, [{\n    key: \"fetchWithCallbacks\",\n    value: function fetchWithCallbacks(request, handler) {\n      // tslint:disable-next-line: no-console\n      this.fetch(request).then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(response) {\n          var decodedBody, responseHeaders;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return response.text();\n\n                case 2:\n                  decodedBody = _context.sent;\n                  // Pull out the headers of the response\n                  responseHeaders = {};\n                  response.headers.forEach(function (value, key) {\n                    responseHeaders[key] = value;\n                  });\n                  return _context.abrupt(\"return\", {\n                    statusCode: response.status,\n                    headers: responseHeaders,\n                    body: decodedBody\n                  });\n\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).then(function (r) {\n        return handler.onSuccess(r);\n      }).catch(function (e) {\n        return handler.onError(e);\n      });\n    }\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(request) {\n        var timeoutMs, url, rest, _this$createTimeoutSi, signal, cancelTimeout;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                timeoutMs = request.timeoutMs, url = request.url, rest = _objectWithoutProperties(request, [\"timeoutMs\", \"url\"]);\n                _this$createTimeoutSi = this.createTimeoutSignal(timeoutMs), signal = _this$createTimeoutSi.signal, cancelTimeout = _this$createTimeoutSi.cancelTimeout;\n                _context2.prev = 2;\n                _context2.next = 5;\n                return DefaultNetworkTransport.fetch(url, _objectSpread({\n                  signal: signal\n                }, rest));\n\n              case 5:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 6:\n                _context2.prev = 6;\n                // Whatever happens, cancel any timeout\n                cancelTimeout();\n                return _context2.finish(6);\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2,, 6, 9]]);\n      }));\n\n      function fetch(_x2) {\n        return _fetch.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"createTimeoutSignal\",\n    value: function createTimeoutSignal(timeoutMs) {\n      if (typeof timeoutMs === \"number\") {\n        var controller = new DefaultNetworkTransport.AbortController(); // Call abort after a specific number of milliseconds\n\n        var timeout = setTimeout(function () {\n          controller.abort();\n        }, timeoutMs);\n        return {\n          signal: controller.signal,\n          cancelTimeout: function cancelTimeout() {\n            clearTimeout(timeout);\n          }\n        };\n      } else {\n        return {\n          signal: undefined,\n          cancelTimeout: function cancelTimeout() {\n            /* No-op */\n          }\n        };\n      }\n    }\n  }]);\n\n  return DefaultNetworkTransport;\n}();\n\nDefaultNetworkTransport.DEFAULT_HEADERS = {\n  \"Content-Type\": \"application/json\"\n}; ////////////////////////////////////////////////////////////////////////////\n\nDefaultNetworkTransport.fetch = window.fetch.bind(window);\nDefaultNetworkTransport.AbortController = window.AbortController;\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, basedir, module) {\n  return module = {\n    path: basedir,\n    exports: {},\n    require: function require(path, base) {\n      return commonjsRequire(path, base === undefined || base === null ? module.path : base);\n    }\n  }, fn(module, module.exports), module.exports;\n}\n\nfunction commonjsRequire() {\n  throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');\n}\n\nvar base64 = createCommonjsModule(function (module, exports) {\n  (function (global, factory) {\n    module.exports = factory(global);\n  })(typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : typeof commonjsGlobal !== 'undefined' ? commonjsGlobal : commonjsGlobal, function (global) {\n    // existing version for noConflict()\n    global = global || {};\n    var _Base64 = global.Base64;\n    var version = \"2.6.4\"; // constants\n\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n    var b64tab = function (bin) {\n      var t = {};\n\n      for (var i = 0, l = bin.length; i < l; i++) {\n        t[bin.charAt(i)] = i;\n      }\n\n      return t;\n    }(b64chars);\n\n    var fromCharCode = String.fromCharCode; // encoder stuff\n\n    var cb_utob = function cb_utob(c) {\n      if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c : cc < 0x800 ? fromCharCode(0xc0 | cc >>> 6) + fromCharCode(0x80 | cc & 0x3f) : fromCharCode(0xe0 | cc >>> 12 & 0x0f) + fromCharCode(0x80 | cc >>> 6 & 0x3f) + fromCharCode(0x80 | cc & 0x3f);\n      } else {\n        var cc = 0x10000 + (c.charCodeAt(0) - 0xD800) * 0x400 + (c.charCodeAt(1) - 0xDC00);\n        return fromCharCode(0xf0 | cc >>> 18 & 0x07) + fromCharCode(0x80 | cc >>> 12 & 0x3f) + fromCharCode(0x80 | cc >>> 6 & 0x3f) + fromCharCode(0x80 | cc & 0x3f);\n      }\n    };\n\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n\n    var utob = function utob(u) {\n      return u.replace(re_utob, cb_utob);\n    };\n\n    var cb_encode = function cb_encode(ccc) {\n      var padlen = [0, 2, 1][ccc.length % 3],\n          ord = ccc.charCodeAt(0) << 16 | (ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8 | (ccc.length > 2 ? ccc.charCodeAt(2) : 0),\n          chars = [b64chars.charAt(ord >>> 18), b64chars.charAt(ord >>> 12 & 63), padlen >= 2 ? '=' : b64chars.charAt(ord >>> 6 & 63), padlen >= 1 ? '=' : b64chars.charAt(ord & 63)];\n      return chars.join('');\n    };\n\n    var btoa = global.btoa && typeof global.btoa == 'function' ? function (b) {\n      return global.btoa(b);\n    } : function (b) {\n      if (b.match(/[^\\x00-\\xFF]/)) throw new RangeError('The string contains invalid characters.');\n      return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n\n    var _encode = function _encode(u) {\n      return btoa(utob(String(u)));\n    };\n\n    var mkUriSafe = function mkUriSafe(b64) {\n      return b64.replace(/[+\\/]/g, function (m0) {\n        return m0 == '+' ? '-' : '_';\n      }).replace(/=/g, '');\n    };\n\n    var encode = function encode(u, urisafe) {\n      return urisafe ? mkUriSafe(_encode(u)) : _encode(u);\n    };\n\n    var encodeURI = function encodeURI(u) {\n      return encode(u, true);\n    };\n\n    var fromUint8Array;\n    if (global.Uint8Array) fromUint8Array = function fromUint8Array(a, urisafe) {\n      // return btoa(fromCharCode.apply(null, a));\n      var b64 = '';\n\n      for (var i = 0, l = a.length; i < l; i += 3) {\n        var a0 = a[i],\n            a1 = a[i + 1],\n            a2 = a[i + 2];\n        var ord = a0 << 16 | a1 << 8 | a2;\n        b64 += b64chars.charAt(ord >>> 18) + b64chars.charAt(ord >>> 12 & 63) + (typeof a1 != 'undefined' ? b64chars.charAt(ord >>> 6 & 63) : '=') + (typeof a2 != 'undefined' ? b64chars.charAt(ord & 63) : '=');\n      }\n\n      return urisafe ? mkUriSafe(b64) : b64;\n    }; // decoder stuff\n\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\n\n    var cb_btou = function cb_btou(cccc) {\n      switch (cccc.length) {\n        case 4:\n          var cp = (0x07 & cccc.charCodeAt(0)) << 18 | (0x3f & cccc.charCodeAt(1)) << 12 | (0x3f & cccc.charCodeAt(2)) << 6 | 0x3f & cccc.charCodeAt(3),\n              offset = cp - 0x10000;\n          return fromCharCode((offset >>> 10) + 0xD800) + fromCharCode((offset & 0x3FF) + 0xDC00);\n\n        case 3:\n          return fromCharCode((0x0f & cccc.charCodeAt(0)) << 12 | (0x3f & cccc.charCodeAt(1)) << 6 | 0x3f & cccc.charCodeAt(2));\n\n        default:\n          return fromCharCode((0x1f & cccc.charCodeAt(0)) << 6 | 0x3f & cccc.charCodeAt(1));\n      }\n    };\n\n    var btou = function btou(b) {\n      return b.replace(re_btou, cb_btou);\n    };\n\n    var cb_decode = function cb_decode(cccc) {\n      var len = cccc.length,\n          padlen = len % 4,\n          n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0) | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0) | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0) | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\n          chars = [fromCharCode(n >>> 16), fromCharCode(n >>> 8 & 0xff), fromCharCode(n & 0xff)];\n      chars.length -= [0, 0, 2, 1][padlen];\n      return chars.join('');\n    };\n\n    var _atob = global.atob && typeof global.atob == 'function' ? function (a) {\n      return global.atob(a);\n    } : function (a) {\n      return a.replace(/\\S{1,4}/g, cb_decode);\n    };\n\n    var atob = function atob(a) {\n      return _atob(String(a).replace(/[^A-Za-z0-9\\+\\/]/g, ''));\n    };\n\n    var _decode = function _decode(a) {\n      return btou(_atob(a));\n    };\n\n    var _fromURI = function _fromURI(a) {\n      return String(a).replace(/[-_]/g, function (m0) {\n        return m0 == '-' ? '+' : '/';\n      }).replace(/[^A-Za-z0-9\\+\\/]/g, '');\n    };\n\n    var decode = function decode(a) {\n      return _decode(_fromURI(a));\n    };\n\n    var toUint8Array;\n    if (global.Uint8Array) toUint8Array = function toUint8Array(a) {\n      return Uint8Array.from(atob(_fromURI(a)), function (c) {\n        return c.charCodeAt(0);\n      });\n    };\n\n    var noConflict = function noConflict() {\n      var Base64 = global.Base64;\n      global.Base64 = _Base64;\n      return Base64;\n    }; // export Base64\n\n\n    global.Base64 = {\n      VERSION: version,\n      atob: atob,\n      btoa: btoa,\n      fromBase64: decode,\n      toBase64: encode,\n      utob: utob,\n      encode: encode,\n      encodeURI: encodeURI,\n      btou: btou,\n      decode: decode,\n      noConflict: noConflict,\n      fromUint8Array: fromUint8Array,\n      toUint8Array: toUint8Array\n    }; // if ES5 is available, make Base64.extendString() available\n\n    if (typeof Object.defineProperty === 'function') {\n      var noEnum = function noEnum(v) {\n        return {\n          value: v,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        };\n      };\n\n      global.Base64.extendString = function () {\n        Object.defineProperty(String.prototype, 'fromBase64', noEnum(function () {\n          return decode(this);\n        }));\n        Object.defineProperty(String.prototype, 'toBase64', noEnum(function (urisafe) {\n          return encode(this, urisafe);\n        }));\n        Object.defineProperty(String.prototype, 'toBase64URI', noEnum(function () {\n          return encode(this, true);\n        }));\n      };\n    } //\n    // export Base64 to the namespace\n    //\n\n\n    if (global['Meteor']) {\n      // Meteor.js\n      Base64 = global.Base64;\n    } // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n\n\n    if (module.exports) {\n      module.exports.Base64 = global.Base64;\n    } // that's it!\n\n\n    return {\n      Base64: global.Base64\n    };\n  });\n}); ////////////////////////////////////////////////////////////////////////////\n\nvar SERIALIZATION_OPTIONS = {\n  relaxed: false\n};\n/**\n * Serialize an object containing BSON types into extended-JSON.\n *\n * @param obj The object containing BSON types.\n * @returns The document in extended-JSON format.\n */\n\nfunction serialize(obj) {\n  return EJSON.serialize(obj, SERIALIZATION_OPTIONS);\n}\n/**\n * De-serialize an object or an array of object from extended-JSON into an object or an array of object with BSON types.\n *\n * @param obj The object or array of objects in extended-JSON format.\n * @returns The object or array of objects with inflated BSON types.\n */\n\n\nfunction deserialize(obj) {\n  if (Array.isArray(obj)) {\n    return obj.map(function (doc) {\n      return EJSON.deserialize(doc);\n    });\n  } else {\n    return EJSON.deserialize(obj);\n  }\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * The type of a user.\n */\n\n\nvar UserType;\n\n(function (UserType) {\n  /**\n   * A normal end-user created this user.\n   */\n  UserType[\"Normal\"] = \"normal\";\n  /**\n   * The user was created by the server.\n   */\n\n  UserType[\"Server\"] = \"server\";\n})(UserType || (UserType = {}));\n/** @ignore */\n\n\nvar DataKey;\n\n(function (DataKey) {\n  /** @ignore */\n  DataKey[\"NAME\"] = \"name\";\n  /** @ignore */\n\n  DataKey[\"EMAIL\"] = \"email\";\n  /** @ignore */\n\n  DataKey[\"PICTURE\"] = \"picture\";\n  /** @ignore */\n\n  DataKey[\"FIRST_NAME\"] = \"first_name\";\n  /** @ignore */\n\n  DataKey[\"LAST_NAME\"] = \"last_name\";\n  /** @ignore */\n\n  DataKey[\"GENDER\"] = \"gender\";\n  /** @ignore */\n\n  DataKey[\"BIRTHDAY\"] = \"birthday\";\n  /** @ignore */\n\n  DataKey[\"MIN_AGE\"] = \"min_age\";\n  /** @ignore */\n\n  DataKey[\"MAX_AGE\"] = \"max_age\";\n})(DataKey || (DataKey = {}));\n\nvar DATA_MAPPING = (_DATA_MAPPING = {}, _defineProperty(_DATA_MAPPING, DataKey.NAME, \"name\"), _defineProperty(_DATA_MAPPING, DataKey.EMAIL, \"email\"), _defineProperty(_DATA_MAPPING, DataKey.PICTURE, \"pictureUrl\"), _defineProperty(_DATA_MAPPING, DataKey.FIRST_NAME, \"firstName\"), _defineProperty(_DATA_MAPPING, DataKey.LAST_NAME, \"lastName\"), _defineProperty(_DATA_MAPPING, DataKey.GENDER, \"gender\"), _defineProperty(_DATA_MAPPING, DataKey.BIRTHDAY, \"birthday\"), _defineProperty(_DATA_MAPPING, DataKey.MIN_AGE, \"minAge\"), _defineProperty(_DATA_MAPPING, DataKey.MAX_AGE, \"maxAge\"), _DATA_MAPPING);\n/** @inheritdoc */\n\nvar UserProfile =\n/**\n * @param response The response of a call fetching the users profile.\n */\nfunction UserProfile(response) {\n  _classCallCheck(this, UserProfile);\n\n  /** @ignore */\n  this.type = UserType.Normal;\n  /** @ignore */\n\n  this.identities = [];\n\n  if (typeof response === \"object\" && response !== null) {\n    var type = response.type,\n        identities = response.identities,\n        data = response.data;\n\n    if (typeof type === \"string\") {\n      this.type = type;\n    } else {\n      throw new Error(\"Expected 'type' in the response body\");\n    }\n\n    if (Array.isArray(identities)) {\n      this.identities = identities.map(function (identity) {\n        return {\n          id: identity.id,\n          providerType: identity[\"provider_type\"]\n        };\n      });\n    } else {\n      throw new Error(\"Expected 'identities' in the response body\");\n    }\n\n    if (typeof data === \"object\" && data !== null) {\n      var mappedData = Object.fromEntries(Object.entries(data).map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n            key = _ref3[0],\n            value = _ref3[1];\n\n        if (key in DATA_MAPPING) {\n          // Translate any known data field to its JS idiomatic alias\n          return [DATA_MAPPING[key], value];\n        } else {\n          // Pass through any other values\n          return [key, value];\n        }\n      })); // We can use `any` since we trust the user supplies the correct type\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      this.data = deserialize(mappedData);\n    } else {\n      throw new Error(\"Expected 'data' in the response body\");\n    }\n  } else {\n    this.data = {};\n  }\n}; ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * A `Storage` which will prefix a key part to every operation.\n */\n\n\nvar PrefixedStorage = /*#__PURE__*/function () {\n  /**\n   * Construct a `Storage` which will prefix a key part to every operation.\n   *\n   * @param storage The underlying storage to use for operations.\n   * @param keyPart The part of the key to prefix when performing operations.\n   */\n  function PrefixedStorage(storage, keyPart) {\n    _classCallCheck(this, PrefixedStorage);\n\n    this.storage = storage;\n    this.keyPart = keyPart;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(PrefixedStorage, [{\n    key: \"get\",\n    value: function get(key) {\n      return this.storage.get(this.keyPart + PrefixedStorage.PART_SEPARATOR + key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      return this.storage.set(this.keyPart + PrefixedStorage.PART_SEPARATOR + key, value);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"remove\",\n    value: function remove(key) {\n      return this.storage.remove(this.keyPart + PrefixedStorage.PART_SEPARATOR + key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"prefix\",\n    value: function prefix(keyPart) {\n      return new PrefixedStorage(this, keyPart);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      return this.storage.clear(this.keyPart + PrefixedStorage.PART_SEPARATOR + prefix);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"addListener\",\n    value: function addListener(listener) {\n      return this.storage.addListener(listener);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(listener) {\n      return this.storage.addListener(listener);\n    }\n  }]);\n\n  return PrefixedStorage;\n}();\n/**\n * The string separating two parts.\n */\n\n\nPrefixedStorage.PART_SEPARATOR = \":\"; ////////////////////////////////////////////////////////////////////////////\n\nvar ACCESS_TOKEN_STORAGE_KEY = \"accessToken\";\nvar REFRESH_TOKEN_STORAGE_KEY = \"refreshToken\";\nvar PROFILE_STORAGE_KEY = \"profile\";\nvar PROVIDER_TYPE_STORAGE_KEY = \"providerType\";\n/**\n * Storage specific to the app.\n */\n\nvar UserStorage = /*#__PURE__*/function (_PrefixedStorage) {\n  _inherits(UserStorage, _PrefixedStorage);\n\n  var _super = _createSuper(UserStorage);\n\n  /**\n   * Construct a storage for a `User`.\n   *\n   * @param storage The underlying storage to wrap.\n   * @param userId The id of the user.\n   */\n  function UserStorage(storage, userId) {\n    _classCallCheck(this, UserStorage);\n\n    return _super.call(this, storage, \"user(\".concat(userId, \")\"));\n  }\n  /**\n   * Get the access token from storage.\n   *\n   * @returns Access token (null if unknown).\n   */\n\n\n  _createClass(UserStorage, [{\n    key: \"accessToken\",\n    get: function get() {\n      return this.get(ACCESS_TOKEN_STORAGE_KEY);\n    }\n    /**\n     * Set the access token in storage.\n     *\n     * @param value Access token (null if unknown).\n     */\n    ,\n    set: function set(value) {\n      if (value === null) {\n        this.remove(ACCESS_TOKEN_STORAGE_KEY);\n      } else {\n        this.set(ACCESS_TOKEN_STORAGE_KEY, value);\n      }\n    }\n    /**\n     * Get the refresh token from storage.\n     *\n     * @returns Refresh token (null if unknown and user is logged out).\n     */\n\n  }, {\n    key: \"refreshToken\",\n    get: function get() {\n      return this.get(REFRESH_TOKEN_STORAGE_KEY);\n    }\n    /**\n     * Set the refresh token in storage.\n     *\n     * @param value Refresh token (null if unknown and user is logged out).\n     */\n    ,\n    set: function set(value) {\n      if (value === null) {\n        this.remove(REFRESH_TOKEN_STORAGE_KEY);\n      } else {\n        this.set(REFRESH_TOKEN_STORAGE_KEY, value);\n      }\n    }\n    /**\n     * Get the user profile from storage.\n     *\n     * @returns User profile (undefined if its unknown).\n     */\n\n  }, {\n    key: \"profile\",\n    get: function get() {\n      var value = this.get(PROFILE_STORAGE_KEY);\n\n      if (value) {\n        var profile = new UserProfile(); // Patch in the values\n\n        Object.assign(profile, JSON.parse(value));\n        return profile;\n      }\n    }\n    /**\n     * Set the user profile in storage.\n     *\n     * @param value User profile (undefined if its unknown).\n     */\n    ,\n    set: function set(value) {\n      if (value) {\n        this.set(PROFILE_STORAGE_KEY, JSON.stringify(value));\n      } else {\n        this.remove(PROFILE_STORAGE_KEY);\n      }\n    }\n    /**\n     * Get the type of authentication provider used to authenticate\n     *\n     * @returns User profile (undefined if its unknown).\n     */\n\n  }, {\n    key: \"providerType\",\n    get: function get() {\n      var value = this.get(PROVIDER_TYPE_STORAGE_KEY);\n\n      if (value) {\n        return value;\n      }\n    }\n    /**\n     * Set the type of authentication provider used to authenticate\n     *\n     * @param value Type of authentication provider.\n     */\n    ,\n    set: function set(value) {\n      if (value) {\n        this.set(PROVIDER_TYPE_STORAGE_KEY, value);\n      } else {\n        this.remove(PROVIDER_TYPE_STORAGE_KEY);\n      }\n    }\n  }]);\n\n  return UserStorage;\n}(PrefixedStorage); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * @param obj The object to remove keys (and undefined values from)\n * @returns A new object without the keys where the value is undefined.\n */\n\n\nfunction removeKeysWithUndefinedValues(obj) {\n  return Object.fromEntries(Object.entries(obj).filter(function (entry) {\n    return typeof entry[1] !== \"undefined\";\n  }));\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Generate a random sequence of characters.\n *\n * @param length The length of the string.\n * @param alphabet The alphabet of characters to pick from.\n * @returns A string of characters picked randomly from `alphabet`.\n */\n\n\nfunction generateRandomString(length, alphabet) {\n  var result = \"\";\n\n  for (var i = 0; i < length; i++) {\n    result += alphabet[Math.floor(Math.random() * alphabet.length)];\n  }\n\n  return result;\n}\n/**\n * Encode an object mapping from string to string, into a query string to be appended a URL.\n *\n * @param params The parameters to include in the string.\n * @param prefixed Should the \"?\" prefix be added if values exists?\n * @returns A URL encoded representation of the parameters (omitting a \"?\" prefix).\n */\n\n\nfunction encodeQueryString(params) {\n  var prefixed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  // Filter out undefined values\n  var cleanedParams = removeKeysWithUndefinedValues(params); // Determine if a prefixed \"?\" is appropreate\n\n  var prefix = prefixed && Object.keys(cleanedParams).length > 0 ? \"?\" : \"\"; // Transform keys and values to a query string\n\n  return prefix + Object.entries(cleanedParams).map(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        k = _ref5[0],\n        v = _ref5[1];\n\n    return \"\".concat(k, \"=\").concat(encodeURIComponent(v));\n  }).join(\"&\");\n}\n/**\n * Decodes a query string into an object.\n *\n * @param str The query string to decode.\n * @returns The decoded query string.\n */\n\n\nfunction decodeQueryString(str) {\n  var cleanStr = str[0] === \"?\" ? str.substr(1) : str;\n  return Object.fromEntries(cleanStr.split(\"&\").filter(function (s) {\n    return s.length > 0;\n  }).map(function (kvp) {\n    return kvp.split(\"=\");\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        k = _ref7[0],\n        v = _ref7[1];\n\n    return [k, decodeURIComponent(v)];\n  }));\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * A list of names that functions cannot have to be callable through the functions proxy.\n */\n\n\nvar RESERVED_NAMES = [\"inspect\", \"callFunction\", \"callFunctionStreaming\"].concat(_toConsumableArray(Object.getOwnPropertyNames(Object.prototype)));\n/**\n * Remove the key for any fields with undefined values.\n *\n * @param args The arguments to clean.\n * @returns The cleaned arguments.\n */\n\nfunction cleanArgs(args) {\n  var _iterator2 = _createForOfIteratorHelper(args),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var arg = _step2.value;\n\n      if (typeof arg === \"object\") {\n        for (var _i = 0, _Object$entries = Object.entries(arg); _i < _Object$entries.length; _i++) {\n          var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n              key = _Object$entries$_i[0],\n              value = _Object$entries$_i[1];\n\n          if (value === undefined) {\n            delete arg[key];\n          }\n        }\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  return args;\n}\n/**\n * Remove keys for any undefined values and serialize to EJSON.\n *\n * @param args The arguments to clean and serialize.\n * @returns The cleaned and serialized arguments.\n */\n\n\nfunction cleanArgsAndSerialize(args) {\n  var cleaned = cleanArgs(args);\n  return cleaned.map(function (arg) {\n    return typeof arg === \"object\" ? serialize(arg) : arg;\n  });\n}\n/**\n * Defines how functions are called.\n */\n\n\nvar FunctionsFactory = /*#__PURE__*/function () {\n  /**\n   * @param fetcher The underlying fetcher to use when sending requests.\n   * @param config Additional configuration parameters.\n   */\n  function FunctionsFactory(fetcher) {\n    var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, FunctionsFactory);\n\n    this.fetcher = fetcher;\n    this.serviceName = config.serviceName;\n    this.argsTransformation = config.argsTransformation || cleanArgsAndSerialize;\n  }\n  /**\n   * Create a factory of functions, wrapped in a Proxy that returns bound copies of `callFunction` on any property.\n   *\n   * @param fetcher The underlying fetcher to use when requesting.\n   * @param config Additional configuration parameters.\n   * @returns The newly created factory of functions.\n   */\n\n\n  _createClass(FunctionsFactory, [{\n    key: \"callFunction\",\n    value:\n    /**\n     * Call a remote function by it's name.\n     *\n     * @param name Name of the remote function.\n     * @param args Arguments to pass to the remote function.\n     * @returns A promise of the value returned when executing the remote function.\n     */\n    function () {\n      var _callFunction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name) {\n        var _len,\n            args,\n            _key,\n            body,\n            appRoute,\n            _args3 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                for (_len = _args3.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                  args[_key - 1] = _args3[_key];\n                }\n\n                // See https://github.com/mongodb/stitch-js-sdk/blob/master/packages/core/sdk/src/services/internal/CoreStitchServiceClientImpl.ts\n                body = {\n                  name: name,\n                  arguments: this.argsTransformation ? this.argsTransformation(args) : args\n                };\n\n                if (this.serviceName) {\n                  body.service = this.serviceName;\n                }\n\n                appRoute = this.fetcher.appRoute;\n                return _context3.abrupt(\"return\", this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.functionsCall().path,\n                  body: body\n                }));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function callFunction(_x3) {\n        return _callFunction.apply(this, arguments);\n      }\n\n      return callFunction;\n    }()\n    /**\n     * Call a remote function by it's name.\n     *\n     * @param name Name of the remote function.\n     * @param args Arguments to pass to the remote function.\n     * @returns A promise of the value returned when executing the remote function.\n     */\n\n  }, {\n    key: \"callFunctionStreaming\",\n    value: function callFunctionStreaming(name) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      var body = {\n        name: name,\n        arguments: this.argsTransformation ? this.argsTransformation(args) : args\n      };\n\n      if (this.serviceName) {\n        body.service = this.serviceName;\n      }\n\n      var appRoute = this.fetcher.appRoute;\n      var qs = encodeQueryString(_defineProperty({}, \"baas_request\", Base64.encode(JSON.stringify(body))));\n      return this.fetcher.fetchStream({\n        method: \"GET\",\n        path: appRoute.functionsCall().path + qs\n      });\n    }\n  }], [{\n    key: \"create\",\n    value: function create(fetcher) {\n      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      // Create a proxy, wrapping a simple object returning methods that calls functions\n      // TODO: Lazily fetch available functions and return these from the ownKeys() trap\n      var factory = new FunctionsFactory(fetcher, config); // Wrap the factory in a proxy that calls the internal call method\n\n      return new Proxy(factory, {\n        get: function get(target, p, receiver) {\n          if (typeof p === \"string\" && RESERVED_NAMES.indexOf(p) === -1) {\n            return target.callFunction.bind(target, p);\n          } else {\n            var prop = Reflect.get(target, p, receiver);\n            return typeof prop === \"function\" ? prop.bind(target) : prop;\n          }\n        }\n      });\n    }\n  }]);\n\n  return FunctionsFactory;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/** @inheritdoc */\n\n\nvar EmailPasswordAuth = /*#__PURE__*/function () {\n  /**\n   * Construct an interface to the email / password authentication provider.\n   *\n   * @param fetcher The underlying fetcher used to request the services.\n   * @param providerName Optional custom name of the authentication provider.\n   */\n  function EmailPasswordAuth(fetcher) {\n    var providerName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"local-userpass\";\n\n    _classCallCheck(this, EmailPasswordAuth);\n\n    this.fetcher = fetcher;\n    this.providerName = providerName;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(EmailPasswordAuth, [{\n    key: \"registerUser\",\n    value: function () {\n      var _registerUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(email, password) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context4.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).register().path,\n                  body: {\n                    email: email,\n                    password: password\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function registerUser(_x4, _x5) {\n        return _registerUser.apply(this, arguments);\n      }\n\n      return registerUser;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"confirmUser\",\n    value: function () {\n      var _confirmUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(token, tokenId) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context5.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).confirm().path,\n                  body: {\n                    token: token,\n                    tokenId: tokenId\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function confirmUser(_x6, _x7) {\n        return _confirmUser.apply(this, arguments);\n      }\n\n      return confirmUser;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"resendConfirmationEmail\",\n    value: function () {\n      var _resendConfirmationEmail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(email) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context6.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).confirmSend().path,\n                  body: {\n                    email: email\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function resendConfirmationEmail(_x8) {\n        return _resendConfirmationEmail.apply(this, arguments);\n      }\n\n      return resendConfirmationEmail;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"resetPassword\",\n    value: function () {\n      var _resetPassword = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(token, tokenId, password) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context7.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).reset().path,\n                  body: {\n                    token: token,\n                    tokenId: tokenId,\n                    password: password\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function resetPassword(_x9, _x10, _x11) {\n        return _resetPassword.apply(this, arguments);\n      }\n\n      return resetPassword;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"sendResetPasswordEmail\",\n    value: function () {\n      var _sendResetPasswordEmail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(email) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context8.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).resetSend().path,\n                  body: {\n                    email: email\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function sendResetPasswordEmail(_x12) {\n        return _sendResetPasswordEmail.apply(this, arguments);\n      }\n\n      return sendResetPasswordEmail;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"callResetPasswordFunction\",\n    value: function () {\n      var _callResetPasswordFunction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(email, password) {\n        var appRoute,\n            _len3,\n            args,\n            _key3,\n            _args9 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n\n                for (_len3 = _args9.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n                  args[_key3 - 2] = _args9[_key3];\n                }\n\n                _context9.next = 4;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).resetCall().path,\n                  body: {\n                    email: email,\n                    password: password,\n                    arguments: args\n                  }\n                });\n\n              case 4:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function callResetPasswordFunction(_x13, _x14) {\n        return _callResetPasswordFunction.apply(this, arguments);\n      }\n\n      return callResetPasswordFunction;\n    }()\n  }]);\n\n  return EmailPasswordAuth;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * @returns The base api route.\n */\n\n\nfunction api() {\n  return {\n    path: \"/api/client/v2.0\",\n\n    /**\n     * @param appId The id of the app.\n     * @returns The URL of the app endpoint.\n     */\n    app: function app(appId) {\n      return {\n        path: this.path + \"/app/\".concat(appId),\n\n        /**\n         * @returns The URL of the app location endpoint.\n         */\n        location: function location() {\n          return {\n            path: this.path + \"/location\"\n          };\n        },\n\n        /**\n         * @param providerName The name of the provider.\n         * @returns The app url concatinated with the /auth/providers/{providerName}\n         */\n        authProvider: function authProvider(providerName) {\n          return {\n            path: this.path + \"/auth/providers/\".concat(providerName),\n\n            /**\n             * @returns Get the URL of an authentication provider.\n             */\n            login: function login() {\n              return {\n                path: this.path + \"/login\"\n              };\n            }\n          };\n        },\n\n        /**\n         * @param providerName The name of the provider.\n         * @returns The app url concatinated with the /auth/providers/{providerName}\n         */\n        emailPasswordAuth: function emailPasswordAuth(providerName) {\n          var authProviderRoutes = this.authProvider(providerName);\n          return _objectSpread(_objectSpread({}, authProviderRoutes), {}, {\n            register: function register() {\n              return {\n                path: this.path + \"/register\"\n              };\n            },\n            confirm: function confirm() {\n              return {\n                path: this.path + \"/confirm\"\n              };\n            },\n            confirmSend: function confirmSend() {\n              return {\n                path: this.path + \"/confirm/send\"\n              };\n            },\n            reset: function reset() {\n              return {\n                path: this.path + \"/reset\"\n              };\n            },\n            resetSend: function resetSend() {\n              return {\n                path: this.path + \"/reset/send\"\n              };\n            },\n            resetCall: function resetCall() {\n              return {\n                path: this.path + \"/reset/call\"\n              };\n            }\n          });\n        },\n        functionsCall: function functionsCall() {\n          return {\n            path: this.path + \"/functions/call\"\n          };\n        }\n      };\n    },\n    auth: function auth() {\n      return {\n        path: this.path + \"/auth\",\n        apiKeys: function apiKeys() {\n          return {\n            path: this.path + \"/api_keys\",\n            key: function key(id) {\n              return {\n                path: this.path + \"/\".concat(id),\n                enable: function enable() {\n                  return {\n                    path: this.path + \"/enable\"\n                  };\n                },\n                disable: function disable() {\n                  return {\n                    path: this.path + \"/disable\"\n                  };\n                }\n              };\n            }\n          };\n        },\n        profile: function profile() {\n          return {\n            path: this.path + \"/profile\"\n          };\n        },\n        session: function session() {\n          return {\n            path: this.path + \"/session\"\n          };\n        }\n      };\n    }\n  };\n}\n\nvar routes = {\n  api: api\n}; ////////////////////////////////////////////////////////////////////////////\n\n/** @inheritdoc */\n\nvar ApiKeyAuth = /*#__PURE__*/function () {\n  /**\n   * Construct an interface to the API-key authentication provider.\n   *\n   * @param fetcher The fetcher used to send requests to services.\n   * @param providerName Optional custom name of the authentication provider.\n   */\n  function ApiKeyAuth(fetcher) {\n    var providerName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"api-key\";\n\n    _classCallCheck(this, ApiKeyAuth);\n\n    this.fetcher = fetcher;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(ApiKeyAuth, [{\n    key: \"create\",\n    value: function create(name) {\n      return this.fetcher.fetchJSON({\n        method: \"POST\",\n        body: {\n          name: name\n        },\n        path: routes.api().auth().apiKeys().path,\n        tokenType: \"refresh\"\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"fetch\",\n    value: function fetch(keyId) {\n      return this.fetcher.fetchJSON({\n        method: \"GET\",\n        path: routes.api().auth().apiKeys().key(keyId).path,\n        tokenType: \"refresh\"\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"fetchAll\",\n    value: function fetchAll() {\n      return this.fetcher.fetchJSON({\n        method: \"GET\",\n        tokenType: \"refresh\",\n        path: routes.api().auth().apiKeys().path\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(keyId) {\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"DELETE\",\n                  path: routes.api().auth().apiKeys().key(keyId).path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function _delete(_x15) {\n        return _delete2.apply(this, arguments);\n      }\n\n      return _delete;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(keyId) {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"PUT\",\n                  path: routes.api().auth().apiKeys().key(keyId).enable().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function enable(_x16) {\n        return _enable.apply(this, arguments);\n      }\n\n      return enable;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"disable\",\n    value: function () {\n      var _disable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12(keyId) {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _context12.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"PUT\",\n                  path: routes.api().auth().apiKeys().key(keyId).disable().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function disable(_x17) {\n        return _disable.apply(this, arguments);\n      }\n\n      return disable;\n    }()\n  }]);\n\n  return ApiKeyAuth;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar environment = null;\n/**\n * Set the environment of execution.\n * Note: This should be called as the first thing before executing any code which calls getEnvironment()\n *\n * @param e An object containing environment specific implementations.\n */\n\nfunction setEnvironment(e) {\n  environment = e;\n}\n/**\n * Get the environment of execution.\n *\n * @returns An object containing environment specific implementations.\n */\n\n\nfunction getEnvironment() {\n  if (environment) {\n    return environment;\n  } else {\n    throw new Error(\"Cannot get environment before it's set\");\n  }\n} ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * An error occured during the parsing of a watch stream.\n */\n\n\nvar WatchError = /*#__PURE__*/function (_Error) {\n  _inherits(WatchError, _Error);\n\n  var _super2 = _createSuper(WatchError);\n\n  function WatchError(_ref8) {\n    var _this2;\n\n    var message = _ref8.message,\n        code = _ref8.code;\n\n    _classCallCheck(this, WatchError);\n\n    _this2 = _super2.call(this, message);\n    /**\n     * The name of this type of error\n     */\n\n    _this2.name = \"WatchError\";\n    _this2.code = code;\n    return _this2;\n  }\n\n  return WatchError;\n}( /*#__PURE__*/_wrapNativeSuper(Error)); ////////////////////////////////////////////////////////////////////////////\n// NOTE: this is a fully processed event, not a single \"data: foo\" line!\n\n/**\n * The state of a WatchStream.\n */\n\n\nvar WatchStreamState;\n\n(function (WatchStreamState) {\n  /**\n   * Need to call one of the feed functions.\n   */\n  WatchStreamState[\"NEED_DATA\"] = \"NEED_DATA\";\n  /**\n   * Call nextEvent() to consume an event.\n   */\n\n  WatchStreamState[\"HAVE_EVENT\"] = \"HAVE_EVENT\";\n  /**\n   * Call error().\n   */\n\n  WatchStreamState[\"HAVE_ERROR\"] = \"HAVE_ERROR\";\n})(WatchStreamState || (WatchStreamState = {}));\n/**\n * Represents a stream of events\n */\n\n\nvar WatchStream = /*#__PURE__*/function () {\n  function WatchStream() {\n    _classCallCheck(this, WatchStream);\n\n    this._state = WatchStreamState.NEED_DATA;\n    this._error = null; // Used by feedBuffer to construct lines\n\n    this._textDecoder = new (getEnvironment().TextDecoder)();\n    this._buffer = \"\";\n    this._bufferOffset = 0; // Used by feedLine for building the next SSE\n\n    this._eventType = \"\";\n    this._dataBuffer = \"\";\n  } // Call these when you have data, in whatever shape is easiest for your SDK to get.\n  // Pick one, mixing and matching on a single instance isn't supported.\n  // These can only be called in NEED_DATA state, which is the initial state.\n\n\n  _createClass(WatchStream, [{\n    key: \"feedBuffer\",\n    value: function feedBuffer(buffer) {\n      this.assertState(WatchStreamState.NEED_DATA);\n      this._buffer += this._textDecoder.decode(buffer, {\n        stream: true\n      });\n      this.advanceBufferState();\n    }\n  }, {\n    key: \"feedLine\",\n    value: function feedLine(line) {\n      this.assertState(WatchStreamState.NEED_DATA); // This is an implementation of the algorithm described at\n      // https://html.spec.whatwg.org/multipage/server-sent-events.html#event-stream-interpretation.\n      // Currently the server does not use id or retry lines, so that processing isn't implemented.\n      // ignore trailing LF if not removed by SDK.\n\n      if (line.endsWith(\"\\n\")) line = line.substr(0, line.length - 1); // ignore trailing CR from CRLF\n\n      if (line.endsWith(\"\\r\")) line = line.substr(0, line.length - 1);\n\n      if (line.length === 0) {\n        // This is the \"dispatch the event\" portion of the algorithm.\n        if (this._dataBuffer.length === 0) {\n          this._eventType = \"\";\n          return;\n        }\n\n        if (this._dataBuffer.endsWith(\"\\n\")) this._dataBuffer = this._dataBuffer.substr(0, this._dataBuffer.length - 1);\n        this.feedSse({\n          data: this._dataBuffer,\n          eventType: this._eventType\n        });\n        this._dataBuffer = \"\";\n        this._eventType = \"\";\n      }\n\n      if (line[0] === \":\") return;\n      var colon = line.indexOf(\":\");\n      var field = line.substr(0, colon);\n      var value = colon === -1 ? \"\" : line.substr(colon + 1);\n      if (value.startsWith(\" \")) value = value.substr(1);\n\n      if (field === \"event\") {\n        this._eventType = value;\n      } else if (field === \"data\") {\n        this._dataBuffer += value;\n        this._dataBuffer += \"\\n\";\n      } else ;\n    }\n  }, {\n    key: \"feedSse\",\n    value: function feedSse(sse) {\n      this.assertState(WatchStreamState.NEED_DATA);\n      var firstPercentIndex = sse.data.indexOf(\"%\");\n\n      if (firstPercentIndex !== -1) {\n        // For some reason, the stich server decided to add percent-encoding for '%', '\\n', and '\\r' to its\n        // event-stream replies. But it isn't real urlencoding, since most characters pass through, so we can't use\n        // uri_percent_decode() here.\n        var buffer = \"\";\n        var start = 0;\n\n        for (var percentIndex = firstPercentIndex; percentIndex !== -1; percentIndex = sse.data.indexOf(\"%\", start)) {\n          buffer += sse.data.substr(start, percentIndex - start);\n          var encoded = sse.data.substr(percentIndex, 3); // may be smaller than 3 if string ends with %\n\n          if (encoded === \"%25\") {\n            buffer += \"%\";\n          } else if (encoded === \"%0A\") {\n            buffer += \"\\x0A\"; // '\\n'\n          } else if (encoded === \"%0D\") {\n            buffer += \"\\x0D\"; // '\\r'\n          } else {\n            buffer += encoded; // propagate as-is\n          }\n\n          start = percentIndex + encoded.length;\n        } // Advance the buffer with the last part\n\n\n        buffer += sse.data.substr(start);\n        sse.data = buffer;\n      }\n\n      if (!sse.eventType || sse.eventType === \"message\") {\n        try {\n          var parsed = EJSON.parse(sse.data);\n\n          if (typeof parsed === \"object\") {\n            // ???\n            this._nextEvent = parsed;\n            this._state = WatchStreamState.HAVE_EVENT;\n            return;\n          }\n        } catch (_unused) {// fallthrough to same handling as for non-document value.\n        }\n\n        this._state = WatchStreamState.HAVE_ERROR;\n        this._error = new WatchError({\n          message: \"server returned malformed event: \" + sse.data,\n          code: \"bad bson parse\"\n        });\n      } else if (sse.eventType === \"error\") {\n        this._state = WatchStreamState.HAVE_ERROR; // default error message if we have issues parsing the reply.\n\n        this._error = new WatchError({\n          message: sse.data,\n          code: \"unknown\"\n        });\n\n        try {\n          var _EJSON$parse = EJSON.parse(sse.data),\n              errorCode = _EJSON$parse.error_code,\n              error = _EJSON$parse.error;\n\n          if (typeof errorCode !== \"string\") return;\n          if (typeof error !== \"string\") return; // XXX in realm-js, object-store will error if the error_code is not one of the known\n          // error code enum values.\n\n          this._error = new WatchError({\n            message: error,\n            code: errorCode\n          });\n        } catch (_unused2) {\n          return; // Use the default state.\n        }\n      } else ;\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this._state;\n    } // Consumes the returned event. If you used feedBuffer(), there may be another event or error after this one,\n    // so you need to call state() again to see what to do next.\n\n  }, {\n    key: \"nextEvent\",\n    value: function nextEvent() {\n      this.assertState(WatchStreamState.HAVE_EVENT); // We can use \"as ChangeEvent<T>\" since we just asserted the state.\n\n      var out = this._nextEvent;\n      this._state = WatchStreamState.NEED_DATA;\n      this.advanceBufferState();\n      return out;\n    } // Once this enters the error state, it stays that way. You should not feed any more data.\n\n  }, {\n    key: \"error\",\n    get: function get() {\n      return this._error;\n    } ////////////////////////////////////////////\n\n  }, {\n    key: \"advanceBufferState\",\n    value: function advanceBufferState() {\n      this.assertState(WatchStreamState.NEED_DATA);\n\n      while (this.state === WatchStreamState.NEED_DATA) {\n        if (this._bufferOffset === this._buffer.length) {\n          this._buffer = \"\";\n          this._bufferOffset = 0;\n          return;\n        } // NOTE not supporting CR-only newlines, just LF and CRLF.\n\n\n        var nextNewlineIndex = this._buffer.indexOf(\"\\n\", this._bufferOffset);\n\n        if (nextNewlineIndex === -1) {\n          // We have a partial line.\n          if (this._bufferOffset !== 0) {\n            // Slide the partial line down to the front of the buffer.\n            this._buffer = this._buffer.substr(this._bufferOffset, this._buffer.length - this._bufferOffset);\n            this._bufferOffset = 0;\n          }\n\n          return;\n        }\n\n        this.feedLine(this._buffer.substr(this._bufferOffset, nextNewlineIndex - this._bufferOffset));\n        this._bufferOffset = nextNewlineIndex + 1; // Advance past this line, including its newline.\n      }\n    }\n  }, {\n    key: \"assertState\",\n    value: function assertState(state) {\n      if (this._state !== state) {\n        throw Error(\"Expected WatchStream to be in state \".concat(state, \", but in state \").concat(this._state));\n      }\n    }\n  }]);\n\n  return WatchStream;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * A remote collection of documents.\n */\n\n\nvar MongoDBCollection = /*#__PURE__*/function () {\n  /**\n   * Construct a remote collection of documents.\n   *\n   * @param fetcher The fetcher to use when requesting the service.\n   * @param serviceName The name of the remote service.\n   * @param databaseName The name of the database.\n   * @param collectionName The name of the remote collection.\n   */\n  function MongoDBCollection(fetcher, serviceName, databaseName, collectionName) {\n    _classCallCheck(this, MongoDBCollection);\n\n    this.functions = FunctionsFactory.create(fetcher, {\n      serviceName: serviceName\n    });\n    this.databaseName = databaseName;\n    this.collectionName = collectionName;\n    this.serviceName = serviceName;\n    this.fetcher = fetcher;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(MongoDBCollection, [{\n    key: \"find\",\n    value: function find() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.find({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        project: options.projection,\n        sort: options.sort,\n        limit: options.limit\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOne\",\n    value: function findOne() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.findOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        project: options.projection,\n        sort: options.sort\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndUpdate\",\n    value: function findOneAndUpdate() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var update = arguments.length > 1 ? arguments[1] : undefined;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.findOneAndUpdate({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        update: update,\n        sort: options.sort,\n        projection: options.projection,\n        upsert: options.upsert,\n        returnNewDocument: options.returnNewDocument\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndReplace\",\n    value: function findOneAndReplace() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var replacement = arguments.length > 1 ? arguments[1] : undefined;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.findOneAndReplace({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        update: replacement,\n        sort: options.sort,\n        projection: options.projection,\n        upsert: options.upsert,\n        returnNewDocument: options.returnNewDocument\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndDelete\",\n    value: function findOneAndDelete() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.findOneAndReplace({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        sort: options.sort,\n        projection: options.projection\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"aggregate\",\n    value: function aggregate(pipeline) {\n      return this.functions.aggregate({\n        database: this.databaseName,\n        collection: this.collectionName,\n        pipeline: pipeline\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"count\",\n    value: function count() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.count({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        limit: options.limit\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"insertOne\",\n    value: function insertOne(document) {\n      return this.functions.insertOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        document: document\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"insertMany\",\n    value: function insertMany(documents) {\n      return this.functions.insertMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        documents: documents\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"deleteOne\",\n    value: function deleteOne() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return this.functions.deleteOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"deleteMany\",\n    value: function deleteMany() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return this.functions.deleteMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"updateOne\",\n    value: function updateOne(filter, update) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.updateOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        update: update,\n        upsert: options.upsert\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"updateMany\",\n    value: function updateMany(filter, update) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.updateMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        update: update,\n        upsert: options.upsert\n      });\n    }\n  }, {\n    key: \"watch\",\n    value: function watch() {\n      var _this = this;\n\n      var _ref9 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          ids = _ref9.ids,\n          filter = _ref9.filter;\n\n      return _wrapAsyncGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n        var iterator, watchStream, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _value, chunk;\n\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                _context13.next = 2;\n                return _awaitAsyncGenerator(_this.functions.callFunctionStreaming(\"watch\", {\n                  database: _this.databaseName,\n                  collection: _this.collectionName,\n                  ids: ids,\n                  filter: filter\n                }));\n\n              case 2:\n                iterator = _context13.sent;\n                watchStream = new WatchStream();\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _context13.prev = 6;\n                _iterator = _asyncIterator(iterator);\n\n              case 8:\n                _context13.next = 10;\n                return _awaitAsyncGenerator(_iterator.next());\n\n              case 10:\n                _step = _context13.sent;\n                _iteratorNormalCompletion = _step.done;\n                _context13.next = 14;\n                return _awaitAsyncGenerator(_step.value);\n\n              case 14:\n                _value = _context13.sent;\n\n                if (_iteratorNormalCompletion) {\n                  _context13.next = 30;\n                  break;\n                }\n\n                chunk = _value;\n\n                if (chunk) {\n                  _context13.next = 19;\n                  break;\n                }\n\n                return _context13.abrupt(\"continue\", 27);\n\n              case 19:\n                watchStream.feedBuffer(chunk);\n\n              case 20:\n                if (!(watchStream.state == WatchStreamState.HAVE_EVENT)) {\n                  _context13.next = 25;\n                  break;\n                }\n\n                _context13.next = 23;\n                return watchStream.nextEvent();\n\n              case 23:\n                _context13.next = 20;\n                break;\n\n              case 25:\n                if (!(watchStream.state == WatchStreamState.HAVE_ERROR)) {\n                  _context13.next = 27;\n                  break;\n                }\n\n                throw watchStream.error;\n\n              case 27:\n                _iteratorNormalCompletion = true;\n                _context13.next = 8;\n                break;\n\n              case 30:\n                _context13.next = 36;\n                break;\n\n              case 32:\n                _context13.prev = 32;\n                _context13.t0 = _context13[\"catch\"](6);\n                _didIteratorError = true;\n                _iteratorError = _context13.t0;\n\n              case 36:\n                _context13.prev = 36;\n                _context13.prev = 37;\n\n                if (!(!_iteratorNormalCompletion && _iterator.return != null)) {\n                  _context13.next = 41;\n                  break;\n                }\n\n                _context13.next = 41;\n                return _awaitAsyncGenerator(_iterator.return());\n\n              case 41:\n                _context13.prev = 41;\n\n                if (!_didIteratorError) {\n                  _context13.next = 44;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 44:\n                return _context13.finish(41);\n\n              case 45:\n                return _context13.finish(36);\n\n              case 46:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, null, [[6, 32, 36, 46], [37,, 41, 45]]);\n      }))();\n    }\n  }]);\n\n  return MongoDBCollection;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Creates an Remote MongoDB Collection.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher.\n * @param serviceName A service name.\n * @param databaseName A database name.\n * @param collectionName A collection name.\n * @returns The collection.\n */\n\n\nfunction createCollection(fetcher, serviceName, databaseName, collectionName) {\n  return new MongoDBCollection(fetcher, serviceName, databaseName, collectionName);\n}\n/**\n * Creates a Remote MongoDB Database.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher\n * @param serviceName A service name\n * @param databaseName A database name\n * @returns The database.\n */\n\n\nfunction createDatabase(fetcher, serviceName, databaseName) {\n  return {\n    collection: createCollection.bind(null, fetcher, serviceName, databaseName)\n  };\n}\n/**\n * Creates a Remote MongoDB Service.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher.\n * @param serviceName An optional service name.\n * @returns The service.\n */\n\n\nfunction createService(fetcher) {\n  var serviceName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"mongo-db\";\n  return {\n    db: createDatabase.bind(null, fetcher, serviceName)\n  };\n} ////////////////////////////////////////////////////////////////////////////\n\n\nvar DEFAULT_DEVICE_ID = \"000000000000000000000000\";\n/** The state of a user within the app */\n\nvar UserState;\n\n(function (UserState) {\n  /** Active, with both access and refresh tokens */\n  UserState[\"Active\"] = \"active\";\n  /** Logged out, but there might still be data persisted about the user, in the browser. */\n\n  UserState[\"LoggedOut\"] = \"logged-out\";\n  /** Logged out and all data about the user has been removed. */\n\n  UserState[\"Removed\"] = \"removed\";\n})(UserState || (UserState = {}));\n/** The type of a user. */\n\n\nvar UserType$1;\n\n(function (UserType) {\n  /** Created by the user itself. */\n  UserType[\"Normal\"] = \"normal\";\n  /** Created by an administrator of the app. */\n\n  UserType[\"Server\"] = \"server\";\n})(UserType$1 || (UserType$1 = {}));\n/**\n * Representation of an authenticated user of an app.\n */\n\n\nvar User = /*#__PURE__*/function () {\n  /**\n   * @param parameters Parameters of the user.\n   */\n  function User(parameters) {\n    _classCallCheck(this, User);\n\n    this.app = parameters.app;\n    this.id = parameters.id;\n    this.storage = new UserStorage(this.app.storage, this.id);\n\n    if (\"accessToken\" in parameters && \"refreshToken\" in parameters && \"providerType\" in parameters) {\n      this._accessToken = parameters.accessToken;\n      this._refreshToken = parameters.refreshToken;\n      this.providerType = parameters.providerType; // Save the parameters to storage, for future instances to be hydrated from\n\n      this.storage.accessToken = parameters.accessToken;\n      this.storage.refreshToken = parameters.refreshToken;\n      this.storage.providerType = parameters.providerType;\n    } else {\n      // Hydrate the rest of the parameters from storage\n      this._accessToken = this.storage.accessToken;\n      this._refreshToken = this.storage.refreshToken;\n      var providerType = this.storage.providerType;\n      this._profile = this.storage.profile;\n\n      if (providerType) {\n        this.providerType = providerType;\n      } else {\n        throw new Error(\"Storage is missing a provider type\");\n      }\n    }\n\n    this.fetcher = this.app.fetcher.clone({\n      userContext: {\n        currentUser: this\n      }\n    });\n    this.apiKeys = new ApiKeyAuth(this.fetcher);\n    this.functions = FunctionsFactory.create(this.fetcher);\n  }\n  /**\n   * @returns The access token used to authenticate the user towards MongoDB Realm.\n   */\n\n\n  _createClass(User, [{\n    key: \"accessToken\",\n    get: function get() {\n      return this._accessToken;\n    }\n    /**\n     * @param token The new access token.\n     */\n    ,\n    set: function set(token) {\n      this._accessToken = token;\n      this.storage.accessToken = token;\n    }\n    /**\n     * @returns The refresh token used to issue new access tokens.\n     */\n\n  }, {\n    key: \"refreshToken\",\n    get: function get() {\n      return this._refreshToken;\n    }\n    /**\n     * @param token The new refresh token.\n     */\n    ,\n    set: function set(token) {\n      this._refreshToken = token;\n      this.storage.refreshToken = token;\n    }\n    /**\n     * @returns The current state of the user.\n     */\n\n  }, {\n    key: \"state\",\n    get: function get() {\n      if (this.id in this.app.allUsers) {\n        return this.refreshToken === null ? UserState.LoggedOut : UserState.Active;\n      } else {\n        return UserState.Removed;\n      }\n    }\n    /**\n     * @returns The logged in state of the user.\n     */\n\n  }, {\n    key: \"isLoggedIn\",\n    get: function get() {\n      return this.state === UserState.Active;\n    }\n  }, {\n    key: \"customData\",\n    get: function get() {\n      if (this.accessToken) {\n        var decodedToken = this.decodeAccessToken();\n        return decodedToken.userData;\n      } else {\n        throw new Error(\"Cannot read custom data without an access token\");\n      }\n    }\n    /**\n     * @returns Profile containing detailed information about the user.\n     */\n\n  }, {\n    key: \"profile\",\n    get: function get() {\n      if (this._profile) {\n        return this._profile.data;\n      } else {\n        throw new Error(\"A profile was never fetched for this user\");\n      }\n    }\n  }, {\n    key: \"identities\",\n    get: function get() {\n      if (this._profile) {\n        return this._profile.identities;\n      } else {\n        throw new Error(\"A profile was never fetched for this user\");\n      }\n    }\n  }, {\n    key: \"deviceId\",\n    get: function get() {\n      if (this.accessToken) {\n        var payload = this.accessToken.split(\".\")[1];\n\n        if (payload) {\n          var parsedPayload = JSON.parse(base64.Base64.decode(payload));\n          var deviceId = parsedPayload[\"baas_device_id\"];\n\n          if (typeof deviceId === \"string\" && deviceId !== DEFAULT_DEVICE_ID) {\n            return deviceId;\n          }\n        }\n      }\n\n      return null;\n    }\n    /**\n     * Refresh the users profile data.\n     */\n\n  }, {\n    key: \"refreshProfile\",\n    value: function () {\n      var _refreshProfile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"GET\",\n                  path: routes.api().auth().profile().path\n                });\n\n              case 2:\n                response = _context14.sent;\n                // Create a profile instance\n                this._profile = new UserProfile(response); // Store this for later hydration\n\n                this.storage.profile = this._profile;\n\n              case 5:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function refreshProfile() {\n        return _refreshProfile.apply(this, arguments);\n      }\n\n      return refreshProfile;\n    }()\n    /**\n     * Log out the user, invalidating the session (and its refresh token).\n     */\n\n  }, {\n    key: \"logOut\",\n    value: function () {\n      var _logOut = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.prev = 0;\n\n                if (!(this._refreshToken !== null)) {\n                  _context15.next = 4;\n                  break;\n                }\n\n                _context15.next = 4;\n                return this.fetcher.fetchJSON({\n                  method: \"DELETE\",\n                  path: routes.api().auth().session().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 4:\n                _context15.prev = 4;\n                // Forget the access and refresh token\n                this.accessToken = null;\n                this.refreshToken = null;\n                return _context15.finish(4);\n\n              case 8:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this, [[0,, 4, 8]]);\n      }));\n\n      function logOut() {\n        return _logOut.apply(this, arguments);\n      }\n\n      return logOut;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"linkCredentials\",\n    value: function () {\n      var _linkCredentials = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16(credentials) {\n        var response, details;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return this.app.authenticator.authenticate(credentials, this);\n\n              case 2:\n                response = _context16.sent;\n\n                if (!(this.id !== response.userId)) {\n                  _context16.next = 6;\n                  break;\n                }\n\n                details = \"got user id \".concat(response.userId, \" expected \").concat(this.id);\n                throw new Error(\"Link response ment for another user (\".concat(details, \")\"));\n\n              case 6:\n                // Update the access token\n                this.accessToken = response.accessToken; // Refresh the profile to include the new identity\n\n                _context16.next = 9;\n                return this.refreshProfile();\n\n              case 9:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function linkCredentials(_x18) {\n        return _linkCredentials.apply(this, arguments);\n      }\n\n      return linkCredentials;\n    }()\n    /**\n     * Request a new access token, using the refresh token.\n     */\n\n  }, {\n    key: \"refreshAccessToken\",\n    value: function () {\n      var _refreshAccessToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17() {\n        var response, accessToken;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                _context17.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: routes.api().auth().session().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n                response = _context17.sent;\n                accessToken = response.access_token;\n\n                if (!(typeof accessToken === \"string\")) {\n                  _context17.next = 8;\n                  break;\n                }\n\n                this.accessToken = accessToken;\n                _context17.next = 9;\n                break;\n\n              case 8:\n                throw new Error(\"Expected an 'access_token' in the response\");\n\n              case 9:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function refreshAccessToken() {\n        return _refreshAccessToken.apply(this, arguments);\n      }\n\n      return refreshAccessToken;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"refreshCustomData\",\n    value: function () {\n      var _refreshCustomData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                _context18.next = 2;\n                return this.refreshAccessToken();\n\n              case 2:\n                return _context18.abrupt(\"return\", this.customData);\n\n              case 3:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function refreshCustomData() {\n        return _refreshCustomData.apply(this, arguments);\n      }\n\n      return refreshCustomData;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"callFunction\",\n    value: function callFunction(name) {\n      var _this$functions;\n\n      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n\n      return (_this$functions = this.functions).callFunction.apply(_this$functions, [name].concat(args));\n    }\n    /**\n     * @returns A plain ol' JavaScript object representation of the user.\n     */\n\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        id: this.id,\n        accessToken: this.accessToken,\n        refreshToken: this.refreshToken,\n        profile: this._profile,\n        state: this.state,\n        customData: this.customData\n      };\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"push\",\n    value: function push() {\n      var serviceName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      throw new Error(\"Not yet implemented\");\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"mongoClient\",\n    value: function mongoClient(serviceName) {\n      return createService(this.fetcher, serviceName);\n    }\n  }, {\n    key: \"decodeAccessToken\",\n    value: function decodeAccessToken() {\n      if (this.accessToken) {\n        // Decode and spread the token\n        var parts = this.accessToken.split(\".\");\n\n        if (parts.length !== 3) {\n          throw new Error(\"Expected an access token with three parts\");\n        } // Decode the payload\n\n\n        var encodedPayload = parts[1];\n        var decodedPayload = base64.Base64.decode(encodedPayload);\n        var parsedPayload = JSON.parse(decodedPayload);\n        var expires = parsedPayload.exp,\n            issuedAt = parsedPayload.iat,\n            subject = parsedPayload.sub,\n            _parsedPayload$user_d = parsedPayload.user_data,\n            userData = _parsedPayload$user_d === void 0 ? {} : _parsedPayload$user_d; // Validate the types\n\n        if (typeof expires !== \"number\") {\n          throw new Error(\"Failed to decode access token 'exp'\");\n        } else if (typeof issuedAt !== \"number\") {\n          throw new Error(\"Failed to decode access token 'iat'\");\n        }\n\n        return {\n          expires: expires,\n          issuedAt: issuedAt,\n          subject: subject,\n          userData: userData\n        };\n      } else {\n        throw new Error(\"Missing an access token\");\n      }\n    }\n  }]);\n\n  return User;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n// TODO: Ensure the static interface of the Credentials class implements the static interface of Realm.Credentials\n// See https://stackoverflow.com/a/43484801\n\n/**\n * Instances of this class can be passed to the `app.logIn` method to authenticate an end-user.\n */\n\n\nvar Credentials = /*#__PURE__*/function () {\n  /**\n   * Constructs an instance of credentials.\n   *\n   * @param providerName The name of the authentication provider used when authenticating.\n   * @param providerType The type of the authentication provider used when authenticating.\n   * @param payload The data being sent to the service when authenticating.\n   */\n  function Credentials(providerName, providerType, payload) {\n    _classCallCheck(this, Credentials);\n\n    this.providerName = providerName;\n    this.providerType = providerType;\n    this.payload = payload;\n  }\n  /**\n   * Creates credentials that logs in using the [Anonymous Provider](https://docs.mongodb.com/realm/authentication/anonymous/).\n   *\n   * @returns The credentials instance, which can be passed to `app.logIn`.\n   */\n\n\n  _createClass(Credentials, null, [{\n    key: \"anonymous\",\n    value: function anonymous() {\n      return new Credentials(\"anon-user\", \"anon-user\", {});\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @deprecated Use `Credentials.apiKey`.\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"userApiKey\",\n    value: function userApiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @deprecated Use `Credentials.apiKey`.\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"serverApiKey\",\n    value: function serverApiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"apiKey\",\n    value: function apiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Email/Password Provider](https://docs.mongodb.com/realm/authentication/email-password/).\n     * Note: This was formerly known as the \"Username/Password\" provider.\n     *\n     * @param email The end-users email address.\n     * @param password The end-users password.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"emailPassword\",\n    value: function emailPassword(email, password) {\n      return new Credentials(\"local-userpass\", \"local-userpass\", {\n        username: email,\n        password: password\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Custom Function Provider](https://docs.mongodb.com/realm/authentication/custom-function/).\n     *\n     * @param payload The custom payload as expected by the server.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"function\",\n    value: function _function(payload) {\n      return new Credentials(\"custom-function\", \"custom-function\", payload);\n    }\n    /**\n     * Creates credentials that logs in using the [Custom JWT Provider](https://docs.mongodb.com/realm/authentication/custom-jwt/).\n     *\n     * @param token The JSON Web Token (JWT).\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"jwt\",\n    value: function jwt(token) {\n      return new Credentials(\"custom-token\", \"custom-token\", {\n        token: token\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Google Provider](https://docs.mongodb.com/realm/authentication/google/).\n     *\n     * @param payload The URL that users should be redirected to, the auth code or id token from Google.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"google\",\n    value: function google(payload) {\n      return new Credentials(\"oauth2-google\", \"oauth2-google\", Credentials.derivePayload(payload));\n    }\n    /**\n     * @param payload The payload string.\n     * @returns A payload object based on the string.\n     */\n\n  }, {\n    key: \"derivePayload\",\n    value: function derivePayload(payload) {\n      if (typeof payload === \"string\") {\n        if (payload.includes(\"://\")) {\n          return this.derivePayload({\n            redirectUrl: payload\n          });\n        } else if (payload.startsWith(\"4/\")) {\n          return this.derivePayload({\n            authCode: payload\n          });\n        } else if (payload.startsWith(\"ey\")) {\n          // eslint-disable-next-line @typescript-eslint/camelcase\n          return this.derivePayload({\n            idToken: payload\n          });\n        } else {\n          throw new Error(\"Unexpected payload: \".concat(payload));\n        }\n      } else if (Object.keys(payload).length === 1) {\n        if (\"authCode\" in payload || \"redirectUrl\" in payload) {\n          return payload;\n        } else if (\"idToken\" in payload) {\n          // eslint-disable-next-line @typescript-eslint/camelcase\n          return {\n            id_token: payload.idToken\n          };\n        } else {\n          throw new Error(\"Unexpected payload: \" + JSON.stringify(payload));\n        }\n      } else {\n        throw new Error(\"Expected only one property in payload, got \" + JSON.stringify(payload));\n      }\n    }\n    /**\n     * Creates credentials that logs in using the [Facebook Provider](https://docs.mongodb.com/realm/authentication/facebook/).\n     *\n     * @param redirectUrlOrAccessToken The URL that users should be redirected to or the auth code returned from Facebook.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"facebook\",\n    value: function facebook(redirectUrlOrAccessToken) {\n      return new Credentials(\"oauth2-facebook\", \"oauth2-facebook\", redirectUrlOrAccessToken.includes(\"://\") ? {\n        redirectUrl: redirectUrlOrAccessToken\n      } : {\n        accessToken: redirectUrlOrAccessToken\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Apple ID Provider](https://docs.mongodb.com/realm/authentication/apple/).\n     *\n     * @param redirectUrlOrIdToken The URL that users should be redirected to or the id_token returned from Apple.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"apple\",\n    value: function apple(redirectUrlOrIdToken) {\n      return new Credentials(\"oauth2-apple\", \"oauth2-apple\", redirectUrlOrIdToken.includes(\"://\") ? {\n        redirectUrl: redirectUrlOrIdToken\n      } : {\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        id_token: redirectUrlOrIdToken\n      });\n    }\n  }]);\n\n  return Credentials;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar USER_IDS_STORAGE_KEY = \"userIds\";\nvar DEVICE_ID_STORAGE_KEY = \"deviceId\";\n/**\n * Storage specific to the app.\n */\n\nvar AppStorage = /*#__PURE__*/function (_PrefixedStorage2) {\n  _inherits(AppStorage, _PrefixedStorage2);\n\n  var _super3 = _createSuper(AppStorage);\n\n  /**\n   * @param storage The underlying storage to wrap.\n   * @param appId The id of the app.\n   */\n  function AppStorage(storage, appId) {\n    _classCallCheck(this, AppStorage);\n\n    return _super3.call(this, storage, \"app(\".concat(appId, \")\"));\n  }\n  /**\n   * Reads out the list of user ids from storage.\n   *\n   * @returns A list of user ids.\n   */\n\n\n  _createClass(AppStorage, [{\n    key: \"getUserIds\",\n    value: function getUserIds() {\n      var userIdsString = this.get(USER_IDS_STORAGE_KEY);\n      var userIds = userIdsString ? JSON.parse(userIdsString) : [];\n\n      if (Array.isArray(userIds)) {\n        // Remove any duplicates that might have been added\n        // The Set preserves insertion order\n        return _toConsumableArray(new Set(userIds));\n      } else {\n        throw new Error(\"Expected the user ids to be an array\");\n      }\n    }\n    /**\n     * Sets the list of ids in storage.\n     * Optionally merging with existing ids stored in the storage, by prepending these while voiding duplicates.\n     *\n     * @param userIds The list of ids to store.\n     * @param mergeWithExisting Prepend existing ids to avoid data-races with other apps using this storage.\n     */\n\n  }, {\n    key: \"setUserIds\",\n    value: function setUserIds(userIds, mergeWithExisting) {\n      if (mergeWithExisting) {\n        // Add any existing user id to the end of this list, avoiding duplicates\n        var existingIds = this.getUserIds();\n\n        var _iterator3 = _createForOfIteratorHelper(existingIds),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var id = _step3.value;\n\n            if (userIds.indexOf(id) === -1) {\n              userIds.push(id);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      } // Store the list of ids\n\n\n      this.set(USER_IDS_STORAGE_KEY, JSON.stringify(userIds));\n    }\n    /**\n     * Remove an id from the list of ids.\n     *\n     * @param userId The id of a User to be removed.\n     */\n\n  }, {\n    key: \"removeUserId\",\n    value: function removeUserId(userId) {\n      var existingIds = this.getUserIds();\n      var userIds = existingIds.filter(function (id) {\n        return id !== userId;\n      }); // Store the list of ids\n\n      this.setUserIds(userIds, false);\n    }\n    /**\n     * @returns id of this device (if any exists)\n     */\n\n  }, {\n    key: \"getDeviceId\",\n    value: function getDeviceId() {\n      return this.get(DEVICE_ID_STORAGE_KEY);\n    }\n    /**\n     * @param deviceId The id of this device, to send on subsequent authentication requests.\n     */\n\n  }, {\n    key: \"setDeviceId\",\n    value: function setDeviceId(deviceId) {\n      this.set(DEVICE_ID_STORAGE_KEY, deviceId);\n    }\n  }]);\n\n  return AppStorage;\n}(PrefixedStorage); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar LOWERCASE_LETTERS = \"abcdefghijklmnopqrstuvwxyz\";\nvar CLOSE_CHECK_INTERVAL = 100; // 10 times per second\n\n/* eslint-disable @typescript-eslint/camelcase */\n\nvar REDIRECT_HASH_TO_RESULT = {\n  _stitch_client_app_id: \"appId\",\n  _baas_client_app_id: \"appId\",\n  _stitch_ua: \"userAuth\",\n  _baas_ua: \"userAuth\",\n  _stitch_link: \"link\",\n  _baas_link: \"link\",\n  _stitch_error: \"error\",\n  _baas_error: \"error\",\n  _stitch_state: \"state\",\n  _baas_state: \"state\"\n};\n/* eslint-enable @typescript-eslint/camelcase */\n\n/**\n * A collection of methods helping implement the OAuth2 flow.\n */\n\nvar OAuth2Helper = /*#__PURE__*/function () {\n  /**\n   * @param storage The underlying storage to use when storing and retriving secrets.\n   * @param openWindow An optional function called when a browser window needs to open.\n   */\n  function OAuth2Helper(storage) {\n    var openWindow = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getEnvironment().openWindow;\n\n    _classCallCheck(this, OAuth2Helper);\n\n    this.storage = storage.prefix(\"oauth2\");\n    this.openWindow = openWindow;\n  }\n  /**\n   * Parses the query string from the final step of the OAuth flow.\n   *\n   * @param queryString The query string passed through in location.hash.\n   * @returns The result of the OAuth flow.\n   */\n\n\n  _createClass(OAuth2Helper, [{\n    key: \"openWindowAndWaitForRedirect\",\n    value:\n    /**\n     * Open a window and wait for the redirect to be handled.\n     *\n     * @param url The URL to open.\n     * @param state The state which will be used to listen for storage updates.\n     * @returns The result passed through the redirect.\n     */\n    function openWindowAndWaitForRedirect(url, state) {\n      var _this3 = this;\n\n      var stateStorage = OAuth2Helper.getStateStorage(this.storage, state); // Return a promise that resolves when the  gets known\n\n      return new Promise(function (resolve, reject) {\n        var redirectWindow = null; // We're declaring the interval now to enable referencing before its initialized\n\n        var windowClosedInterval; // eslint-disable-line prefer-const\n\n        var handleStorageUpdate = function handleStorageUpdate() {\n          // Trying to get the secret from storage\n          var result = stateStorage.get(\"result\");\n\n          if (result) {\n            var parsedResult = JSON.parse(result); // The secret got updated!\n\n            stateStorage.removeListener(handleStorageUpdate); // Clear the storage to prevent others from reading this\n\n            stateStorage.clear(); // Try closing the newly created window\n\n            try {\n              if (redirectWindow) {\n                // Stop checking if the window closed\n                clearInterval(windowClosedInterval);\n                redirectWindow.close();\n              }\n            } catch (err) {\n              console.warn(\"Failed closing redirect window: \".concat(err));\n            } finally {\n              resolve(parsedResult);\n            }\n          }\n        }; // Add a listener to the state storage, awaiting an update to the secret\n\n\n        stateStorage.addListener(handleStorageUpdate); // Open up a window\n\n        redirectWindow = _this3.openWindow(url); // Not using a const, because we need the two listeners to reference each other when removing the other.\n\n        windowClosedInterval = setInterval(function () {\n          // Polling \"closed\" because registering listeners on the window violates cross-origin policies\n          if (!redirectWindow) {\n            // No need to keep polling for a window that we can't check\n            clearInterval(windowClosedInterval);\n          } else if (redirectWindow.closed) {\n            // Stop polling the window state\n            clearInterval(windowClosedInterval); // Stop listening for changes to the storage\n\n            stateStorage.removeListener(handleStorageUpdate); // Reject the promise\n\n            var err = new Error(\"Window closed\");\n            reject(err);\n          }\n        }, CLOSE_CHECK_INTERVAL);\n      });\n    }\n    /**\n     * Generate a random state string.\n     *\n     * @returns The random state string.\n     */\n\n  }, {\n    key: \"generateState\",\n    value: function generateState() {\n      return generateRandomString(12, LOWERCASE_LETTERS);\n    }\n  }], [{\n    key: \"parseRedirectLocation\",\n    value: function parseRedirectLocation(queryString) {\n      var params = decodeQueryString(queryString);\n      var result = {};\n\n      for (var _i2 = 0, _Object$entries2 = Object.entries(REDIRECT_HASH_TO_RESULT); _i2 < _Object$entries2.length; _i2++) {\n        var _Object$entries2$_i = _slicedToArray(_Object$entries2[_i2], 2),\n            p = _Object$entries2$_i[0],\n            r = _Object$entries2$_i[1];\n\n        var value = params[p];\n\n        if (value) {\n          result[r] = value;\n        }\n      }\n\n      return result;\n    }\n    /**\n     * Handle the redirect querystring by parsing it and storing it for others to consume.\n     *\n     * @param queryString The query string containing the encoded result from the OAuth provider.\n     * @param storage The underlying storage used to persist the result.\n     */\n\n  }, {\n    key: \"handleRedirect\",\n    value: function handleRedirect(queryString) {\n      var storage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getEnvironment().defaultStorage;\n      var result = OAuth2Helper.parseRedirectLocation(queryString);\n      var state = result.state,\n          error = result.error;\n\n      if (typeof state === \"string\") {\n        var oauth2Storage = storage.prefix(\"oauth2\");\n        var stateStorage = OAuth2Helper.getStateStorage(oauth2Storage, state);\n        stateStorage.set(\"result\", JSON.stringify(result));\n      } else if (error) {\n        throw new Error(\"Failed to handle OAuth 2.0 redirect: \".concat(error));\n      } else {\n        throw new Error(\"Failed to handle OAuth 2.0 redirect.\");\n      }\n    }\n    /**\n     * Decodes the authInfo string into its seperate parts.\n     *\n     * @param authInfo An authInfo string returned from the server.\n     * @returns An object containing the separate parts of the authInfo string.\n     */\n\n  }, {\n    key: \"decodeAuthInfo\",\n    value: function decodeAuthInfo(authInfo) {\n      var parts = (authInfo || \"\").split(\"$\");\n\n      if (parts.length === 4) {\n        var _parts = _slicedToArray(parts, 4),\n            accessToken = _parts[0],\n            refreshToken = _parts[1],\n            userId = _parts[2],\n            deviceId = _parts[3];\n\n        return {\n          accessToken: accessToken,\n          refreshToken: refreshToken,\n          userId: userId,\n          deviceId: deviceId\n        };\n      } else {\n        throw new Error(\"Failed to decode 'authInfo' into ids and tokens\");\n      }\n    }\n    /**\n     * Get the storage key associated of an secret associated with a state.\n     *\n     * @param storage The root storage used to derive a \"state namespaced\" storage.\n     * @param state The random state.\n     * @returns The storage associated with a particular state.\n     */\n\n  }, {\n    key: \"getStateStorage\",\n    value: function getStateStorage(storage, state) {\n      return storage.prefix(\"state(\".concat(state, \")\"));\n    }\n  }]);\n\n  return OAuth2Helper;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar REDIRECT_LOCATION_HEADER = \"x-baas-location\";\n/**\n * Handles authentication and linking of users.\n */\n\nvar Authenticator = /*#__PURE__*/function () {\n  /**\n   * @param fetcher The fetcher used to fetch responses from the server.\n   * @param storage The storage used when completing OAuth 2.0 flows (should not be scoped to a specific app).\n   * @param getDeviceInformation Called to get device information to be sent to the server.\n   */\n  function Authenticator(fetcher, storage, getDeviceInformation) {\n    _classCallCheck(this, Authenticator);\n\n    this.fetcher = fetcher;\n    this.oauth2 = new OAuth2Helper(storage);\n    this.getDeviceInformation = getDeviceInformation;\n  }\n  /**\n   * @param credentials Credentials to use when logging in.\n   * @param linkingUser A user requesting to link.\n   */\n\n\n  _createClass(Authenticator, [{\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(credentials, linkingUser) {\n        var deviceInformation, isLinking, state, url, response, redirectUrl, logInUrl, _response, userId, accessToken, _response$refresh_tok, refreshToken, deviceId;\n\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                deviceInformation = this.getDeviceInformation();\n                isLinking = typeof linkingUser === \"object\";\n\n                if (!(credentials.providerType.startsWith(\"oauth2\") && typeof credentials.payload.redirectUrl === \"string\")) {\n                  _context19.next = 22;\n                  break;\n                }\n\n                // Initiate the OAuth2 flow by generating a state and fetch a redirect URL\n                state = this.oauth2.generateState();\n                _context19.next = 6;\n                return this.getLogInUrl(credentials, isLinking, {\n                  state: state,\n                  redirect: credentials.payload.redirectUrl,\n                  // Ensure redirects are communicated in a header different from \"Location\" and status remains 200 OK\n                  providerRedirectHeader: isLinking ? true : undefined,\n                  // Add the device information, only if we're not linking - since that request won't have a body of its own.\n                  device: !isLinking ? deviceInformation.encode() : undefined\n                });\n\n              case 6:\n                url = _context19.sent;\n\n                if (!isLinking) {\n                  _context19.next = 19;\n                  break;\n                }\n\n                _context19.next = 10;\n                return this.fetcher.fetch({\n                  method: \"GET\",\n                  url: url,\n                  tokenType: isLinking ? \"access\" : \"none\",\n                  user: linkingUser,\n                  // The response will set a cookie that we need to tell the browser to store\n                  mode: \"cors\",\n                  credentials: \"include\"\n                });\n\n              case 10:\n                response = _context19.sent;\n                // If a response header contains a redirect URL: Open a window and wait for the redirect to be handled\n                redirectUrl = response.headers.get(REDIRECT_LOCATION_HEADER);\n\n                if (!redirectUrl) {\n                  _context19.next = 16;\n                  break;\n                }\n\n                return _context19.abrupt(\"return\", this.openWindowAndWaitForAuthResponse(redirectUrl, state));\n\n              case 16:\n                throw new Error(\"Missing \".concat(REDIRECT_LOCATION_HEADER, \" header\"));\n\n              case 17:\n                _context19.next = 20;\n                break;\n\n              case 19:\n                return _context19.abrupt(\"return\", this.openWindowAndWaitForAuthResponse(url, state));\n\n              case 20:\n                _context19.next = 34;\n                break;\n\n              case 22:\n                _context19.next = 24;\n                return this.getLogInUrl(credentials, isLinking);\n\n              case 24:\n                logInUrl = _context19.sent;\n                _context19.next = 27;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  url: logInUrl,\n                  body: _objectSpread(_objectSpread({}, credentials.payload), {}, {\n                    options: {\n                      device: deviceInformation.toJSON()\n                    }\n                  }),\n                  tokenType: isLinking ? \"access\" : \"none\",\n                  user: linkingUser\n                });\n\n              case 27:\n                _response = _context19.sent;\n                // Spread out values from the response and ensure they're valid\n                userId = _response.user_id, accessToken = _response.access_token, _response$refresh_tok = _response.refresh_token, refreshToken = _response$refresh_tok === void 0 ? null : _response$refresh_tok, deviceId = _response.device_id;\n\n                if (!(typeof userId !== \"string\")) {\n                  _context19.next = 31;\n                  break;\n                }\n\n                throw new Error(\"Expected a user id in the response\");\n\n              case 31:\n                if (!(typeof accessToken !== \"string\")) {\n                  _context19.next = 33;\n                  break;\n                }\n\n                throw new Error(\"Expected an access token in the response\");\n\n              case 33:\n                return _context19.abrupt(\"return\", {\n                  userId: userId,\n                  accessToken: accessToken,\n                  refreshToken: refreshToken,\n                  deviceId: deviceId\n                });\n\n              case 34:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      function authenticate(_x19, _x20) {\n        return _authenticate.apply(this, arguments);\n      }\n\n      return authenticate;\n    }()\n    /**\n     * @param credentials Credentials to use when logging in.\n     * @param link Should the request link with the current user?\n     * @param extraQueryParams Any extra parameters to include in the query string\n     */\n\n  }, {\n    key: \"getLogInUrl\",\n    value: function () {\n      var _getLogInUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee20(credentials) {\n        var link,\n            extraQueryParams,\n            appRoute,\n            loginRoute,\n            qs,\n            locationUrl,\n            _args20 = arguments;\n        return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                link = _args20.length > 1 && _args20[1] !== undefined ? _args20[1] : false;\n                extraQueryParams = _args20.length > 2 && _args20[2] !== undefined ? _args20[2] : {};\n                // See https://github.com/mongodb/stitch-js-sdk/blob/310f0bd5af80f818cdfbc3caf1ae29ffa8e9c7cf/packages/core/sdk/src/auth/internal/CoreStitchAuth.ts#L746-L780\n                appRoute = this.fetcher.appRoute;\n                loginRoute = appRoute.authProvider(credentials.providerName).login();\n                qs = encodeQueryString(_objectSpread({\n                  link: link ? \"true\" : undefined\n                }, extraQueryParams));\n                _context20.next = 7;\n                return this.fetcher.locationUrl;\n\n              case 7:\n                locationUrl = _context20.sent;\n                return _context20.abrupt(\"return\", locationUrl + loginRoute.path + qs);\n\n              case 9:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20, this);\n      }));\n\n      function getLogInUrl(_x21) {\n        return _getLogInUrl.apply(this, arguments);\n      }\n\n      return getLogInUrl;\n    }()\n  }, {\n    key: \"openWindowAndWaitForAuthResponse\",\n    value: function () {\n      var _openWindowAndWaitForAuthResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee21(redirectUrl, state) {\n        var redirectResult;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                _context21.next = 2;\n                return this.oauth2.openWindowAndWaitForRedirect(redirectUrl, state);\n\n              case 2:\n                redirectResult = _context21.sent;\n                return _context21.abrupt(\"return\", OAuth2Helper.decodeAuthInfo(redirectResult.userAuth));\n\n              case 4:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n\n      function openWindowAndWaitForAuthResponse(_x22, _x23) {\n        return _openWindowAndWaitForAuthResponse.apply(this, arguments);\n      }\n\n      return openWindowAndWaitForAuthResponse;\n    }()\n  }]);\n\n  return Authenticator;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n// TODO: Determine if the shape of an error response is specific to each service or widely used.\n\n/**\n * An error produced while communicating with the MongoDB Realm server.\n */\n\n\nvar MongoDBRealmError = /*#__PURE__*/function (_Error2) {\n  _inherits(MongoDBRealmError, _Error2);\n\n  var _super4 = _createSuper(MongoDBRealmError);\n\n  function MongoDBRealmError(method, url, statusCode, statusText, error, errorCode, link) {\n    var _this4;\n\n    _classCallCheck(this, MongoDBRealmError);\n\n    var summary = statusText ? \"status \".concat(statusCode, \" \").concat(statusText) : \"status \".concat(statusCode);\n\n    if (typeof error === \"string\") {\n      _this4 = _super4.call(this, \"Request failed (\".concat(method, \" \").concat(url, \"): \").concat(error, \" (\").concat(summary, \")\"));\n    } else {\n      _this4 = _super4.call(this, \"Request failed (\".concat(method, \" \").concat(url, \"): (\").concat(summary, \")\"));\n    }\n\n    _this4.method = method;\n    _this4.url = url;\n    _this4.statusText = statusText;\n    _this4.statusCode = statusCode;\n    _this4.error = error;\n    _this4.errorCode = errorCode;\n    _this4.link = link;\n    return _possibleConstructorReturn(_this4);\n  }\n  /**\n   * Constructs and returns an error from a request and a response.\n   * Note: The caller must throw this error themselves.\n   *\n   * @param request The request sent to the server.\n   * @param response A raw response, as returned from the server.\n   */\n\n\n  _createClass(MongoDBRealmError, null, [{\n    key: \"fromRequestAndResponse\",\n    value: function () {\n      var _fromRequestAndResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee22(request, response) {\n        var _a, url, method, status, statusText, body, error, errorCode, link;\n\n        return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                url = request.url, method = request.method;\n                status = response.status, statusText = response.statusText;\n\n                if (!((_a = response.headers.get(\"content-type\")) === null || _a === void 0 ? void 0 : _a.startsWith(\"application/json\"))) {\n                  _context22.next = 12;\n                  break;\n                }\n\n                _context22.next = 5;\n                return response.json();\n\n              case 5:\n                body = _context22.sent;\n                error = body.error || \"No message\";\n                errorCode = body.error_code;\n                link = body.link;\n                return _context22.abrupt(\"return\", new MongoDBRealmError(method, url, status, statusText, error, errorCode, link));\n\n              case 12:\n                return _context22.abrupt(\"return\", new MongoDBRealmError(method, url, status, statusText));\n\n              case 13:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22);\n      }));\n\n      function fromRequestAndResponse(_x24, _x25) {\n        return _fromRequestAndResponse.apply(this, arguments);\n      }\n\n      return fromRequestAndResponse;\n    }()\n  }]);\n\n  return MongoDBRealmError;\n}( /*#__PURE__*/_wrapNativeSuper(Error)); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * @param body A possible resonse body.\n * @returns An async iterator.\n */\n\n\nfunction asyncIteratorFromResponseBody(body) {\n  if (typeof body !== \"object\" || body === null) {\n    throw new Error(\"Expected a non-null object\");\n  } else if (Symbol.asyncIterator in body) {\n    return body;\n  } else if (\"getReader\" in body) {\n    var stream = body;\n    return _defineProperty({}, Symbol.asyncIterator, function () {\n      var reader = stream.getReader();\n      return {\n        next: function next() {\n          return reader.read();\n        },\n        return: function _return() {\n          return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee23() {\n            return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n              while (1) {\n                switch (_context23.prev = _context23.next) {\n                  case 0:\n                    _context23.next = 2;\n                    return reader.cancel();\n\n                  case 2:\n                    return _context23.abrupt(\"return\", {\n                      done: true,\n                      value: null\n                    });\n\n                  case 3:\n                  case \"end\":\n                    return _context23.stop();\n                }\n              }\n            }, _callee23);\n          }))();\n        }\n      };\n    });\n  } else {\n    throw new Error(\"Expected an AsyncIterable or a ReadableStream\");\n  }\n}\n/**\n * Wraps a NetworkTransport from the \"realm-network-transport\" package.\n * Extracts error messages and throws `MongoDBRealmError` objects upon failures.\n * Injects access or refresh tokens for a current or specific user.\n * Refreshes access tokens if requests fails due to a 401 error.\n * Optionally parses response as JSON before returning it.\n * Fetches and exposes an app's location url.\n */\n\n\nvar Fetcher = /*#__PURE__*/function () {\n  /**\n   * @param config A configuration of the fetcher.\n   */\n  function Fetcher(_ref11) {\n    var appId = _ref11.appId,\n        transport = _ref11.transport,\n        userContext = _ref11.userContext,\n        locationUrlContext = _ref11.locationUrlContext;\n\n    _classCallCheck(this, Fetcher);\n\n    this.appId = appId;\n    this.transport = transport;\n    this.userContext = userContext;\n    this.locationUrlContext = locationUrlContext;\n  }\n  /**\n   * @param user An optional user to generate the header for.\n   * @param tokenType The type of token (access or refresh).\n   * @returns An object containing the user's token as \"Authorization\" header or undefined if no user is given.\n   */\n\n\n  _createClass(Fetcher, [{\n    key: \"clone\",\n    value: function clone(config) {\n      return new Fetcher(_objectSpread({\n        appId: this.appId,\n        transport: this.transport,\n        userContext: this.userContext,\n        locationUrlContext: this.locationUrlContext\n      }, config));\n    }\n    /**\n     * Fetch a network resource as an authenticated user.\n     *\n     * @param request The request which should be sent to the server.\n     * @returns The response from the server.\n     */\n\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee24(request) {\n        var path, url, _request$tokenType, tokenType, _request$user, user, restOfRequest, _url, response;\n\n        return _regeneratorRuntime.wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                path = request.path, url = request.url, _request$tokenType = request.tokenType, tokenType = _request$tokenType === void 0 ? \"access\" : _request$tokenType, _request$user = request.user, user = _request$user === void 0 ? this.userContext.currentUser : _request$user, restOfRequest = _objectWithoutProperties(request, [\"path\", \"url\", \"tokenType\", \"user\"]);\n\n                if (!(typeof path === \"string\" && typeof url === \"string\")) {\n                  _context24.next = 5;\n                  break;\n                }\n\n                throw new Error(\"Use of 'url' and 'path' mutually exclusive\");\n\n              case 5:\n                if (!(typeof path === \"string\")) {\n                  _context24.next = 14;\n                  break;\n                }\n\n                _context24.next = 8;\n                return this.locationUrlContext.locationUrl;\n\n              case 8:\n                _context24.t0 = _context24.sent;\n                _context24.t1 = path;\n                _url = _context24.t0 + _context24.t1;\n                return _context24.abrupt(\"return\", this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  path: undefined,\n                  url: _url\n                })));\n\n              case 14:\n                if (!(typeof url === \"string\")) {\n                  _context24.next = 34;\n                  break;\n                }\n\n                _context24.next = 17;\n                return this.transport.fetch(_objectSpread(_objectSpread({}, restOfRequest), {}, {\n                  url: url,\n                  headers: _objectSpread(_objectSpread({}, Fetcher.buildAuthorizationHeader(user, tokenType)), request.headers)\n                }));\n\n              case 17:\n                response = _context24.sent;\n\n                if (!response.ok) {\n                  _context24.next = 22;\n                  break;\n                }\n\n                return _context24.abrupt(\"return\", response);\n\n              case 22:\n                if (!(user && response.status === 401 && tokenType === \"access\")) {\n                  _context24.next = 28;\n                  break;\n                }\n\n                _context24.next = 25;\n                return user.refreshAccessToken();\n\n              case 25:\n                return _context24.abrupt(\"return\", this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  user: user\n                })));\n\n              case 28:\n                if (user && response.status === 401 && tokenType === \"refresh\") {\n                  // A 401 error while using the refresh token indicates the token has an issue.\n                  // Reset the tokens to prevent a lock.\n                  user.accessToken = null;\n                  user.refreshToken = null;\n                } // Throw an error with a message extracted from the body\n\n\n                _context24.next = 31;\n                return MongoDBRealmError.fromRequestAndResponse(request, response);\n\n              case 31:\n                throw _context24.sent;\n\n              case 32:\n                _context24.next = 35;\n                break;\n\n              case 34:\n                throw new Error(\"Expected either 'url' or 'path'\");\n\n              case 35:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      function fetch(_x26) {\n        return _fetch2.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n    /**\n     * Fetch a network resource as an authenticated user and parse the result as extended JSON.\n     *\n     * @param request The request which should be sent to the server.\n     * @returns The response from the server, parsed as extended JSON.\n     */\n\n  }, {\n    key: \"fetchJSON\",\n    value: function () {\n      var _fetchJSON = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee25(request) {\n        var body, serializedBody, contentTypeHeaders, response, contentType, responseBody;\n        return _regeneratorRuntime.wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                body = request.body;\n                serializedBody = Fetcher.buildBody(body);\n                contentTypeHeaders = Fetcher.buildJsonHeader(serializedBody);\n                _context25.next = 5;\n                return this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  body: serializedBody,\n                  headers: _objectSpread(_objectSpread({\n                    Accept: \"application/json\"\n                  }, contentTypeHeaders), request.headers)\n                }));\n\n              case 5:\n                response = _context25.sent;\n                contentType = response.headers.get(\"content-type\");\n\n                if (!(contentType === null || contentType === void 0 ? void 0 : contentType.startsWith(\"application/json\"))) {\n                  _context25.next = 14;\n                  break;\n                }\n\n                _context25.next = 10;\n                return response.json();\n\n              case 10:\n                responseBody = _context25.sent;\n                return _context25.abrupt(\"return\", deserialize(responseBody));\n\n              case 14:\n                if (!(contentType === null)) {\n                  _context25.next = 18;\n                  break;\n                }\n\n                return _context25.abrupt(\"return\", null);\n\n              case 18:\n                throw new Error(\"Expected JSON response, got \\\"\".concat(contentType, \"\\\"\"));\n\n              case 19:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25, this);\n      }));\n\n      function fetchJSON(_x27) {\n        return _fetchJSON.apply(this, arguments);\n      }\n\n      return fetchJSON;\n    }()\n    /**\n     * Fetch an \"event-stream\" resource as an authenticated user.\n     *\n     * @param request The request which should be sent to the server.\n     */\n\n  }, {\n    key: \"fetchStream\",\n    value: function () {\n      var _fetchStream = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee26(request) {\n        var _yield$this$fetch, body;\n\n        return _regeneratorRuntime.wrap(function _callee26$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n                _context26.next = 2;\n                return this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  headers: _objectSpread({\n                    Accept: \"text/event-stream\"\n                  }, request.headers)\n                }));\n\n              case 2:\n                _yield$this$fetch = _context26.sent;\n                body = _yield$this$fetch.body;\n                return _context26.abrupt(\"return\", asyncIteratorFromResponseBody(body));\n\n              case 5:\n              case \"end\":\n                return _context26.stop();\n            }\n          }\n        }, _callee26, this);\n      }));\n\n      function fetchStream(_x28) {\n        return _fetchStream.apply(this, arguments);\n      }\n\n      return fetchStream;\n    }()\n    /**\n     * @returns The path of the app route.\n     */\n\n  }, {\n    key: \"appRoute\",\n    get: function get() {\n      return routes.api().app(this.appId);\n    }\n    /**\n     * @returns A promise of the location URL of the app.\n     */\n\n  }, {\n    key: \"locationUrl\",\n    get: function get() {\n      return this.locationUrlContext.locationUrl;\n    }\n  }], [{\n    key: \"buildAuthorizationHeader\",\n    value: function buildAuthorizationHeader(user, tokenType) {\n      if (!user || tokenType === \"none\") {\n        return {};\n      } else if (tokenType === \"access\") {\n        return {\n          Authorization: \"Bearer \".concat(user.accessToken)\n        };\n      } else if (tokenType === \"refresh\") {\n        return {\n          Authorization: \"Bearer \".concat(user.refreshToken)\n        };\n      } else {\n        throw new Error(\"Unexpected token type (\".concat(tokenType, \")\"));\n      }\n    }\n    /**\n     * @param body The body string or object passed from a request.\n     * @returns An object optionally specifying the \"Content-Type\" header.\n     */\n\n  }, {\n    key: \"buildBody\",\n    value: function buildBody(body) {\n      if (!body) {\n        return;\n      } else if (typeof body === \"object\" && body !== null) {\n        return JSON.stringify(serialize(body));\n      } else if (typeof body === \"string\") {\n        return body;\n      } else {\n        console.log(\"body is\", body);\n        throw new Error(\"Unexpected type of body\");\n      }\n    }\n    /**\n     * @param body The body string or object passed from a request.\n     * @returns An object optionally specifying the \"Content-Type\" header.\n     */\n\n  }, {\n    key: \"buildJsonHeader\",\n    value: function buildJsonHeader(body) {\n      if (body && body.length > 0) {\n        return {\n          \"Content-Type\": \"application/json\"\n        };\n      } else {\n        return {};\n      }\n    }\n  }]);\n\n  return Fetcher;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * The key in a storage on which the device id is stored.\n */\n\n\nvar DEVICE_ID_STORAGE_KEY$1 = \"deviceId\";\nvar DeviceFields;\n\n(function (DeviceFields) {\n  DeviceFields[\"DEVICE_ID\"] = \"deviceId\";\n  DeviceFields[\"APP_ID\"] = \"appId\";\n  DeviceFields[\"APP_VERSION\"] = \"appVersion\";\n  DeviceFields[\"PLATFORM\"] = \"platform\";\n  DeviceFields[\"PLATFORM_VERSION\"] = \"platformVersion\";\n  DeviceFields[\"SDK_VERSION\"] = \"sdkVersion\";\n})(DeviceFields || (DeviceFields = {}));\n/**\n * Information describing the device, app and SDK.\n */\n\n\nvar DeviceInformation = /*#__PURE__*/function () {\n  /**\n   * @param params Construct the device information from these parameters.\n   */\n  function DeviceInformation(_ref12) {\n    var appId = _ref12.appId,\n        appVersion = _ref12.appVersion,\n        deviceId = _ref12.deviceId;\n\n    _classCallCheck(this, DeviceInformation);\n\n    /**\n     * The version of the Realm Web SDK (constant provided by Rollup).\n     */\n    this.sdkVersion = \"1.2.1\";\n    var environment = getEnvironment();\n    this.platform = environment.platform;\n    this.platformVersion = environment.platformVersion;\n    this.appId = appId;\n    this.appVersion = appVersion;\n    this.deviceId = deviceId;\n  }\n  /**\n   * @returns An base64 URI encoded representation of the device information.\n   */\n\n\n  _createClass(DeviceInformation, [{\n    key: \"encode\",\n    value: function encode() {\n      var obj = removeKeysWithUndefinedValues(this);\n      return base64.Base64.encode(JSON.stringify(obj));\n    }\n    /**\n     * @returns The defaults\n     */\n\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return removeKeysWithUndefinedValues(this);\n    }\n  }]);\n\n  return DeviceInformation;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Default base url to prefix all requests if no baseUrl is specified in the configuration.\n */\n\n\nvar DEFAULT_BASE_URL = \"https://stitch.mongodb.com\";\n/**\n * MongoDB Realm App\n */\n\nvar App = /*#__PURE__*/function () {\n  /**\n   * Construct a Realm App, either from the Realm App id visible from the MongoDB Realm UI or a configuration.\n   *\n   * @param idOrConfiguration The Realm App id or a configuration to use for this app.\n   */\n  function App(idOrConfiguration) {\n    var _this5 = this;\n\n    _classCallCheck(this, App);\n\n    /**\n     * An array of active and logged-out users.\n     * Elements in the beginning of the array is considered more recent than the later elements.\n     */\n    this.users = [];\n    /**\n     * A promise resolving to the App's location url.\n     */\n\n    this._locationUrl = null; // If the argument is a string, convert it to a simple configuration object.\n\n    var configuration = typeof idOrConfiguration === \"string\" ? {\n      id: idOrConfiguration\n    } : idOrConfiguration; // Initialize properties from the configuration\n\n    if (typeof configuration === \"object\" && typeof configuration.id === \"string\") {\n      this.id = configuration.id;\n    } else {\n      throw new Error(\"Missing a MongoDB Realm app-id\");\n    }\n\n    this.baseUrl = configuration.baseUrl || DEFAULT_BASE_URL;\n    this.localApp = configuration.app;\n    var storage = configuration.storage,\n        _configuration$transp = configuration.transport,\n        transport = _configuration$transp === void 0 ? new DefaultNetworkTransport() : _configuration$transp; // Construct a fetcher wrapping the network transport\n\n    this.fetcher = new Fetcher({\n      appId: this.id,\n      userContext: this,\n      locationUrlContext: this,\n      transport: transport\n    }); // Construct the auth providers\n\n    this.emailPasswordAuth = new EmailPasswordAuth(this.fetcher); // Construct the storage\n\n    var baseStorage = storage || getEnvironment().defaultStorage;\n    this.storage = new AppStorage(baseStorage, this.id);\n    this.authenticator = new Authenticator(this.fetcher, baseStorage, function () {\n      return _this5.deviceInformation;\n    }); // Hydrate the app state from storage\n\n    try {\n      this.hydrate();\n    } catch (err) {\n      // The storage was corrupted\n      this.storage.clear(); // A failed hydration shouldn't throw and break the app experience\n      // Since this is \"just\" persisted state that unfortunately got corrupted or partially lost\n\n      console.warn(\"Realm app hydration failed:\", err.message);\n    }\n  }\n  /**\n   * Get or create a singleton Realm App from an id.\n   * Calling this function multiple times with the same id will return the same instance.\n   *\n   * @param id The Realm App id visible from the MongoDB Realm UI or a configuration.\n   * @returns The Realm App instance.\n   */\n\n\n  _createClass(App, [{\n    key: \"switchUser\",\n    value:\n    /**\n     * Switch user.\n     *\n     * @param nextUser The user or id of the user to switch to.\n     */\n    function switchUser(nextUser) {\n      var index = this.users.findIndex(function (u) {\n        return u === nextUser;\n      });\n\n      if (index === -1) {\n        throw new Error(\"The user was never logged into this app\");\n      } // Remove the user from the stack\n\n\n      var _this$users$splice = this.users.splice(index, 1),\n          _this$users$splice2 = _slicedToArray(_this$users$splice, 1),\n          user = _this$users$splice2[0]; // Insert the user in the beginning of the stack\n\n\n      this.users.unshift(user);\n    }\n    /**\n     * Log in a user.\n     *\n     * @param credentials Credentials to use when logging in.\n     * @param fetchProfile Should the users profile be fetched? (default: true)\n     */\n\n  }, {\n    key: \"logIn\",\n    value: function () {\n      var _logIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee27(credentials) {\n        var fetchProfile,\n            response,\n            user,\n            deviceId,\n            _args27 = arguments;\n        return _regeneratorRuntime.wrap(function _callee27$(_context27) {\n          while (1) {\n            switch (_context27.prev = _context27.next) {\n              case 0:\n                fetchProfile = _args27.length > 1 && _args27[1] !== undefined ? _args27[1] : true;\n                _context27.next = 3;\n                return this.authenticator.authenticate(credentials);\n\n              case 3:\n                response = _context27.sent;\n                user = this.createOrUpdateUser(response, credentials.providerType); // Let's ensure this will be the current user, in case the user object was reused.\n\n                this.switchUser(user); // If neeeded, fetch and set the profile on the user\n\n                if (!fetchProfile) {\n                  _context27.next = 9;\n                  break;\n                }\n\n                _context27.next = 9;\n                return user.refreshProfile();\n\n              case 9:\n                // Persist the user id in the storage,\n                // merging to avoid overriding logins from other apps using the same underlying storage\n                this.storage.setUserIds(this.users.map(function (u) {\n                  return u.id;\n                }), true); // Read out and store the device id from the server\n\n                deviceId = response.deviceId;\n\n                if (deviceId && deviceId !== \"000000000000000000000000\") {\n                  this.storage.set(DEVICE_ID_STORAGE_KEY$1, deviceId);\n                } // Return the user\n\n\n                return _context27.abrupt(\"return\", user);\n\n              case 13:\n              case \"end\":\n                return _context27.stop();\n            }\n          }\n        }, _callee27, this);\n      }));\n\n      function logIn(_x29) {\n        return _logIn.apply(this, arguments);\n      }\n\n      return logIn;\n    }()\n    /**\n     * @inheritdoc\n     */\n\n  }, {\n    key: \"removeUser\",\n    value: function () {\n      var _removeUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee28(user) {\n        var index;\n        return _regeneratorRuntime.wrap(function _callee28$(_context28) {\n          while (1) {\n            switch (_context28.prev = _context28.next) {\n              case 0:\n                // Remove the user from the list of users\n                index = this.users.findIndex(function (u) {\n                  return u === user;\n                });\n\n                if (!(index === -1)) {\n                  _context28.next = 3;\n                  break;\n                }\n\n                throw new Error(\"The user was never logged into this app\");\n\n              case 3:\n                this.users.splice(index, 1); // Log out the user - this removes access and refresh tokens from storage\n\n                _context28.next = 6;\n                return user.logOut();\n\n              case 6:\n                // Remove the users profile from storage\n                this.storage.remove(\"user(\".concat(user.id, \"):profile\")); // Remove the user from the storage\n\n                this.storage.removeUserId(user.id);\n\n              case 8:\n              case \"end\":\n                return _context28.stop();\n            }\n          }\n        }, _callee28, this);\n      }));\n\n      function removeUser(_x30) {\n        return _removeUser.apply(this, arguments);\n      }\n\n      return removeUser;\n    }()\n    /**\n     * The currently active user (or null if no active users exists).\n     *\n     * @returns the currently active user or null.\n     */\n\n  }, {\n    key: \"currentUser\",\n    get: function get() {\n      var activeUsers = this.users.filter(function (user) {\n        return user.state === UserState.Active;\n      });\n\n      if (activeUsers.length === 0) {\n        return null;\n      } else {\n        // Current user is the top of the stack\n        return activeUsers[0];\n      }\n    }\n    /**\n     * All active and logged-out users:\n     *  - First in the list are active users (ordered by most recent call to switchUser or login)\n     *  - Followed by logged out users (also ordered by most recent call to switchUser or login).\n     *\n     * @returns An array of users active or loggedout users (current user being the first).\n     */\n\n  }, {\n    key: \"allUsers\",\n    get: function get() {\n      // Returning a freezed copy of the list of users to prevent outside changes\n      return Object.fromEntries(this.users.map(function (user) {\n        return [user.id, user];\n      }));\n    }\n    /**\n     * @returns A promise of the app URL, with the app location resolved.\n     */\n\n  }, {\n    key: \"locationUrl\",\n    get: function get() {\n      var _this6 = this;\n\n      if (!this._locationUrl) {\n        var path = routes.api().app(this.id).location().path;\n        this._locationUrl = this.fetcher.fetchJSON({\n          method: \"GET\",\n          url: this.baseUrl + path,\n          tokenType: \"none\"\n        }).then(function (_ref13) {\n          var hostname = _ref13.hostname;\n\n          if (typeof hostname !== \"string\") {\n            throw new Error(\"Expected response to contain a 'hostname'\");\n          } else {\n            return hostname;\n          }\n        }).catch(function (err) {\n          // Reset the location to allow another request to fetch again.\n          _this6._locationUrl = null;\n          throw err;\n        });\n      }\n\n      return this._locationUrl;\n    }\n    /**\n     * @returns Information about the current device, sent to the server when authenticating.\n     */\n\n  }, {\n    key: \"deviceInformation\",\n    get: function get() {\n      var deviceIdStr = this.storage.getDeviceId();\n      var deviceId = typeof deviceIdStr === \"string\" && deviceIdStr !== \"000000000000000000000000\" ? new ObjectId(deviceIdStr) : undefined;\n      return new DeviceInformation({\n        appId: this.localApp ? this.localApp.name : undefined,\n        appVersion: this.localApp ? this.localApp.version : undefined,\n        deviceId: deviceId\n      });\n    }\n    /**\n     * Create (and store) a new user or update an existing user's access and refresh tokens.\n     * This helps de-duplicating users in the list of users known to the app.\n     *\n     * @param response A response from the Authenticator.\n     * @param providerType The type of the authentication provider used.\n     * @returns A new or an existing user.\n     */\n\n  }, {\n    key: \"createOrUpdateUser\",\n    value: function createOrUpdateUser(response, providerType) {\n      var existingUser = this.users.find(function (u) {\n        return u.id === response.userId;\n      });\n\n      if (existingUser) {\n        // Update the users access and refresh tokens\n        existingUser.accessToken = response.accessToken;\n        existingUser.refreshToken = response.refreshToken;\n        return existingUser;\n      } else {\n        // Create and store a new user\n        if (!response.refreshToken) {\n          throw new Error(\"No refresh token in response from server\");\n        }\n\n        var user = new User({\n          app: this,\n          id: response.userId,\n          accessToken: response.accessToken,\n          refreshToken: response.refreshToken,\n          providerType: providerType\n        });\n        this.users.unshift(user);\n        return user;\n      }\n    }\n    /**\n     * Restores the state of the app (active and logged-out users) from the storage\n     */\n\n  }, {\n    key: \"hydrate\",\n    value: function hydrate() {\n      var _this7 = this;\n\n      var userIds = this.storage.getUserIds();\n      this.users = userIds.map(function (id) {\n        return new User({\n          app: _this7,\n          id: id\n        });\n      });\n    }\n  }], [{\n    key: \"getApp\",\n    value: function getApp(id) {\n      if (id in App.appCache) {\n        return App.appCache[id];\n      } else {\n        var instance = new App(id);\n        App.appCache[id] = instance;\n        return instance;\n      }\n    }\n  }]);\n\n  return App;\n}();\n/**\n * A map of app instances returned from calling getApp.\n */\n\n\nApp.appCache = {};\n/**\n * Instances of this class can be passed to the `app.logIn` method to authenticate an end-user.\n */\n\nApp.Credentials = Credentials; ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Get or create a singleton Realm App from an id.\n * Calling this function multiple times with the same id will return the same instance.\n *\n * @param id The Realm App id visible from the MongoDB Realm UI or a configuration.\n * @returns The Realm App instance.\n */\n\nfunction getApp(id) {\n  return App.getApp(id);\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * In-memory storage that will not be persisted.\n */\n\n\nvar LocalStorage = /*#__PURE__*/function () {\n  /**\n   * Constructs a LocalStorage using the global window.\n   */\n  function LocalStorage() {\n    _classCallCheck(this, LocalStorage);\n\n    if (typeof window === \"object\") {\n      this.window = window;\n    } else {\n      throw new Error(\"Cannot use LocalStorage without a global window object\");\n    }\n  }\n  /** @inheritdoc */\n\n\n  _createClass(LocalStorage, [{\n    key: \"get\",\n    value: function get(key) {\n      return this.window.localStorage.getItem(key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      return this.window.localStorage.setItem(key, value);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"remove\",\n    value: function remove(key) {\n      return this.window.localStorage.removeItem(key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"prefix\",\n    value: function prefix(keyPart) {\n      return new PrefixedStorage(this, keyPart);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"clear\",\n    value: function clear(prefix) {\n      var keys = []; // Iterate all keys to find the once have a matching prefix.\n\n      for (var i = 0; i < this.window.localStorage.length; i++) {\n        var key = this.window.localStorage.key(i);\n\n        if (key && (!prefix || key.startsWith(prefix))) {\n          keys.push(key);\n        }\n      } // Remove the items in a seperate loop to avoid updating while iterating.\n\n\n      for (var _i3 = 0, _keys = keys; _i3 < _keys.length; _i3++) {\n        var _key5 = _keys[_i3];\n        this.window.localStorage.removeItem(_key5);\n      }\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"addListener\",\n    value: function addListener(listener) {\n      return this.window.addEventListener(\"storage\", listener);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(listener) {\n      return this.window.removeEventListener(\"storage\", listener);\n    }\n  }]);\n\n  return LocalStorage;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar browser = detect();\nvar environment$1 = {\n  defaultStorage: new LocalStorage().prefix(\"realm-web\"),\n  openWindow: function openWindow(url) {\n    return window.open(url);\n  },\n  platform: (browser === null || browser === void 0 ? void 0 : browser.name) || \"web\",\n  platformVersion: (browser === null || browser === void 0 ? void 0 : browser.version) || \"0.0.0\",\n  TextDecoder: TextDecoder\n};\nsetEnvironment(environment$1);\n/**\n * Handle an OAuth 2.0 redirect.\n *\n * @param location An optional location to use (defaults to the windows current location).\n * @param storage Optional storage used to save any results from the location.\n */\n\nfunction handleAuthRedirect() {\n  var location = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : window.location;\n  var storage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : environment$1.defaultStorage;\n\n  try {\n    var queryString = location.hash.substr(1); // Strip the initial # from the hash\n\n    OAuth2Helper.handleRedirect(queryString, storage);\n  } catch (err) {\n    // Ensure calling this never throws: It should not interrupt a users flow.\n    console.warn(err);\n  }\n}\n\nexport { App, Credentials, DEFAULT_BASE_URL, LocalStorage, MongoDBRealmError, User, UserState, UserType$1 as UserType, getApp, getEnvironment, handleAuthRedirect, setEnvironment };","import * as Realm from \"realm-web\";\n\nconst REALM_APP_ID = \"jotter-bdqbf\";\nconst app = new Realm.App({ id: REALM_APP_ID });\n\n\n// Get the API key from the local environment\nconst apiKey = process.env.MDB_AUTH_USER;\nif (!apiKey) {\n  throw new Error(\"Could not find a Realm Server API Key.\");\n}\n// Create an api key credential\nconst credentials = Realm.Credentials.serverApiKey(apiKey);\n\nexport default async function Login() {\n  try {\n    const user = await app.logIn(credentials);\n    return user;    \n  } catch (err) {\n    console.error(\"Failed to log in\", err.message);\n  }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport JotterLogo from \"../assets/jotter-logo.svg\";\nimport LoadingIcon from \"../assets/loading.svg\";\nimport { useAuth0 } from \"../services/auth\";\nimport Login from \"../services/realm/userAuth\";\nimport { Router } from \"@reach/router\";\nimport { RedirectToLibrary } from \"../components/Routing\";\nimport Library from \"../pages/library\";\nimport { Wrapper, Loading } from \"../components/Loading\";\n\nconst Logo = styled.img`\n  width: 12rem;\n`;\n\nconst Greeting = styled.h1`\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n  max-width: 25rem;\n  font-size: 1.5rem;\n  font-weight: 500;\n  color: var(--gray);\n  text-align: center;\n`;\n\nconst LoginBtn = styled.button`\n  padding: 0.8rem 2rem;\n  border-radius: 2rem;\n  background-color: #1bd692;\n  color: white;\n  font-size: 1rem;\n  font-weight: 600;\n\n  &:hover {\n    background-color: #1acf8d;\n  }\n`;\n\nconst LoginButton = () => {\n  const { loginWithRedirect } = useAuth0();\n  const handleSignIn = () => {\n    loginWithRedirect({});\n    Login();\n  };\n\n  return <LoginBtn onClick={() => handleSignIn()}>Sign in</LoginBtn>;\n};\n\nconst Index = () => {\n  const { isAuthenticated, isLoading } = useAuth0();\n\n  if (!isAuthenticated && !isLoading) {\n    return (\n      <Wrapper minHeight=\"100vh\">\n        <Logo src={JotterLogo} alt=\"Jotter logo\" />\n        <Greeting>Write and keep notes on your favourite books. </Greeting>\n        <LoginButton />\n      </Wrapper>\n    );\n  } else if (isLoading) {\n    return (\n      <Wrapper>\n        <Loading\n          minHeight=\"60vh\"\n          src={LoadingIcon}\n          alt=\"Loading icon\"\n          className=\"rotating\"\n        />\n      </Wrapper>\n    );\n  } else {\n    return (\n      <Router>\n        <RedirectToLibrary path=\"/\" component={Library} />\n      </Router>\n    );\n  }\n};\n\nexport default Index;\n","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCA2NCAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYuMDc1IDE1LjI1QzQuODI1IDE1LjI1IDMuODE2NjcgMTUuMDMzMyAzLjA1IDE0LjZDMi4yODMzMyAxNC4xNSAxLjcyNSAxMy41NDE3IDEuMzc1IDEyLjc3NUMxLjA0MTY3IDEyLjAwODMgMC44NzUgMTEuMTI1IDAuODc1IDEwLjEyNUg0LjE3NUM0LjE3NSAxMC42OTE3IDQuMjkxNjcgMTEuMTkxNyA0LjUyNSAxMS42MjVDNC43NzUgMTIuMDQxNyA1LjI1IDEyLjI1IDUuOTUgMTIuMjVDNi41NSAxMi4yNSA2Ljk5MTY3IDEyLjA2NjcgNy4yNzUgMTEuN0M3LjU1ODMzIDExLjMxNjcgNy43IDEwLjU2NjcgNy43IDkuNDVWMy41NzVINC43NVYwLjkyNDk5OUgxMS4yVjguODVDMTEuMiA5LjgxNjY3IDExLjEzMzMgMTAuNyAxMSAxMS41QzEwLjg4MzMgMTIuMjgzMyAxMC42NSAxMi45NTgzIDEwLjMgMTMuNTI1QzkuOTUgMTQuMDc1IDkuNDMzMzMgMTQuNSA4Ljc1IDE0LjhDOC4wODMzMyAxNS4xIDcuMTkxNjcgMTUuMjUgNi4wNzUgMTUuMjVaTTE4LjY3MDMgMTUuMjVDMTcuNDUzNiAxNS4yNSAxNi40MzcgMTUuMDI1IDE1LjYyMDMgMTQuNTc1QzE0LjgwMzYgMTQuMTA4MyAxNC4xOTUzIDEzLjQ3NSAxMy43OTUzIDEyLjY3NUMxMy4zOTUzIDExLjg3NSAxMy4xOTUzIDEwLjk2NjcgMTMuMTk1MyA5Ljk1QzEzLjE3ODYgOC45MTY2NyAxMy4zNzAzIDguMDA4MzMgMTMuNzcwMyA3LjIyNUMxNC4xNzAzIDYuNDI1IDE0Ljc3ODYgNS43OTE2NyAxNS41OTUzIDUuMzI1QzE2LjQyODYgNC44NTgzMyAxNy40NTM2IDQuNjI1IDE4LjY3MDMgNC42MjVDMjAuNDUzNiA0LjYyNSAyMS44MDM2IDUuMTE2NjcgMjIuNzIwMyA2LjFDMjMuNjUzNiA3LjA2NjY3IDI0LjEyMDMgOC4zNSAyNC4xMjAzIDkuOTVDMjQuMTIwMyAxMC45NSAyMy45MjAzIDExLjg1IDIzLjUyMDMgMTIuNjVDMjMuMTM3IDEzLjQ1IDIyLjU0NTMgMTQuMDgzMyAyMS43NDUzIDE0LjU1QzIwLjk0NTMgMTUuMDE2NyAxOS45MjAzIDE1LjI1IDE4LjY3MDMgMTUuMjVaTTE4LjY3MDMgMTIuMzVDMTkuMjg3IDEyLjM1IDE5Ljc0NTMgMTIuMjI1IDIwLjA0NTMgMTEuOTc1QzIwLjM0NTMgMTEuNzI1IDIwLjUzNyAxMS40MDgzIDIwLjYyMDMgMTEuMDI1QzIwLjcyMDMgMTAuNjI1IDIwLjc3MDMgMTAuMjI1IDIwLjc3MDMgOS44MjVDMjAuNzcwMyA5LjQwODMzIDIwLjcyMDMgOS4wMDgzMyAyMC42MjAzIDguNjI1QzIwLjUzNyA4LjI0MTY3IDIwLjM0NTMgNy45MjUgMjAuMDQ1MyA3LjY3NUMxOS43NDUzIDcuNDA4MzMgMTkuMjg3IDcuMjc1IDE4LjY3MDMgNy4yNzVDMTguMDUzNiA3LjI3NSAxNy41ODcgNy40MDgzMyAxNy4yNzAzIDcuNjc1QzE2Ljk3MDMgNy45MjUgMTYuNzcwMyA4LjI0MTY3IDE2LjY3MDMgOC42MjVDMTYuNTg3IDkuMDA4MzMgMTYuNTQ1MyA5LjQwODMzIDE2LjU0NTMgOS44MjVDMTYuNTQ1MyAxMC4yMjUgMTYuNTg3IDEwLjYyNSAxNi42NzAzIDExLjAyNUMxNi43NzAzIDExLjQwODMgMTYuOTcwMyAxMS43MjUgMTcuMjcwMyAxMS45NzVDMTcuNTg3IDEyLjIyNSAxOC4wNTM2IDEyLjM1IDE4LjY3MDMgMTIuMzVaTTI5Ljk1MjkgMTVDMjguOTUyOSAxNSAyOC4xNjEzIDE0Ljc2NjcgMjcuNTc3OSAxNC4zQzI2Ljk5NDYgMTMuODMzMyAyNi43MDI5IDEyLjk4MzMgMjYuNzAyOSAxMS43NVY3LjAyNUgyNS4yNTI5VjQuNjVDMjUuNjUyOSA0LjY1IDI1Ljk5NDYgNC41OTE2NyAyNi4yNzc5IDQuNDc1QzI2LjU3NzkgNC4zNTgzMyAyNi44MDI5IDQuMTE2NjcgMjYuOTUyOSAzLjc1QzI3LjExOTYgMy4zNjY2NyAyNy4yMDI5IDIuNzkxNjcgMjcuMjAyOSAyLjAyNUgyOS45NTI5VjQuNjVIMzIuMjc3OVY3LjAyNUgyOS45NTI5VjEyLjMyNUgzMi4zNTI5VjE1SDI5Ljk1MjlaTTM4LjMwMjUgMTVDMzcuMzAyNSAxNSAzNi41MTA5IDE0Ljc2NjcgMzUuOTI3NSAxNC4zQzM1LjM0NDIgMTMuODMzMyAzNS4wNTI1IDEyLjk4MzMgMzUuMDUyNSAxMS43NVY3LjAyNUgzMy42MDI1VjQuNjVDMzQuMDAyNSA0LjY1IDM0LjM0NDIgNC41OTE2NyAzNC42Mjc1IDQuNDc1QzM0LjkyNzUgNC4zNTgzMyAzNS4xNTI1IDQuMTE2NjcgMzUuMzAyNSAzLjc1QzM1LjQ2OTIgMy4zNjY2NyAzNS41NTI1IDIuNzkxNjcgMzUuNTUyNSAyLjAyNUgzOC4zMDI1VjQuNjVINDAuNjI3NVY3LjAyNUgzOC4zMDI1VjEyLjMyNUg0MC43MDI1VjE1SDM4LjMwMjVaTTQ3LjQ1MjEgMTUuMjVDNDYuMjAyMSAxNS4yNSA0NS4xOTM4IDE1IDQ0LjQyNzEgMTQuNUM0My42NjA1IDE0IDQzLjA5MzggMTMuMzU4MyA0Mi43MjcxIDEyLjU3NUM0Mi4zNzcxIDExLjc3NSA0Mi4xODU1IDEwLjk0MTcgNDIuMTUyMSAxMC4wNzVDNDIuMTE4OCA4Ljk0MTY3IDQyLjMxODggNy45NjY2NyA0Mi43NTIxIDcuMTVDNDMuMTg1NSA2LjMxNjY3IDQzLjc5MzggNS42ODMzMyA0NC41NzcxIDUuMjVDNDUuMzc3MSA0LjggNDYuMjkzOCA0LjU3NSA0Ny4zMjcxIDQuNTc1QzQ4LjMxMDUgNC41NzUgNDkuMTg1NSA0Ljc4MzMzIDQ5Ljk1MjEgNS4yQzUwLjczNTUgNS42IDUxLjM0MzggNi4xNzUgNTEuNzc3MSA2LjkyNUM1Mi4yMjcxIDcuNjc1IDUyLjQ1MjEgOC41NzUgNTIuNDUyMSA5LjYyNVYxMC4yNzVINDUuNDUyMUM0NS40NTIxIDExLjAwODMgNDUuNjI3MSAxMS41NDE3IDQ1Ljk3NzEgMTEuODc1QzQ2LjM0MzggMTIuMjA4MyA0Ni44MTA1IDEyLjM3NSA0Ny4zNzcxIDEyLjM3NUM0Ny44NjA1IDEyLjM3NSA0OC4yNDM4IDEyLjI2NjcgNDguNTI3MSAxMi4wNUM0OC44MjcxIDExLjgxNjcgNDkuMDAyMSAxMS41MjUgNDkuMDUyMSAxMS4xNzVINTIuNDI3MUM1Mi4zNzcxIDExLjkwODMgNTIuMTYwNSAxMi41OTE3IDUxLjc3NzEgMTMuMjI1QzUxLjM5MzggMTMuODQxNyA1MC44NDM4IDE0LjMzMzMgNTAuMTI3MSAxNC43QzQ5LjQxMDUgMTUuMDY2NyA0OC41MTg4IDE1LjI1IDQ3LjQ1MjEgMTUuMjVaTTQ1LjUwMjEgOC44NzVINDguOTUyMUM0OC45NTIxIDguODc1IDQ4Ljk0MzggOC44IDQ4LjkyNzEgOC42NUM0OC45MjcxIDguNSA0OC44NzcxIDguMzI1IDQ4Ljc3NzEgOC4xMjVDNDguNjc3MSA3LjkyNSA0OC41MTA1IDcuNzUgNDguMjc3MSA3LjZDNDguMDQzOCA3LjQ1IDQ3LjcwMjEgNy4zNzUgNDcuMjUyMSA3LjM3NUM0Ni44MDIxIDcuMzc1IDQ2LjQ1MjEgNy40NSA0Ni4yMDIxIDcuNkM0NS45NTIxIDcuNzUgNDUuNzc3MSA3LjkyNSA0NS42NzcxIDguMTI1QzQ1LjU5MzggOC4zMjUgNDUuNTQzOCA4LjUgNDUuNTI3MSA4LjY1QzQ1LjUxMDUgOC44IDQ1LjUwMjEgOC44NzUgNDUuNTAyMSA4Ljg3NVpNNTQuMjkzIDE1VjQuNjVINTcuNTkzTDU3LjgxOCA3LjZDNTcuOTE4IDcuMTY2NjcgNTguMTA5NiA2LjcyNSA1OC4zOTMgNi4yNzVDNTguNjc2MyA1LjgwODMzIDU5LjA4NDYgNS40MjUgNTkuNjE4IDUuMTI1QzYwLjE1MTMgNC44MDgzMyA2MC44NTEzIDQuNjUgNjEuNzE4IDQuNjVINjEuOTQzVjguNTI1SDYxLjY5M0M2MC44NTk2IDguNTI1IDYwLjE1MTMgOC41NzUgNTkuNTY4IDguNjc1QzU4Ljk4NDYgOC43NzUgNTguNTQzIDguOTkxNjcgNTguMjQzIDkuMzI1QzU3Ljk0MyA5LjY0MTY3IDU3Ljc5MyAxMC4xNTgzIDU3Ljc5MyAxMC44NzVWMTVINTQuMjkzWiIgZmlsbD0iIzIxMjEzOCIvPgo8cGF0aCBkPSJNMS41IDE5LjVMNTggMTdWMTguNUwxLjUgMjFWMTkuNVoiIGZpbGw9IiMyMTIxMzgiIHN0cm9rZT0iIzIxMjEzOCIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KPC9zdmc+Cg==\"","import React, { useEffect, useState } from \"react\";\nimport Layout from \"../components/Layout\";\nimport LoadingIcon from \"../assets/loading.svg\";\nimport { useAuth0 } from \"../services/auth\";\nimport BookItem, { BookList } from \"../components/Book/LibraryBook\";\nimport { getLibrary } from \"../services/realm/API\";\nimport { Router } from \"@reach/router\";\nimport { RedirectToLibrary } from \"../components/Routing\";\nimport { Wrapper, Loading } from \"../components/Loading\";\n\nconst Library = () => {\n  const { user, isAuthenticated, isLoading } = useAuth0();\n  const [libraryBooks, setLibraryBooks] = useState([]);\n  const [isFetching, setIsFetching] = useState(false);\n\n  useEffect(() => {\n    if (user) {\n      setIsFetching(true);\n      getLibrary(user.nickname)\n        .then((response) => {\n          setLibraryBooks(response);\n          setIsFetching(false);\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    }\n  }, [user]);\n\n  if (isAuthenticated && !isLoading) {\n    return (\n      <Layout heading=\"Library\" subheading=\"All your books in one place\">\n        {isFetching ? (\n          <Wrapper minHeight=\"60vh\">\n            <Loading\n              minHeight=\"50vh\"\n              src={LoadingIcon}\n              alt=\"Loading icon\"\n              className=\"rotating\"\n            />\n          </Wrapper>\n        ) : (\n          <BookList>\n            {libraryBooks.map((book) => {\n              return (\n                <BookItem\n                  key={book.bookTitle + book.cover}\n                  isLink={true}\n                  to=\"/book/\"\n                  isbn={book.isbn}\n                  shouldHover={true}\n                  cover={book.cover}\n                  title={book.bookTitle}\n                  author={book.author.join(\", \")}\n                  date={book.year}\n                  percentageRead={book.percentageRead}\n                />\n              );\n            })}\n          </BookList>\n        )}\n      </Layout>\n    );\n  } else {\n    return (\n      <Router>\n        <RedirectToLibrary path=\"/\" component={Library} />\n      </Router>\n    );\n  }\n};\n\nexport default Library;\n","import axios from \"axios\";\nimport { baseurl } from \"../../../gatsby-browser\";\n\nexport const getLibrary = async (username) => {\n  try {\n    const books = await axios.get(`${baseurl}library?user=${username}`);\n    return books.data[0].library;\n  } catch (error) {\n    console.error(\"getLibrary error:\", error);\n  }\n};\n\nexport const addBookToLibrary = async (\n  username,\n  bookTitle,\n  author,\n  year,\n  cover,\n  addDate,\n  isbn\n) => {\n  try {\n    axios\n      .post(`${baseurl}add-book-library`, null, {\n        params: {\n          user: username,\n          title: bookTitle,\n          bookAuthor: author,\n          bookYear: year,\n          bookCover: cover,\n          bookAddedDate: addDate,\n          bookIsbn: isbn,\n        },\n      })\n      .then(console.log(\"added book to library\"));\n  } catch (error) {\n    console.error(\"error (couldn't add book to library):\", error.response);\n  }\n};\n\nexport const getToRead = async (username) => {\n  try {\n    const books = await axios.get(`${baseurl}to-read?user=${username}`);\n    return books.data[0].toRead;\n  } catch (error) {\n    console.error(\"getToRead error:\", error);\n  }\n};\n\nexport const addBookToToRead = async (\n  username,\n  bookTitle,\n  author,\n  year,\n  cover,\n  addDate,\n  isbn\n) => {\n  try {\n    axios\n      .post(`${baseurl}add-book-to-read`, null, {\n        params: {\n          user: username,\n          title: bookTitle,\n          bookAuthor: author,\n          bookYear: year,\n          bookCover: cover,\n          bookAddedDate: addDate,\n          bookIsbn: isbn,\n        },\n      })\n      .then(console.log(\"added book to to-read\"));\n  } catch (error) {\n    console.error(\"error (couldn't add book to to-read):\", error.response);\n  }\n};\n\n\nexport const updatePercentageRead = async (\n  username,\n  isbn,\n  readPercentage\n) => {\n  try {\n    axios\n      .post(`${baseurl}update-reading`, null, {\n        params: {\n          user: username,\n          bookID: isbn,\n          percentageRead: readPercentage,\n        },\n      })\n      .then(console.log(\"Updated percentage read with the value: \", readPercentage));\n  } catch (error) {\n    console.error(\"error (Couldn't update percentage read):\", error.response);\n  }\n};\n\n\nexport const getPercentageRead = async (username, isbn) => {\n  try {\n    const percentageRead = await axios.get(`${baseurl}percentageRead?user=${username}&bookID=${isbn}`);\n    return percentageRead.data;\n  } catch (error) {\n    console.error(\"getToRead error:\", error);\n  }\n};","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjQzVDNUM1Ij48cGF0aCBkPSJNMTIsMjJjNS40MjEsMCwxMC00LjU3OSwxMC0xMGgtMmMwLDQuMzM3LTMuNjYzLDgtOCw4cy04LTMuNjYzLTgtOGMwLTQuMzM2LDMuNjYzLTgsOC04VjJDNi41NzksMiwyLDYuNTgsMiwxMiBDMiwxNy40MjEsNi41NzksMjIsMTIsMjJ6Ii8+PC9zdmc+\""],"sourceRoot":""}