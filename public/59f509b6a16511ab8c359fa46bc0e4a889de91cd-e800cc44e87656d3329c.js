(self.webpackChunkjotter=self.webpackChunkjotter||[]).push([[865,255],{8:function(e){function t(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},648:function(e,t,r){var n=r(1694),o=r(4326),i=r(5112)("toStringTag"),a="Arguments"==o(function(){return arguments}());e.exports=n?o:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Object(e),i))?r:a?o(t):"Object"==(n=o(t))&&"function"==typeof t.callee?"Arguments":n}},6135:function(e,t,r){"use strict";var n=r(7593),o=r(3070),i=r(9114);e.exports=function(e,t,r){var a=n(t);a in e?o.f(e,a,i(0,r)):e[a]=r}},9974:function(e,t,r){var n=r(3099);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},1246:function(e,t,r){var n=r(648),o=r(7497),i=r(5112)("iterator");e.exports=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},7659:function(e,t,r){var n=r(5112),o=r(7497),i=n("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},408:function(e,t,r){var n=r(9670),o=r(7659),i=r(7466),a=r(9974),s=r(1246),u=r(9212),c=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,r){var f,h,l,p,d,y,v,g=r&&r.that,M=!(!r||!r.AS_ENTRIES),N=!(!r||!r.IS_ITERATOR),m=!(!r||!r.INTERRUPTED),w=a(t,g,1+M+m),k=function(e){return f&&u(f),new c(!0,e)},b=function(e){return M?(n(e),m?w(e[0],e[1],k):w(e[0],e[1])):m?w(e,k):w(e)};if(N)f=e;else{if("function"!=typeof(h=s(e)))throw TypeError("Target is not iterable");if(o(h)){for(l=0,p=i(e.length);p>l;l++)if((d=b(e[l]))&&d instanceof c)return d;return new c(!1)}f=h.call(e)}for(y=f.next;!(v=y.call(f)).done;){try{d=b(v.value)}catch(T){throw u(f),T}if("object"==typeof d&&d&&d instanceof c)return d}return new c(!1)}},9212:function(e,t,r){var n=r(9670);e.exports=function(e){var t=e.return;if(void 0!==t)return n(t.call(e)).value}},7497:function(e){e.exports={}},1694:function(e,t,r){var n={};n[r(5112)("toStringTag")]="z",e.exports="[object z]"===String(n)},8559:function(e,t,r){var n=r(2109),o=r(408),i=r(6135);n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return o(e,(function(e,r){i(t,e,r)}),{AS_ENTRIES:!0}),t}})},3372:function(e,t,r){"use strict";r.d(t,{Z:function(){return d},F:function(){return y}});var n,o,i,a,s=r(5761),u=r(7294),c=r(9925),f=r(5444),h=c.ZP.div(n||(n=(0,s.Z)(["\n  transition: 0.2s;\n  flex: 0 0 17rem;\n\n  .cover {\n    box-shadow: var(--book-shadow);\n    border: var(--book-border);\n    border-radius: var(--book-round);\n    max-height: 200px;\n  }\n\n  h3 {\n    font-weight: 600;\n    color: var(--book-title);\n    line-height: 1.5rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.3rem;\n  }\n\n  h4 {\n    font-size: 0.8rem;\n    font-weight: 600;\n    color: var(--book-author);\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n  }\n\n  h5 {\n    font-weight: 500;\n    color: var(--book-date);\n    margin-top: 0;\n  }\n"]))),l=c.ZP.div(o||(o=(0,s.Z)(["\n  max-width: 14rem;\n  word-wrap: break-word;\n"]))),p=(0,c.ZP)(f.Link)(i||(i=(0,s.Z)(["\n  transition: 0.2s;\n  flex: 0 1 17rem;\n  margin-bottom: 10rem;\n\n  &:hover {\n    transform: translateY(-0.5rem);\n    transition: 0.2s;\n  }\n"])));function d(e){var t=e.isbn,r=e.cover,n=e.title,o=e.author,i=e.date,a=e.isLink,s=e.percentageRead,c=e.children,f=e.to,d=function(e){var r=e.children,n=e.to;return e.isLink?u.createElement(p,{to:n,state:{isbn:t,percentageRead:s}},r):u.createElement(u.Fragment,null,r)};return u.createElement(d,{isLink:a,to:f},u.createElement(h,null,u.createElement("img",{src:r,alt:"Book cover",className:"cover"}),u.createElement(l,null,u.createElement("h3",null,n),u.createElement("h4",null,o),u.createElement("h5",null,i)),c))}var y=c.ZP.div(a||(a=(0,s.Z)(["\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  margin-top: 5rem;\n"])))},2441:function(e,t,r){"use strict";r.d(t,{i:function(){return s},g:function(){return u}});var n,o,i=r(5761),a=r(9925),s=a.ZP.div(n||(n=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: ",";\n"])),(function(e){return e.minHeight||"50rem"})),u=a.ZP.img(o||(o=(0,i.Z)(["\n  width: 8rem;\n  margin: 1rem auto 1rem auto;\n  -webkit-animation: spin 4s linear infinite;\n  -moz-animation: spin 4s linear infinite;\n  animation: spin 4s linear infinite;\n  min-height: ",";\n"])),(function(e){return e.minHeight||"50rem"}))},4816:function(e,t,r){"use strict";r.d(t,{Cq:function(){return u},rC:function(){return c}});var n=r(9756),o=r(7294),i=r(4558),a=r(5444),s=r(7721),u=function(e){e.component,(0,n.Z)(e,["component"]);return(0,a.navigate)("/"),o.createElement(s.default,null)},c=function(e){var t=e.component,r=e.path,s=(0,n.Z)(e,["component","path"]),u=(0,i.D3)(),c=u.loading,f=u.isAuthenticated,h=u.loginWithRedirect;return(0,o.useEffect)((function(){f&&(0,a.navigate)("/library")}),[c,f,h,r]),!0===f?o.createElement(t,s):null};t.ZP=function(e){var t=e.component,r=e.path,s=(0,n.Z)(e,["component","path"]),u=(0,i.D3)(),c=u.loading,f=u.isAuthenticated,h=u.loginWithRedirect;return(0,o.useEffect)((function(){c||f||(0,a.navigate)("/")}),[c,f,h,r]),!0===f?o.createElement(t,s):null}},6168:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return pt}});var n=r(5761),o=r(7294),i=r(9925),a=r(2352),s=r(4558),u=r(2137),c=r(7757),f=r.n(c);function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r(4665);function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,r){return(d=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&(0,l.Z)(o,r.prototype),o}).apply(null,arguments)}function y(e){var t="function"==typeof Map?new Map:void 0;return(y=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,l.Z)(n,e)})(e)}var v=r(7329);function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,l.Z)(e,t)}var M=r(8);function N(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var m=r(2961);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(u){s=!0,o=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}(e,t)||(0,m.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=r(6156),b=r(9756);function T(e,t){if(null==e)return{};var r,n,o=(0,b.Z)(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t,r){return t&&A(e.prototype,t),r&&A(e,r),e}function I(e){this.wrapped=e}function D(e){return new I(e)}function E(e){var t,r;function n(t,r){try{var i=e[t](r),a=i.value,s=a instanceof I;Promise.resolve(s?a.wrapped:a).then((function(e){s?n("return"===t?"return":"next",e):o(i.done?"return":"normal",e)}),(function(e){n("throw",e)}))}catch(u){o("throw",u)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,o){return new Promise((function(i,a){var s={key:e,arg:o,resolve:i,reject:a,next:null};r?r=r.next=s:(t=r=s,n(e,o))}))},"function"!=typeof e.return&&(this.return=void 0)}function S(e){return function(){return new E(e.apply(this,arguments))}}function O(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}E.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},E.prototype.next=function(e){return this._invoke("next",e)},E.prototype.throw=function(e){return this._invoke("throw",e)},E.prototype.return=function(e){return this._invoke("return",e)};r(8559);var z,L=r(5900);function U(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return N(this,r)}}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,k.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},Z=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},V=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},B=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},Y=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},W=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},F=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,J=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],H=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function G(e){var t=function(e){return""!==e&&J.reduce((function(t,r){var n=r[0],o=r[1];if(t)return t;var i=o.exec(e);return!!i&&[n,i]}),!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new Y;var o=n[1]&&n[1].split(/[._]/).slice(0,3);o?o.length<3&&(o=Q(o,function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-o.length))):o=[];var i=o.join("."),a=function(e){for(var t=0,r=H.length;t<r;t++){var n=H[t],o=n[0];if(n[1].exec(e))return o}return null}(e),s=F.exec(e);return s&&s[1]?new B(r,i,a,s[1]):new Z(r,i,a)}var K=function(){function e(){if(j(this,e),!e.fetch)throw new Error("DefaultNetworkTransport.fetch must be set before it's used");if(!e.AbortController)throw new Error("DefaultNetworkTransport.AbortController must be set before it's used")}var t;return x(e,[{key:"fetchWithCallbacks",value:function(e,t){this.fetch(e).then(function(){var e=(0,u.Z)(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:return r=e.sent,n={},t.headers.forEach((function(e,t){n[t]=e})),e.abrupt("return",{statusCode:t.status,headers:n,body:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return t.onSuccess(e)})).catch((function(e){return t.onError(e)}))}},{key:"fetch",value:(t=(0,u.Z)(f().mark((function t(r){var n,o,i,a,s,u;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.timeoutMs,o=r.url,i=T(r,["timeoutMs","url"]),a=this.createTimeoutSignal(n),s=a.signal,u=a.cancelTimeout,t.prev=2,t.next=5,e.fetch(o,P({signal:s},i));case 5:return t.abrupt("return",t.sent);case 6:return t.prev=6,u(),t.finish(6);case 9:case"end":return t.stop()}}),t,this,[[2,,6,9]])}))),function(e){return t.apply(this,arguments)})},{key:"createTimeoutSignal",value:function(t){if("number"==typeof t){var r=new e.AbortController,n=setTimeout((function(){r.abort()}),t);return{signal:r.signal,cancelTimeout:function(){clearTimeout(n)}}}return{signal:void 0,cancelTimeout:function(){}}}}]),e}();K.DEFAULT_HEADERS={"Content-Type":"application/json"},K.fetch=window.fetch.bind(window),K.AbortController=window.AbortController;var q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{};var $,X,ee,te,re=(function(e,t){var r;r="undefined"!=typeof self?self:"undefined"!=typeof window?window:q,e.exports=function(t){var r,n=(t=t||{}).Base64,o="2.6.4",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(i),s=String.fromCharCode,u=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?s(192|t>>>6)+s(128|63&t):s(224|t>>>12&15)+s(128|t>>>6&63)+s(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return s(240|t>>>18&7)+s(128|t>>>12&63)+s(128|t>>>6&63)+s(128|63&t)},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,f=function(e){return e.replace(c,u)},h=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[i.charAt(r>>>18),i.charAt(r>>>12&63),t>=2?"=":i.charAt(r>>>6&63),t>=1?"=":i.charAt(63&r)].join("")},l=t.btoa&&"function"==typeof t.btoa?function(e){return t.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,h)},p=function(e){return l(f(String(e)))},d=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},y=function(e,t){return t?d(p(e)):p(e)},v=function(e){return y(e,!0)};t.Uint8Array&&(r=function(e,t){for(var r="",n=0,o=e.length;n<o;n+=3){var a=e[n],s=e[n+1],u=e[n+2],c=a<<16|s<<8|u;r+=i.charAt(c>>>18)+i.charAt(c>>>12&63)+(void 0!==s?i.charAt(c>>>6&63):"=")+(void 0!==u?i.charAt(63&c):"=")}return t?d(r):r});var g,M=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,N=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return s(55296+(t>>>10))+s(56320+(1023&t));case 3:return s((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return s((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(M,N)},w=function(e){var t=e.length,r=t%4,n=(t>0?a[e.charAt(0)]<<18:0)|(t>1?a[e.charAt(1)]<<12:0)|(t>2?a[e.charAt(2)]<<6:0)|(t>3?a[e.charAt(3)]:0),o=[s(n>>>16),s(n>>>8&255),s(255&n)];return o.length-=[0,0,2,1][r],o.join("")},k=t.atob&&"function"==typeof t.atob?function(e){return t.atob(e)}:function(e){return e.replace(/\S{1,4}/g,w)},b=function(e){return k(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},T=function(e){return m(k(e))},j=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},A=function(e){return T(j(e))};t.Uint8Array&&(g=function(e){return Uint8Array.from(b(j(e)),(function(e){return e.charCodeAt(0)}))});var x=function(){var e=t.Base64;return t.Base64=n,e};if(t.Base64={VERSION:o,atob:b,btoa:l,fromBase64:A,toBase64:y,utob:f,encode:y,encodeURI:v,btou:m,decode:A,noConflict:x,fromUint8Array:r,toUint8Array:g},"function"==typeof Object.defineProperty){var I=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",I((function(){return A(this)}))),Object.defineProperty(String.prototype,"toBase64",I((function(e){return y(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",I((function(){return y(this,!0)})))}}return t.Meteor&&(Base64=t.Base64),e.exports&&(e.exports.Base64=t.Base64),{Base64:t.Base64}}(r)}(X={path:$,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&X.path)}},X.exports),X.exports),ne={relaxed:!1};function oe(e){return L.dF.serialize(e,ne)}function ie(e){return Array.isArray(e)?e.map((function(e){return L.dF.deserialize(e)})):L.dF.deserialize(e)}!function(e){e.Normal="normal",e.Server="server"}(ee||(ee={})),function(e){e.NAME="name",e.EMAIL="email",e.PICTURE="picture",e.FIRST_NAME="first_name",e.LAST_NAME="last_name",e.GENDER="gender",e.BIRTHDAY="birthday",e.MIN_AGE="min_age",e.MAX_AGE="max_age"}(te||(te={}));var ae=(z={},(0,k.Z)(z,te.NAME,"name"),(0,k.Z)(z,te.EMAIL,"email"),(0,k.Z)(z,te.PICTURE,"pictureUrl"),(0,k.Z)(z,te.FIRST_NAME,"firstName"),(0,k.Z)(z,te.LAST_NAME,"lastName"),(0,k.Z)(z,te.GENDER,"gender"),(0,k.Z)(z,te.BIRTHDAY,"birthday"),(0,k.Z)(z,te.MIN_AGE,"minAge"),(0,k.Z)(z,te.MAX_AGE,"maxAge"),z),se=function e(t){if(j(this,e),this.type=ee.Normal,this.identities=[],"object"==typeof t&&null!==t){var r=t.type,n=t.identities,o=t.data;if("string"!=typeof r)throw new Error("Expected 'type' in the response body");if(this.type=r,!Array.isArray(n))throw new Error("Expected 'identities' in the response body");if(this.identities=n.map((function(e){return{id:e.id,providerType:e.provider_type}})),"object"!=typeof o||null===o)throw new Error("Expected 'data' in the response body");var i=Object.fromEntries(Object.entries(o).map((function(e){var t=w(e,2),r=t[0],n=t[1];return r in ae?[ae[r],n]:[r,n]})));this.data=ie(i)}else this.data={}},ue=function(){function e(t,r){j(this,e),this.storage=t,this.keyPart=r}return x(e,[{key:"get",value:function(t){return this.storage.get(this.keyPart+e.PART_SEPARATOR+t)}},{key:"set",value:function(t,r){return this.storage.set(this.keyPart+e.PART_SEPARATOR+t,r)}},{key:"remove",value:function(t){return this.storage.remove(this.keyPart+e.PART_SEPARATOR+t)}},{key:"prefix",value:function(t){return new e(this,t)}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.storage.clear(this.keyPart+e.PART_SEPARATOR+t)}},{key:"addListener",value:function(e){return this.storage.addListener(e)}},{key:"removeListener",value:function(e){return this.storage.addListener(e)}}]),e}();ue.PART_SEPARATOR=":";var ce="accessToken",fe="refreshToken",he="profile",le="providerType",pe=function(e){g(r,e);var t=C(r);function r(e,n){return j(this,r),t.call(this,e,"user(".concat(n,")"))}return x(r,[{key:"accessToken",get:function(){return this.get(ce)},set:function(e){null===e?this.remove(ce):this.set(ce,e)}},{key:"refreshToken",get:function(){return this.get(fe)},set:function(e){null===e?this.remove(fe):this.set(fe,e)}},{key:"profile",get:function(){var e=this.get(he);if(e){var t=new se;return Object.assign(t,JSON.parse(e)),t}},set:function(e){e?this.set(he,JSON.stringify(e)):this.remove(he)}},{key:"providerType",get:function(){var e=this.get(le);if(e)return e},set:function(e){e?this.set(le,e):this.remove(le)}}]),r}(ue);function de(e){return Object.fromEntries(Object.entries(e).filter((function(e){return void 0!==e[1]})))}function ye(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=de(e),n=t&&Object.keys(r).length>0?"?":"";return n+Object.entries(r).map((function(e){var t=w(e,2),r=t[0],n=t[1];return"".concat(r,"=").concat(encodeURIComponent(n))})).join("&")}var ve=["inspect","callFunction","callFunctionStreaming"].concat((0,v.Z)(Object.getOwnPropertyNames(Object.prototype)));function ge(e){return function(e){var t,r=U(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("object"==typeof n)for(var o=0,i=Object.entries(n);o<i.length;o++){var a=w(i[o],2),s=a[0];void 0===a[1]&&delete n[s]}}}catch(u){r.e(u)}finally{r.f()}return e}(e).map((function(e){return"object"==typeof e?oe(e):e}))}var Me=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};j(this,e),this.fetcher=t,this.serviceName=r.serviceName,this.argsTransformation=r.argsTransformation||ge}var t;return x(e,[{key:"callFunction",value:(t=(0,u.Z)(f().mark((function e(t){var r,n,o,i,a,s=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=s.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=s[o];return i={name:t,arguments:this.argsTransformation?this.argsTransformation(n):n},this.serviceName&&(i.service=this.serviceName),a=this.fetcher.appRoute,e.abrupt("return",this.fetcher.fetchJSON({method:"POST",path:a.functionsCall().path,body:i}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"callFunctionStreaming",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o={name:e,arguments:this.argsTransformation?this.argsTransformation(r):r};this.serviceName&&(o.service=this.serviceName);var i=this.fetcher.appRoute,a=ye((0,k.Z)({},"baas_request",Base64.encode(JSON.stringify(o))));return this.fetcher.fetchStream({method:"GET",path:i.functionsCall().path+a})}}],[{key:"create",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new e(t,r);return new Proxy(n,{get:function(e,t,r){if("string"==typeof t&&-1===ve.indexOf(t))return e.callFunction.bind(e,t);var n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}})}}]),e}(),Ne=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local-userpass";j(this,e),this.fetcher=t,this.providerName=r}var t,r,n,o,i,a;return x(e,[{key:"registerUser",value:(a=(0,u.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.fetcher.appRoute,e.next=3,this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).register().path,body:{email:t,password:r}});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"confirmUser",value:(i=(0,u.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.fetcher.appRoute,e.next=3,this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).confirm().path,body:{token:t,tokenId:r}});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"resendConfirmationEmail",value:(o=(0,u.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.fetcher.appRoute,e.next=3,this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirmSend().path,body:{email:t}});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"resetPassword",value:(n=(0,u.Z)(f().mark((function e(t,r,n){var o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.fetcher.appRoute,e.next=3,this.fetcher.fetchJSON({method:"POST",path:o.emailPasswordAuth(this.providerName).reset().path,body:{token:t,tokenId:r,password:n}});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"sendResetPasswordEmail",value:(r=(0,u.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.fetcher.appRoute,e.next=3,this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).resetSend().path,body:{email:t}});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"callResetPasswordFunction",value:(t=(0,u.Z)(f().mark((function e(t,r){var n,o,i,a,s=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.fetcher.appRoute,o=s.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=s[a];return e.next=4,this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).resetCall().path,body:{email:t,password:r,arguments:i}});case 4:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}();var me={api:function(){return{path:"/api/client/v2.0",app:function(e){return{path:this.path+"/app/".concat(e),location:function(){return{path:this.path+"/location"}},authProvider:function(e){return{path:this.path+"/auth/providers/".concat(e),login:function(){return{path:this.path+"/login"}}}},emailPasswordAuth:function(e){return P(P({},this.authProvider(e)),{},{register:function(){return{path:this.path+"/register"}},confirm:function(){return{path:this.path+"/confirm"}},confirmSend:function(){return{path:this.path+"/confirm/send"}},reset:function(){return{path:this.path+"/reset"}},resetSend:function(){return{path:this.path+"/reset/send"}},resetCall:function(){return{path:this.path+"/reset/call"}}})},functionsCall:function(){return{path:this.path+"/functions/call"}}}},auth:function(){return{path:this.path+"/auth",apiKeys:function(){return{path:this.path+"/api_keys",key:function(e){return{path:this.path+"/".concat(e),enable:function(){return{path:this.path+"/enable"}},disable:function(){return{path:this.path+"/disable"}}}}}},profile:function(){return{path:this.path+"/profile"}},session:function(){return{path:this.path+"/session"}}}}}}},we=function(){function e(t){j(this,e),this.fetcher=t}var t,r,n;return x(e,[{key:"create",value:function(e){return this.fetcher.fetchJSON({method:"POST",body:{name:e},path:me.api().auth().apiKeys().path,tokenType:"refresh"})}},{key:"fetch",value:function(e){return this.fetcher.fetchJSON({method:"GET",path:me.api().auth().apiKeys().key(e).path,tokenType:"refresh"})}},{key:"fetchAll",value:function(){return this.fetcher.fetchJSON({method:"GET",tokenType:"refresh",path:me.api().auth().apiKeys().path})}},{key:"delete",value:(n=(0,u.Z)(f().mark((function e(t){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetcher.fetchJSON({method:"DELETE",path:me.api().auth().apiKeys().key(t).path,tokenType:"refresh"});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"enable",value:(r=(0,u.Z)(f().mark((function e(t){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetcher.fetchJSON({method:"PUT",path:me.api().auth().apiKeys().key(t).enable().path,tokenType:"refresh"});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"disable",value:(t=(0,u.Z)(f().mark((function e(t){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetcher.fetchJSON({method:"PUT",path:me.api().auth().apiKeys().key(t).disable().path,tokenType:"refresh"});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),ke=null;function be(){if(ke)return ke;throw new Error("Cannot get environment before it's set")}var Te,je=function(e){g(r,e);var t=C(r);function r(e){var n,o=e.message,i=e.code;return j(this,r),(n=t.call(this,o)).name="WatchError",n.code=i,n}return r}(y(Error));!function(e){e.NEED_DATA="NEED_DATA",e.HAVE_EVENT="HAVE_EVENT",e.HAVE_ERROR="HAVE_ERROR"}(Te||(Te={}));var Ae=function(){function e(){j(this,e),this._state=Te.NEED_DATA,this._error=null,this._textDecoder=new(be().TextDecoder),this._buffer="",this._bufferOffset=0,this._eventType="",this._dataBuffer=""}return x(e,[{key:"feedBuffer",value:function(e){this.assertState(Te.NEED_DATA),this._buffer+=this._textDecoder.decode(e,{stream:!0}),this.advanceBufferState()}},{key:"feedLine",value:function(e){if(this.assertState(Te.NEED_DATA),e.endsWith("\n")&&(e=e.substr(0,e.length-1)),e.endsWith("\r")&&(e=e.substr(0,e.length-1)),0===e.length){if(0===this._dataBuffer.length)return void(this._eventType="");this._dataBuffer.endsWith("\n")&&(this._dataBuffer=this._dataBuffer.substr(0,this._dataBuffer.length-1)),this.feedSse({data:this._dataBuffer,eventType:this._eventType}),this._dataBuffer="",this._eventType=""}if(":"!==e[0]){var t=e.indexOf(":"),r=e.substr(0,t),n=-1===t?"":e.substr(t+1);n.startsWith(" ")&&(n=n.substr(1)),"event"===r?this._eventType=n:"data"===r&&(this._dataBuffer+=n,this._dataBuffer+="\n")}}},{key:"feedSse",value:function(e){this.assertState(Te.NEED_DATA);var t=e.data.indexOf("%");if(-1!==t){for(var r="",n=0,o=t;-1!==o;o=e.data.indexOf("%",n)){r+=e.data.substr(n,o-n);var i=e.data.substr(o,3);r+="%25"===i?"%":"%0A"===i?"\n":"%0D"===i?"\r":i,n=o+i.length}r+=e.data.substr(n),e.data=r}if(e.eventType&&"message"!==e.eventType){if("error"===e.eventType){this._state=Te.HAVE_ERROR,this._error=new je({message:e.data,code:"unknown"});try{var a=L.dF.parse(e.data),s=a.error_code,u=a.error;if("string"!=typeof s)return;if("string"!=typeof u)return;this._error=new je({message:u,code:s})}catch(f){return}}}else{try{var c=L.dF.parse(e.data);if("object"==typeof c)return this._nextEvent=c,void(this._state=Te.HAVE_EVENT)}catch(h){}this._state=Te.HAVE_ERROR,this._error=new je({message:"server returned malformed event: "+e.data,code:"bad bson parse"})}}},{key:"state",get:function(){return this._state}},{key:"nextEvent",value:function(){this.assertState(Te.HAVE_EVENT);var e=this._nextEvent;return this._state=Te.NEED_DATA,this.advanceBufferState(),e}},{key:"error",get:function(){return this._error}},{key:"advanceBufferState",value:function(){for(this.assertState(Te.NEED_DATA);this.state===Te.NEED_DATA;){if(this._bufferOffset===this._buffer.length)return this._buffer="",void(this._bufferOffset=0);var e=this._buffer.indexOf("\n",this._bufferOffset);if(-1===e)return void(0!==this._bufferOffset&&(this._buffer=this._buffer.substr(this._bufferOffset,this._buffer.length-this._bufferOffset),this._bufferOffset=0));this.feedLine(this._buffer.substr(this._bufferOffset,e-this._bufferOffset)),this._bufferOffset=e+1}}},{key:"assertState",value:function(e){if(this._state!==e)throw Error("Expected WatchStream to be in state ".concat(e,", but in state ").concat(this._state))}}]),e}(),xe=function(){function e(t,r,n,o){j(this,e),this.functions=Me.create(t,{serviceName:r}),this.databaseName=n,this.collectionName=o,this.serviceName=r,this.fetcher=t}return x(e,[{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.functions.find({database:this.databaseName,collection:this.collectionName,query:e,project:t.projection,sort:t.sort,limit:t.limit})}},{key:"findOne",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.functions.findOne({database:this.databaseName,collection:this.collectionName,query:e,project:t.projection,sort:t.sort})}},{key:"findOneAndUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.functions.findOneAndUpdate({database:this.databaseName,collection:this.collectionName,filter:e,update:t,sort:r.sort,projection:r.projection,upsert:r.upsert,returnNewDocument:r.returnNewDocument})}},{key:"findOneAndReplace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:e,update:t,sort:r.sort,projection:r.projection,upsert:r.upsert,returnNewDocument:r.returnNewDocument})}},{key:"findOneAndDelete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:e,sort:t.sort,projection:t.projection})}},{key:"aggregate",value:function(e){return this.functions.aggregate({database:this.databaseName,collection:this.collectionName,pipeline:e})}},{key:"count",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.functions.count({database:this.databaseName,collection:this.collectionName,query:e,limit:t.limit})}},{key:"insertOne",value:function(e){return this.functions.insertOne({database:this.databaseName,collection:this.collectionName,document:e})}},{key:"insertMany",value:function(e){return this.functions.insertMany({database:this.databaseName,collection:this.collectionName,documents:e})}},{key:"deleteOne",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.functions.deleteOne({database:this.databaseName,collection:this.collectionName,query:e})}},{key:"deleteMany",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.functions.deleteMany({database:this.databaseName,collection:this.collectionName,query:e})}},{key:"updateOne",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.functions.updateOne({database:this.databaseName,collection:this.collectionName,query:e,update:t,upsert:r.upsert})}},{key:"updateMany",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.functions.updateMany({database:this.databaseName,collection:this.collectionName,query:e,update:t,upsert:r.upsert})}},{key:"watch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.ids,n=t.filter;return S(f().mark((function t(){var o,i,a,s,u,c,h,l,p;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(e.functions.callFunctionStreaming("watch",{database:e.databaseName,collection:e.collectionName,ids:r,filter:n}));case 2:o=t.sent,i=new Ae,a=!0,s=!1,t.prev=6,c=O(o);case 8:return t.next=10,D(c.next());case 10:return h=t.sent,a=h.done,t.next=14,D(h.value);case 14:if(l=t.sent,a){t.next=30;break}if(p=l){t.next=19;break}return t.abrupt("continue",27);case 19:i.feedBuffer(p);case 20:if(i.state!=Te.HAVE_EVENT){t.next=25;break}return t.next=23,i.nextEvent();case 23:t.next=20;break;case 25:if(i.state!=Te.HAVE_ERROR){t.next=27;break}throw i.error;case 27:a=!0,t.next=8;break;case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(6),s=!0,u=t.t0;case 36:if(t.prev=36,t.prev=37,a||null==c.return){t.next=41;break}return t.next=41,D(c.return());case 41:if(t.prev=41,!s){t.next=44;break}throw u;case 44:return t.finish(41);case 45:return t.finish(36);case 46:case"end":return t.stop()}}),t,null,[[6,32,36,46],[37,,41,45]])})))()}}]),e}();function Ie(e,t,r,n){return new xe(e,t,r,n)}function De(e,t,r){return{collection:Ie.bind(null,e,t,r)}}var Ee,Se;!function(e){e.Active="active",e.LoggedOut="logged-out",e.Removed="removed"}(Ee||(Ee={})),function(e){e.Normal="normal",e.Server="server"}(Se||(Se={}));var Oe=function(){function e(t){if(j(this,e),this.app=t.app,this.id=t.id,this.storage=new pe(this.app.storage,this.id),"accessToken"in t&&"refreshToken"in t&&"providerType"in t)this._accessToken=t.accessToken,this._refreshToken=t.refreshToken,this.providerType=t.providerType,this.storage.accessToken=t.accessToken,this.storage.refreshToken=t.refreshToken,this.storage.providerType=t.providerType;else{this._accessToken=this.storage.accessToken,this._refreshToken=this.storage.refreshToken;var r=this.storage.providerType;if(this._profile=this.storage.profile,!r)throw new Error("Storage is missing a provider type");this.providerType=r}this.fetcher=this.app.fetcher.clone({userContext:{currentUser:this}}),this.apiKeys=new we(this.fetcher),this.functions=Me.create(this.fetcher)}var t,r,n,o,i;return x(e,[{key:"accessToken",get:function(){return this._accessToken},set:function(e){this._accessToken=e,this.storage.accessToken=e}},{key:"refreshToken",get:function(){return this._refreshToken},set:function(e){this._refreshToken=e,this.storage.refreshToken=e}},{key:"state",get:function(){return this.id in this.app.allUsers?null===this.refreshToken?Ee.LoggedOut:Ee.Active:Ee.Removed}},{key:"isLoggedIn",get:function(){return this.state===Ee.Active}},{key:"customData",get:function(){if(this.accessToken)return this.decodeAccessToken().userData;throw new Error("Cannot read custom data without an access token")}},{key:"profile",get:function(){if(this._profile)return this._profile.data;throw new Error("A profile was never fetched for this user")}},{key:"identities",get:function(){if(this._profile)return this._profile.identities;throw new Error("A profile was never fetched for this user")}},{key:"deviceId",get:function(){if(this.accessToken){var e=this.accessToken.split(".")[1];if(e){var t=JSON.parse(re.Base64.decode(e)).baas_device_id;if("string"==typeof t&&"000000000000000000000000"!==t)return t}}return null}},{key:"refreshProfile",value:(i=(0,u.Z)(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetcher.fetchJSON({method:"GET",path:me.api().auth().profile().path});case 2:t=e.sent,this._profile=new se(t),this.storage.profile=this._profile;case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"logOut",value:(o=(0,u.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===this._refreshToken){e.next=4;break}return e.next=4,this.fetcher.fetchJSON({method:"DELETE",path:me.api().auth().session().path,tokenType:"refresh"});case 4:return e.prev=4,this.accessToken=null,this.refreshToken=null,e.finish(4);case 8:case"end":return e.stop()}}),e,this,[[0,,4,8]])}))),function(){return o.apply(this,arguments)})},{key:"linkCredentials",value:(n=(0,u.Z)(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.authenticator.authenticate(t,this);case 2:if(r=e.sent,this.id===r.userId){e.next=6;break}throw n="got user id ".concat(r.userId," expected ").concat(this.id),new Error("Link response ment for another user (".concat(n,")"));case 6:return this.accessToken=r.accessToken,e.next=9,this.refreshProfile();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"refreshAccessToken",value:(r=(0,u.Z)(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetcher.fetchJSON({method:"POST",path:me.api().auth().session().path,tokenType:"refresh"});case 2:if(t=e.sent,"string"!=typeof(r=t.access_token)){e.next=8;break}this.accessToken=r,e.next=9;break;case 8:throw new Error("Expected an 'access_token' in the response");case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"refreshCustomData",value:(t=(0,u.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshAccessToken();case 2:return e.abrupt("return",this.customData);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"callFunction",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this.functions).callFunction.apply(t,[e].concat(n))}},{key:"toJSON",value:function(){return{id:this.id,accessToken:this.accessToken,refreshToken:this.refreshToken,profile:this._profile,state:this.state,customData:this.customData}}},{key:"push",value:function(){throw new Error("Not yet implemented")}},{key:"mongoClient",value:function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mongo-db";return{db:De.bind(null,e,t)}}(this.fetcher,e)}},{key:"decodeAccessToken",value:function(){if(this.accessToken){var e=this.accessToken.split(".");if(3!==e.length)throw new Error("Expected an access token with three parts");var t=e[1],r=re.Base64.decode(t),n=JSON.parse(r),o=n.exp,i=n.iat,a=n.sub,s=n.user_data,u=void 0===s?{}:s;if("number"!=typeof o)throw new Error("Failed to decode access token 'exp'");if("number"!=typeof i)throw new Error("Failed to decode access token 'iat'");return{expires:o,issuedAt:i,subject:a,userData:u}}throw new Error("Missing an access token")}}]),e}(),ze=function(){function e(t,r,n){j(this,e),this.providerName=t,this.providerType=r,this.payload=n}return x(e,null,[{key:"anonymous",value:function(){return new e("anon-user","anon-user",{})}},{key:"userApiKey",value:function(t){return new e("api-key","api-key",{key:t})}},{key:"serverApiKey",value:function(t){return new e("api-key","api-key",{key:t})}},{key:"apiKey",value:function(t){return new e("api-key","api-key",{key:t})}},{key:"emailPassword",value:function(t,r){return new e("local-userpass","local-userpass",{username:t,password:r})}},{key:"function",value:function(t){return new e("custom-function","custom-function",t)}},{key:"jwt",value:function(t){return new e("custom-token","custom-token",{token:t})}},{key:"google",value:function(t){return new e("oauth2-google","oauth2-google",e.derivePayload(t))}},{key:"derivePayload",value:function(e){if("string"==typeof e){if(e.includes("://"))return this.derivePayload({redirectUrl:e});if(e.startsWith("4/"))return this.derivePayload({authCode:e});if(e.startsWith("ey"))return this.derivePayload({idToken:e});throw new Error("Unexpected payload: ".concat(e))}if(1===Object.keys(e).length){if("authCode"in e||"redirectUrl"in e)return e;if("idToken"in e)return{id_token:e.idToken};throw new Error("Unexpected payload: "+JSON.stringify(e))}throw new Error("Expected only one property in payload, got "+JSON.stringify(e))}},{key:"facebook",value:function(t){return new e("oauth2-facebook","oauth2-facebook",t.includes("://")?{redirectUrl:t}:{accessToken:t})}},{key:"apple",value:function(t){return new e("oauth2-apple","oauth2-apple",t.includes("://")?{redirectUrl:t}:{id_token:t})}}]),e}(),Le="userIds",Ue="deviceId",_e=function(e){g(r,e);var t=C(r);function r(e,n){return j(this,r),t.call(this,e,"app(".concat(n,")"))}return x(r,[{key:"getUserIds",value:function(){var e=this.get(Le),t=e?JSON.parse(e):[];if(Array.isArray(t))return(0,v.Z)(new Set(t));throw new Error("Expected the user ids to be an array")}},{key:"setUserIds",value:function(e,t){if(t){var r,n=U(this.getUserIds());try{for(n.s();!(r=n.n()).done;){var o=r.value;-1===e.indexOf(o)&&e.push(o)}}catch(i){n.e(i)}finally{n.f()}}this.set(Le,JSON.stringify(e))}},{key:"removeUserId",value:function(e){var t=this.getUserIds().filter((function(t){return t!==e}));this.setUserIds(t,!1)}},{key:"getDeviceId",value:function(){return this.get(Ue)}},{key:"setDeviceId",value:function(e){this.set(Ue,e)}}]),r}(ue),Ce={_stitch_client_app_id:"appId",_baas_client_app_id:"appId",_stitch_ua:"userAuth",_baas_ua:"userAuth",_stitch_link:"link",_baas_link:"link",_stitch_error:"error",_baas_error:"error",_stitch_state:"state",_baas_state:"state"},Re=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be().openWindow;j(this,e),this.storage=t.prefix("oauth2"),this.openWindow=r}return x(e,[{key:"openWindowAndWaitForRedirect",value:function(t,r){var n=this,o=e.getStateStorage(this.storage,r);return new Promise((function(e,r){var i,a=null,s=function t(){var r=o.get("result");if(r){var n=JSON.parse(r);o.removeListener(t),o.clear();try{a&&(clearInterval(i),a.close())}catch(s){console.warn("Failed closing redirect window: ".concat(s))}finally{e(n)}}};o.addListener(s),a=n.openWindow(t),i=setInterval((function(){if(a){if(a.closed){clearInterval(i),o.removeListener(s);var e=new Error("Window closed");r(e)}}else clearInterval(i)}),100)}))}},{key:"generateState",value:function(){return function(e,t){for(var r="",n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}(12,"abcdefghijklmnopqrstuvwxyz")}}],[{key:"parseRedirectLocation",value:function(e){for(var t,r,n=(r="?"===(t=e)[0]?t.substr(1):t,Object.fromEntries(r.split("&").filter((function(e){return e.length>0})).map((function(e){return e.split("=")})).map((function(e){var t=w(e,2),r=t[0],n=t[1];return[r,decodeURIComponent(n)]})))),o={},i=0,a=Object.entries(Ce);i<a.length;i++){var s=w(a[i],2),u=s[0],c=s[1],f=n[u];f&&(o[c]=f)}return o}},{key:"handleRedirect",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be().defaultStorage,n=e.parseRedirectLocation(t),o=n.state,i=n.error;if("string"!=typeof o)throw i?new Error("Failed to handle OAuth 2.0 redirect: ".concat(i)):new Error("Failed to handle OAuth 2.0 redirect.");var a=r.prefix("oauth2"),s=e.getStateStorage(a,o);s.set("result",JSON.stringify(n))}},{key:"decodeAuthInfo",value:function(e){var t=(e||"").split("$");if(4===t.length){var r=w(t,4);return{accessToken:r[0],refreshToken:r[1],userId:r[2],deviceId:r[3]}}throw new Error("Failed to decode 'authInfo' into ids and tokens")}},{key:"getStateStorage",value:function(e,t){return e.prefix("state(".concat(t,")"))}}]),e}(),Pe="x-baas-location",Qe=function(){function e(t,r,n){j(this,e),this.fetcher=t,this.oauth2=new Re(r),this.getDeviceInformation=n}var t,r,n;return x(e,[{key:"authenticate",value:(n=(0,u.Z)(f().mark((function e(t,r){var n,o,i,a,s,u,c,h,l,p,d,y,v;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getDeviceInformation(),o="object"==typeof r,!t.providerType.startsWith("oauth2")||"string"!=typeof t.payload.redirectUrl){e.next=22;break}return i=this.oauth2.generateState(),e.next=6,this.getLogInUrl(t,o,{state:i,redirect:t.payload.redirectUrl,providerRedirectHeader:!!o||void 0,device:o?void 0:n.encode()});case 6:if(a=e.sent,!o){e.next=19;break}return e.next=10,this.fetcher.fetch({method:"GET",url:a,tokenType:o?"access":"none",user:r,mode:"cors",credentials:"include"});case 10:if(s=e.sent,!(u=s.headers.get(Pe))){e.next=16;break}return e.abrupt("return",this.openWindowAndWaitForAuthResponse(u,i));case 16:throw new Error("Missing ".concat(Pe," header"));case 17:e.next=20;break;case 19:return e.abrupt("return",this.openWindowAndWaitForAuthResponse(a,i));case 20:e.next=34;break;case 22:return e.next=24,this.getLogInUrl(t,o);case 24:return c=e.sent,e.next=27,this.fetcher.fetchJSON({method:"POST",url:c,body:P(P({},t.payload),{},{options:{device:n.toJSON()}}),tokenType:o?"access":"none",user:r});case 27:if(h=e.sent,l=h.user_id,p=h.access_token,d=h.refresh_token,y=void 0===d?null:d,v=h.device_id,"string"==typeof l){e.next=31;break}throw new Error("Expected a user id in the response");case 31:if("string"==typeof p){e.next=33;break}throw new Error("Expected an access token in the response");case 33:return e.abrupt("return",{userId:l,accessToken:p,refreshToken:y,deviceId:v});case 34:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getLogInUrl",value:(r=(0,u.Z)(f().mark((function e(t){var r,n,o,i,a,s,u=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]&&u[1],n=u.length>2&&void 0!==u[2]?u[2]:{},o=this.fetcher.appRoute,i=o.authProvider(t.providerName).login(),a=ye(P({link:r?"true":void 0},n)),e.next=7,this.fetcher.locationUrl;case 7:return s=e.sent,e.abrupt("return",s+i.path+a);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"openWindowAndWaitForAuthResponse",value:(t=(0,u.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.oauth2.openWindowAndWaitForRedirect(t,r);case 2:return n=e.sent,e.abrupt("return",Re.decodeAuthInfo(n.userAuth));case 4:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}(),Ze=function(e){g(n,e);var t,r=C(n);function n(e,t,o,i,a,s,u){var c;j(this,n);var f=i?"status ".concat(o," ").concat(i):"status ".concat(o);return(c="string"==typeof a?r.call(this,"Request failed (".concat(e," ").concat(t,"): ").concat(a," (").concat(f,")")):r.call(this,"Request failed (".concat(e," ").concat(t,"): (").concat(f,")"))).method=e,c.url=t,c.statusText=i,c.statusCode=o,c.error=a,c.errorCode=s,c.link=u,N(c)}return x(n,null,[{key:"fromRequestAndResponse",value:(t=(0,u.Z)(f().mark((function e(t,r){var o,i,a,s,u,c,h,l,p;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.url,a=t.method,s=r.status,u=r.statusText,!(null===(o=r.headers.get("content-type"))||void 0===o?void 0:o.startsWith("application/json"))){e.next=12;break}return e.next=5,r.json();case 5:return c=e.sent,h=c.error||"No message",l=c.error_code,p=c.link,e.abrupt("return",new n(a,i,s,u,h,l,p));case 12:return e.abrupt("return",new n(a,i,s,u));case 13:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),n}(y(Error));function Ve(e){if("object"!=typeof e||null===e)throw new Error("Expected a non-null object");if(Symbol.asyncIterator in e)return e;if("getReader"in e){var t=e;return(0,k.Z)({},Symbol.asyncIterator,(function(){var e=t.getReader();return{next:function(){return e.read()},return:function(){return(0,u.Z)(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cancel();case 2:return t.abrupt("return",{done:!0,value:null});case 3:case"end":return t.stop()}}),t)})))()}}}))}throw new Error("Expected an AsyncIterable or a ReadableStream")}var Be,Ye=function(){function e(t){var r=t.appId,n=t.transport,o=t.userContext,i=t.locationUrlContext;j(this,e),this.appId=r,this.transport=n,this.userContext=o,this.locationUrlContext=i}var t,r,n;return x(e,[{key:"clone",value:function(t){return new e(P({appId:this.appId,transport:this.transport,userContext:this.userContext,locationUrlContext:this.locationUrlContext},t))}},{key:"fetch",value:(n=(0,u.Z)(f().mark((function t(r){var n,o,i,a,s,u,c,h,l;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.path,o=r.url,i=r.tokenType,a=void 0===i?"access":i,s=r.user,u=void 0===s?this.userContext.currentUser:s,c=T(r,["path","url","tokenType","user"]),"string"!=typeof n||"string"!=typeof o){t.next=5;break}throw new Error("Use of 'url' and 'path' mutually exclusive");case 5:if("string"!=typeof n){t.next=14;break}return t.next=8,this.locationUrlContext.locationUrl;case 8:return t.t0=t.sent,t.t1=n,h=t.t0+t.t1,t.abrupt("return",this.fetch(P(P({},r),{},{path:void 0,url:h})));case 14:if("string"!=typeof o){t.next=34;break}return t.next=17,this.transport.fetch(P(P({},c),{},{url:o,headers:P(P({},e.buildAuthorizationHeader(u,a)),r.headers)}));case 17:if(!(l=t.sent).ok){t.next=22;break}return t.abrupt("return",l);case 22:if(!u||401!==l.status||"access"!==a){t.next=28;break}return t.next=25,u.refreshAccessToken();case 25:return t.abrupt("return",this.fetch(P(P({},r),{},{user:u})));case 28:return u&&401===l.status&&"refresh"===a&&(u.accessToken=null,u.refreshToken=null),t.next=31,Ze.fromRequestAndResponse(r,l);case 31:throw t.sent;case 32:t.next=35;break;case 34:throw new Error("Expected either 'url' or 'path'");case 35:case"end":return t.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchJSON",value:(r=(0,u.Z)(f().mark((function t(r){var n,o,i,a,s,u;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.body,o=e.buildBody(n),i=e.buildJsonHeader(o),t.next=5,this.fetch(P(P({},r),{},{body:o,headers:P(P({Accept:"application/json"},i),r.headers)}));case 5:if(a=t.sent,!(null==(s=a.headers.get("content-type"))?void 0:s.startsWith("application/json"))){t.next=14;break}return t.next=10,a.json();case 10:return u=t.sent,t.abrupt("return",ie(u));case 14:if(null!==s){t.next=18;break}return t.abrupt("return",null);case 18:throw new Error('Expected JSON response, got "'.concat(s,'"'));case 19:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})},{key:"fetchStream",value:(t=(0,u.Z)(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(P(P({},t),{},{headers:P({Accept:"text/event-stream"},t.headers)}));case 2:return r=e.sent,n=r.body,e.abrupt("return",Ve(n));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"appRoute",get:function(){return me.api().app(this.appId)}},{key:"locationUrl",get:function(){return this.locationUrlContext.locationUrl}}],[{key:"buildAuthorizationHeader",value:function(e,t){if(e&&"none"!==t){if("access"===t)return{Authorization:"Bearer ".concat(e.accessToken)};if("refresh"===t)return{Authorization:"Bearer ".concat(e.refreshToken)};throw new Error("Unexpected token type (".concat(t,")"))}return{}}},{key:"buildBody",value:function(e){if(e){if("object"==typeof e&&null!==e)return JSON.stringify(oe(e));if("string"==typeof e)return e;throw console.log("body is",e),new Error("Unexpected type of body")}}},{key:"buildJsonHeader",value:function(e){return e&&e.length>0?{"Content-Type":"application/json"}:{}}}]),e}(),We="deviceId";!function(e){e.DEVICE_ID="deviceId",e.APP_ID="appId",e.APP_VERSION="appVersion",e.PLATFORM="platform",e.PLATFORM_VERSION="platformVersion",e.SDK_VERSION="sdkVersion"}(Be||(Be={}));var Fe=function(){function e(t){var r=t.appId,n=t.appVersion,o=t.deviceId;j(this,e),this.sdkVersion="1.2.1";var i=be();this.platform=i.platform,this.platformVersion=i.platformVersion,this.appId=r,this.appVersion=n,this.deviceId=o}return x(e,[{key:"encode",value:function(){var e=de(this);return re.Base64.encode(JSON.stringify(e))}},{key:"toJSON",value:function(){return de(this)}}]),e}(),Je=function(){function e(t){var r=this;j(this,e),this.users=[],this._locationUrl=null;var n="string"==typeof t?{id:t}:t;if("object"!=typeof n||"string"!=typeof n.id)throw new Error("Missing a MongoDB Realm app-id");this.id=n.id,this.baseUrl=n.baseUrl||"https://stitch.mongodb.com",this.localApp=n.app;var o=n.storage,i=n.transport,a=void 0===i?new K:i;this.fetcher=new Ye({appId:this.id,userContext:this,locationUrlContext:this,transport:a}),this.emailPasswordAuth=new Ne(this.fetcher);var s=o||be().defaultStorage;this.storage=new _e(s,this.id),this.authenticator=new Qe(this.fetcher,s,(function(){return r.deviceInformation}));try{this.hydrate()}catch(u){this.storage.clear(),console.warn("Realm app hydration failed:",u.message)}}var t,r;return x(e,[{key:"switchUser",value:function(e){var t=this.users.findIndex((function(t){return t===e}));if(-1===t)throw new Error("The user was never logged into this app");var r=w(this.users.splice(t,1),1)[0];this.users.unshift(r)}},{key:"logIn",value:(r=(0,u.Z)(f().mark((function e(t){var r,n,o,i,a=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.authenticator.authenticate(t);case 3:if(n=e.sent,o=this.createOrUpdateUser(n,t.providerType),this.switchUser(o),!r){e.next=9;break}return e.next=9,o.refreshProfile();case 9:return this.storage.setUserIds(this.users.map((function(e){return e.id})),!0),(i=n.deviceId)&&"000000000000000000000000"!==i&&this.storage.set(We,i),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"removeUser",value:(t=(0,u.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==(r=this.users.findIndex((function(e){return e===t})))){e.next=3;break}throw new Error("The user was never logged into this app");case 3:return this.users.splice(r,1),e.next=6,t.logOut();case 6:this.storage.remove("user(".concat(t.id,"):profile")),this.storage.removeUserId(t.id);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"currentUser",get:function(){var e=this.users.filter((function(e){return e.state===Ee.Active}));return 0===e.length?null:e[0]}},{key:"allUsers",get:function(){return Object.fromEntries(this.users.map((function(e){return[e.id,e]})))}},{key:"locationUrl",get:function(){var e=this;if(!this._locationUrl){var t=me.api().app(this.id).location().path;this._locationUrl=this.fetcher.fetchJSON({method:"GET",url:this.baseUrl+t,tokenType:"none"}).then((function(e){var t=e.hostname;if("string"!=typeof t)throw new Error("Expected response to contain a 'hostname'");return t})).catch((function(t){throw e._locationUrl=null,t}))}return this._locationUrl}},{key:"deviceInformation",get:function(){var e=this.storage.getDeviceId(),t="string"==typeof e&&"000000000000000000000000"!==e?new L.Zw(e):void 0;return new Fe({appId:this.localApp?this.localApp.name:void 0,appVersion:this.localApp?this.localApp.version:void 0,deviceId:t})}},{key:"createOrUpdateUser",value:function(e,t){var r=this.users.find((function(t){return t.id===e.userId}));if(r)return r.accessToken=e.accessToken,r.refreshToken=e.refreshToken,r;if(!e.refreshToken)throw new Error("No refresh token in response from server");var n=new Oe({app:this,id:e.userId,accessToken:e.accessToken,refreshToken:e.refreshToken,providerType:t});return this.users.unshift(n),n}},{key:"hydrate",value:function(){var e=this,t=this.storage.getUserIds();this.users=t.map((function(t){return new Oe({app:e,id:t})}))}}],[{key:"getApp",value:function(t){if(t in e.appCache)return e.appCache[t];var r=new e(t);return e.appCache[t]=r,r}}]),e}();Je.appCache={},Je.Credentials=ze;var He,Ge=function(){function e(){if(j(this,e),"object"!=typeof window)throw new Error("Cannot use LocalStorage without a global window object");this.window=window}return x(e,[{key:"get",value:function(e){return this.window.localStorage.getItem(e)}},{key:"set",value:function(e,t){return this.window.localStorage.setItem(e,t)}},{key:"remove",value:function(e){return this.window.localStorage.removeItem(e)}},{key:"prefix",value:function(e){return new ue(this,e)}},{key:"clear",value:function(e){for(var t=[],r=0;r<this.window.localStorage.length;r++){var n=this.window.localStorage.key(r);!n||e&&!n.startsWith(e)||t.push(n)}for(var o=0,i=t;o<i.length;o++){var a=i[o];this.window.localStorage.removeItem(a)}}},{key:"addListener",value:function(e){return this.window.addEventListener("storage",e)}},{key:"removeListener",value:function(e){return this.window.removeEventListener("storage",e)}}]),e}(),Ke=He?G(He):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new W:"undefined"!=typeof navigator?G(navigator.userAgent):"undefined"!=typeof process&&process.version?new V(process.version.slice(1)):null,qe={defaultStorage:(new Ge).prefix("realm-web"),openWindow:function(e){return window.open(e)},platform:(null==Ke?void 0:Ke.name)||"web",platformVersion:(null==Ke?void 0:Ke.version)||"0.0.0",TextDecoder:TextDecoder};ke=qe;var $e=new Je({id:"jotter-bdqbf"}),Xe={}.MDB_AUTH_USER;if(!Xe)throw new Error("Could not find a Realm Server API Key.");var et=ze.serverApiKey(Xe);function tt(){return(tt=(0,u.Z)(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$e.logIn(et);case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to log in",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var rt,nt,ot,it=r(9694),at=r(4816),st=r(7721),ut=r(2441),ct=i.ZP.img(rt||(rt=(0,n.Z)(["\n  width: 12rem;\n"]))),ft=i.ZP.h1(nt||(nt=(0,n.Z)(["\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n  max-width: 25rem;\n  font-size: 1.5rem;\n  font-weight: 500;\n  color: var(--gray);\n  text-align: center;\n"]))),ht=i.ZP.button(ot||(ot=(0,n.Z)(["\n  padding: 0.8rem 2rem;\n  border-radius: 2rem;\n  background-color: #1bd692;\n  color: white;\n  font-size: 1rem;\n  font-weight: 600;\n\n  &:hover {\n    background-color: #1acf8d;\n  }\n"]))),lt=function(){var e=(0,s.D3)().loginWithRedirect,t=function(){e({}),function(){tt.apply(this,arguments)}()};return o.createElement(ht,{onClick:function(){return t()}},"Sign in")},pt=function(){var e=(0,s.D3)(),t=e.isAuthenticated,r=e.isLoading;return t||r?r?o.createElement(ut.i,null,o.createElement(ut.g,{minHeight:"60vh",src:a.Z,alt:"Loading icon",className:"rotating"})):o.createElement(it.Router,null,o.createElement(at.rC,{path:"/",component:st.default})):o.createElement(ut.i,{minHeight:"100vh"},o.createElement(ct,{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCA2NCAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYuMDc1IDE1LjI1QzQuODI1IDE1LjI1IDMuODE2NjcgMTUuMDMzMyAzLjA1IDE0LjZDMi4yODMzMyAxNC4xNSAxLjcyNSAxMy41NDE3IDEuMzc1IDEyLjc3NUMxLjA0MTY3IDEyLjAwODMgMC44NzUgMTEuMTI1IDAuODc1IDEwLjEyNUg0LjE3NUM0LjE3NSAxMC42OTE3IDQuMjkxNjcgMTEuMTkxNyA0LjUyNSAxMS42MjVDNC43NzUgMTIuMDQxNyA1LjI1IDEyLjI1IDUuOTUgMTIuMjVDNi41NSAxMi4yNSA2Ljk5MTY3IDEyLjA2NjcgNy4yNzUgMTEuN0M3LjU1ODMzIDExLjMxNjcgNy43IDEwLjU2NjcgNy43IDkuNDVWMy41NzVINC43NVYwLjkyNDk5OUgxMS4yVjguODVDMTEuMiA5LjgxNjY3IDExLjEzMzMgMTAuNyAxMSAxMS41QzEwLjg4MzMgMTIuMjgzMyAxMC42NSAxMi45NTgzIDEwLjMgMTMuNTI1QzkuOTUgMTQuMDc1IDkuNDMzMzMgMTQuNSA4Ljc1IDE0LjhDOC4wODMzMyAxNS4xIDcuMTkxNjcgMTUuMjUgNi4wNzUgMTUuMjVaTTE4LjY3MDMgMTUuMjVDMTcuNDUzNiAxNS4yNSAxNi40MzcgMTUuMDI1IDE1LjYyMDMgMTQuNTc1QzE0LjgwMzYgMTQuMTA4MyAxNC4xOTUzIDEzLjQ3NSAxMy43OTUzIDEyLjY3NUMxMy4zOTUzIDExLjg3NSAxMy4xOTUzIDEwLjk2NjcgMTMuMTk1MyA5Ljk1QzEzLjE3ODYgOC45MTY2NyAxMy4zNzAzIDguMDA4MzMgMTMuNzcwMyA3LjIyNUMxNC4xNzAzIDYuNDI1IDE0Ljc3ODYgNS43OTE2NyAxNS41OTUzIDUuMzI1QzE2LjQyODYgNC44NTgzMyAxNy40NTM2IDQuNjI1IDE4LjY3MDMgNC42MjVDMjAuNDUzNiA0LjYyNSAyMS44MDM2IDUuMTE2NjcgMjIuNzIwMyA2LjFDMjMuNjUzNiA3LjA2NjY3IDI0LjEyMDMgOC4zNSAyNC4xMjAzIDkuOTVDMjQuMTIwMyAxMC45NSAyMy45MjAzIDExLjg1IDIzLjUyMDMgMTIuNjVDMjMuMTM3IDEzLjQ1IDIyLjU0NTMgMTQuMDgzMyAyMS43NDUzIDE0LjU1QzIwLjk0NTMgMTUuMDE2NyAxOS45MjAzIDE1LjI1IDE4LjY3MDMgMTUuMjVaTTE4LjY3MDMgMTIuMzVDMTkuMjg3IDEyLjM1IDE5Ljc0NTMgMTIuMjI1IDIwLjA0NTMgMTEuOTc1QzIwLjM0NTMgMTEuNzI1IDIwLjUzNyAxMS40MDgzIDIwLjYyMDMgMTEuMDI1QzIwLjcyMDMgMTAuNjI1IDIwLjc3MDMgMTAuMjI1IDIwLjc3MDMgOS44MjVDMjAuNzcwMyA5LjQwODMzIDIwLjcyMDMgOS4wMDgzMyAyMC42MjAzIDguNjI1QzIwLjUzNyA4LjI0MTY3IDIwLjM0NTMgNy45MjUgMjAuMDQ1MyA3LjY3NUMxOS43NDUzIDcuNDA4MzMgMTkuMjg3IDcuMjc1IDE4LjY3MDMgNy4yNzVDMTguMDUzNiA3LjI3NSAxNy41ODcgNy40MDgzMyAxNy4yNzAzIDcuNjc1QzE2Ljk3MDMgNy45MjUgMTYuNzcwMyA4LjI0MTY3IDE2LjY3MDMgOC42MjVDMTYuNTg3IDkuMDA4MzMgMTYuNTQ1MyA5LjQwODMzIDE2LjU0NTMgOS44MjVDMTYuNTQ1MyAxMC4yMjUgMTYuNTg3IDEwLjYyNSAxNi42NzAzIDExLjAyNUMxNi43NzAzIDExLjQwODMgMTYuOTcwMyAxMS43MjUgMTcuMjcwMyAxMS45NzVDMTcuNTg3IDEyLjIyNSAxOC4wNTM2IDEyLjM1IDE4LjY3MDMgMTIuMzVaTTI5Ljk1MjkgMTVDMjguOTUyOSAxNSAyOC4xNjEzIDE0Ljc2NjcgMjcuNTc3OSAxNC4zQzI2Ljk5NDYgMTMuODMzMyAyNi43MDI5IDEyLjk4MzMgMjYuNzAyOSAxMS43NVY3LjAyNUgyNS4yNTI5VjQuNjVDMjUuNjUyOSA0LjY1IDI1Ljk5NDYgNC41OTE2NyAyNi4yNzc5IDQuNDc1QzI2LjU3NzkgNC4zNTgzMyAyNi44MDI5IDQuMTE2NjcgMjYuOTUyOSAzLjc1QzI3LjExOTYgMy4zNjY2NyAyNy4yMDI5IDIuNzkxNjcgMjcuMjAyOSAyLjAyNUgyOS45NTI5VjQuNjVIMzIuMjc3OVY3LjAyNUgyOS45NTI5VjEyLjMyNUgzMi4zNTI5VjE1SDI5Ljk1MjlaTTM4LjMwMjUgMTVDMzcuMzAyNSAxNSAzNi41MTA5IDE0Ljc2NjcgMzUuOTI3NSAxNC4zQzM1LjM0NDIgMTMuODMzMyAzNS4wNTI1IDEyLjk4MzMgMzUuMDUyNSAxMS43NVY3LjAyNUgzMy42MDI1VjQuNjVDMzQuMDAyNSA0LjY1IDM0LjM0NDIgNC41OTE2NyAzNC42Mjc1IDQuNDc1QzM0LjkyNzUgNC4zNTgzMyAzNS4xNTI1IDQuMTE2NjcgMzUuMzAyNSAzLjc1QzM1LjQ2OTIgMy4zNjY2NyAzNS41NTI1IDIuNzkxNjcgMzUuNTUyNSAyLjAyNUgzOC4zMDI1VjQuNjVINDAuNjI3NVY3LjAyNUgzOC4zMDI1VjEyLjMyNUg0MC43MDI1VjE1SDM4LjMwMjVaTTQ3LjQ1MjEgMTUuMjVDNDYuMjAyMSAxNS4yNSA0NS4xOTM4IDE1IDQ0LjQyNzEgMTQuNUM0My42NjA1IDE0IDQzLjA5MzggMTMuMzU4MyA0Mi43MjcxIDEyLjU3NUM0Mi4zNzcxIDExLjc3NSA0Mi4xODU1IDEwLjk0MTcgNDIuMTUyMSAxMC4wNzVDNDIuMTE4OCA4Ljk0MTY3IDQyLjMxODggNy45NjY2NyA0Mi43NTIxIDcuMTVDNDMuMTg1NSA2LjMxNjY3IDQzLjc5MzggNS42ODMzMyA0NC41NzcxIDUuMjVDNDUuMzc3MSA0LjggNDYuMjkzOCA0LjU3NSA0Ny4zMjcxIDQuNTc1QzQ4LjMxMDUgNC41NzUgNDkuMTg1NSA0Ljc4MzMzIDQ5Ljk1MjEgNS4yQzUwLjczNTUgNS42IDUxLjM0MzggNi4xNzUgNTEuNzc3MSA2LjkyNUM1Mi4yMjcxIDcuNjc1IDUyLjQ1MjEgOC41NzUgNTIuNDUyMSA5LjYyNVYxMC4yNzVINDUuNDUyMUM0NS40NTIxIDExLjAwODMgNDUuNjI3MSAxMS41NDE3IDQ1Ljk3NzEgMTEuODc1QzQ2LjM0MzggMTIuMjA4MyA0Ni44MTA1IDEyLjM3NSA0Ny4zNzcxIDEyLjM3NUM0Ny44NjA1IDEyLjM3NSA0OC4yNDM4IDEyLjI2NjcgNDguNTI3MSAxMi4wNUM0OC44MjcxIDExLjgxNjcgNDkuMDAyMSAxMS41MjUgNDkuMDUyMSAxMS4xNzVINTIuNDI3MUM1Mi4zNzcxIDExLjkwODMgNTIuMTYwNSAxMi41OTE3IDUxLjc3NzEgMTMuMjI1QzUxLjM5MzggMTMuODQxNyA1MC44NDM4IDE0LjMzMzMgNTAuMTI3MSAxNC43QzQ5LjQxMDUgMTUuMDY2NyA0OC41MTg4IDE1LjI1IDQ3LjQ1MjEgMTUuMjVaTTQ1LjUwMjEgOC44NzVINDguOTUyMUM0OC45NTIxIDguODc1IDQ4Ljk0MzggOC44IDQ4LjkyNzEgOC42NUM0OC45MjcxIDguNSA0OC44NzcxIDguMzI1IDQ4Ljc3NzEgOC4xMjVDNDguNjc3MSA3LjkyNSA0OC41MTA1IDcuNzUgNDguMjc3MSA3LjZDNDguMDQzOCA3LjQ1IDQ3LjcwMjEgNy4zNzUgNDcuMjUyMSA3LjM3NUM0Ni44MDIxIDcuMzc1IDQ2LjQ1MjEgNy40NSA0Ni4yMDIxIDcuNkM0NS45NTIxIDcuNzUgNDUuNzc3MSA3LjkyNSA0NS42NzcxIDguMTI1QzQ1LjU5MzggOC4zMjUgNDUuNTQzOCA4LjUgNDUuNTI3MSA4LjY1QzQ1LjUxMDUgOC44IDQ1LjUwMjEgOC44NzUgNDUuNTAyMSA4Ljg3NVpNNTQuMjkzIDE1VjQuNjVINTcuNTkzTDU3LjgxOCA3LjZDNTcuOTE4IDcuMTY2NjcgNTguMTA5NiA2LjcyNSA1OC4zOTMgNi4yNzVDNTguNjc2MyA1LjgwODMzIDU5LjA4NDYgNS40MjUgNTkuNjE4IDUuMTI1QzYwLjE1MTMgNC44MDgzMyA2MC44NTEzIDQuNjUgNjEuNzE4IDQuNjVINjEuOTQzVjguNTI1SDYxLjY5M0M2MC44NTk2IDguNTI1IDYwLjE1MTMgOC41NzUgNTkuNTY4IDguNjc1QzU4Ljk4NDYgOC43NzUgNTguNTQzIDguOTkxNjcgNTguMjQzIDkuMzI1QzU3Ljk0MyA5LjY0MTY3IDU3Ljc5MyAxMC4xNTgzIDU3Ljc5MyAxMC44NzVWMTVINTQuMjkzWiIgZmlsbD0iIzIxMjEzOCIvPgo8cGF0aCBkPSJNMS41IDE5LjVMNTggMTdWMTguNUwxLjUgMjFWMTkuNVoiIGZpbGw9IiMyMTIxMzgiIHN0cm9rZT0iIzIxMjEzOCIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KPC9zdmc+Cg==",alt:"Jotter logo"}),o.createElement(ft,null,"Write and keep notes on your favourite books. "),o.createElement(lt,null))}},7721:function(e,t,r){"use strict";r.r(t);var n=r(7294),o=r(9319),i=r(2352),a=r(4558),s=r(3372),u=r(508),c=r(9694),f=r(4816),h=r(2441);t.default=function e(){var t=(0,a.D3)(),r=t.user,l=t.isAuthenticated,p=t.isLoading,d=(0,n.useState)([]),y=d[0],v=d[1],g=(0,n.useState)(!1),M=g[0],N=g[1];return(0,n.useEffect)((function(){r&&(N(!0),(0,u.av)(r.nickname).then((function(e){v(e),N(!1)})).catch((function(e){console.log(e)})))}),[r]),l&&!p?n.createElement(o.Z,{heading:"Library",subheading:"All your books in one place"},M?n.createElement(h.i,{minHeight:"60vh"},n.createElement(h.g,{minHeight:"50vh",src:i.Z,alt:"Loading icon",className:"rotating"})):n.createElement(s.F,null,y.map((function(e){return n.createElement(s.Z,{key:e.bookTitle+e.cover,isLink:!0,to:"/book/",isbn:e.isbn,shouldHover:!0,cover:e.cover,title:e.bookTitle,author:e.author.join(", "),date:e.year,percentageRead:e.percentageRead})})))):n.createElement(c.Router,null,n.createElement(f.rC,{path:"/",component:e}))}},508:function(e,t,r){"use strict";r.d(t,{av:function(){return c},yy:function(){return f},Jl:function(){return h},Zo:function(){return l},_J:function(){return p},T_:function(){return d}});var n=r(2137),o=r(7757),i=r.n(o),a=r(1070),s=r.n(a),u=r(3092),c=function(){var e=(0,n.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s().get(u.baseurl+"library?user="+t);case 3:return r=e.sent,e.abrupt("return",r.data[0].library);case 7:e.prev=7,e.t0=e.catch(0),console.error("getLibrary error:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,n.Z)(i().mark((function e(t,r,n,o,a,c,f){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s().post(u.baseurl+"add-book-library",null,{params:{user:t,title:r,bookAuthor:n,bookYear:o,bookCover:a,bookAddedDate:c,bookIsbn:f}}).then(console.log("added book to library"))}catch(i){console.error("error (couldn't add book to library):",i.response)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,o,i,a,s){return e.apply(this,arguments)}}(),h=function(){var e=(0,n.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s().get(u.baseurl+"to-read?user="+t);case 3:return r=e.sent,e.abrupt("return",r.data[0].toRead);case 7:e.prev=7,e.t0=e.catch(0),console.error("getToRead error:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.Z)(i().mark((function e(t,r,n,o,a,c,f){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s().post(u.baseurl+"add-book-to-read",null,{params:{user:t,title:r,bookAuthor:n,bookYear:o,bookCover:a,bookAddedDate:c,bookIsbn:f}}).then(console.log("added book to to-read"))}catch(i){console.error("error (couldn't add book to to-read):",i.response)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,o,i,a,s){return e.apply(this,arguments)}}(),p=function(){var e=(0,n.Z)(i().mark((function e(t,r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s().post(u.baseurl+"update-reading",null,{params:{user:t,bookID:r,percentageRead:n}}).then(console.log("Updated percentage read with the value: ",n))}catch(o){console.error("error (Couldn't update percentage read):",o.response)}case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s().get(u.baseurl+"percentageRead?user="+t+"&bookID="+r);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),console.error("getToRead error:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()},2352:function(e,t){"use strict";t.Z="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjQzVDNUM1Ij48cGF0aCBkPSJNMTIsMjJjNS40MjEsMCwxMC00LjU3OSwxMC0xMGgtMmMwLDQuMzM3LTMuNjYzLDgtOCw4cy04LTMuNjYzLTgtOGMwLTQuMzM2LDMuNjYzLTgsOC04VjJDNi41NzksMiwyLDYuNTgsMiwxMiBDMiwxNy40MjEsNi41NzksMjIsMTIsMjJ6Ii8+PC9zdmc+"}}]);
//# sourceMappingURL=59f509b6a16511ab8c359fa46bc0e4a889de91cd-e800cc44e87656d3329c.js.map