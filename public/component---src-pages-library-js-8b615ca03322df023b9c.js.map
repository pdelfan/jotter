{"version":3,"sources":["webpack://jotter/./src/components/Book/LibraryBook.js","webpack://jotter/./src/components/Loading.js","webpack://jotter/./src/components/Routing.js","webpack://jotter/./src/pages/library.js","webpack://jotter/./src/services/realm/API.js","webpack://jotter/./src/assets/loading.svg"],"names":["Book","styled","Info","BookLink","Link","BookItem","isbn","cover","title","author","date","isLink","percentageRead","children","to","ConditionalLink","state","src","alt","className","BookList","Wrapper","props","minHeight","Loading","RedirectHome","component","navigate","RedirectToLibrary","Component","path","rest","useAuth0","loading","isAuthenticated","loginWithRedirect","useEffect","Library","user","isLoading","useState","libraryBooks","setLibraryBooks","isFetching","setIsFetching","getLibrary","nickname","then","response","catch","e","console","log","heading","subheading","LoadingIcon","map","book","key","bookTitle","shouldHover","join","year","Router","username","axios","baseurl","books","data","library","error","addBookToLibrary","addDate","params","bookAuthor","bookYear","bookCover","bookAddedDate","bookIsbn","getToRead","toRead","addBookToToRead","updatePercentageRead","readPercentage","bookID","getPercentageRead"],"mappings":"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","file":"component---src-pages-library-js-8b615ca03322df023b9c.js","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components\";\nimport { Link } from \"gatsby\";\n\nconst Book = styled.div`\n  transition: 0.2s;\n  flex: 0 0 17rem;\n\n  .cover {\n    box-shadow: var(--book-shadow);\n    border: var(--book-border);\n    border-radius: var(--book-round);\n    max-height: 200px;\n  }\n\n  h3 {\n    font-weight: 600;\n    color: var(--book-title);\n    line-height: 1.5rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.3rem;\n  }\n\n  h4 {\n    font-size: 0.8rem;\n    font-weight: 600;\n    color: var(--book-author);\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n  }\n\n  h5 {\n    font-weight: 500;\n    color: var(--book-date);\n    margin-top: 0;\n  }\n`;\n\nconst Info = styled.div`\n  max-width: 14rem;\n  word-wrap: break-word;\n`;\n\nconst BookLink = styled(Link)`\n  transition: 0.2s;\n  flex: 0 1 17rem;\n  margin-bottom: 10rem;\n\n  &:hover {\n    transform: translateY(-0.5rem);\n    transition: 0.2s;\n  }\n`;\n\nexport default function BookItem({\n  isbn,\n  cover,\n  title,\n  author,\n  date,\n  isLink,\n  percentageRead,\n  children,\n  to,\n}) {\n  const ConditionalLink = ({ children, to, isLink }) =>\n    isLink ? (\n      <BookLink to={to} state={{ isbn: isbn, percentageRead: percentageRead }}>\n        {children}\n      </BookLink>\n    ) : (\n      <>{children}</>\n    );\n\n  return (\n    <ConditionalLink isLink={isLink} to={to}>\n      <Book>\n        <img src={cover} alt=\"Book cover\" className=\"cover\" />\n        <Info>\n          <h3>{title}</h3>\n          <h4>{author}</h4>\n          <h5>{date}</h5>\n        </Info>\n        {children}\n      </Book>\n    </ConditionalLink>\n  );\n}\n\nexport const BookList = styled.div`\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  margin-top: 5rem;\n`;\n","import styled from \"styled-components\";\n\nexport const Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: ${(props) => props.minHeight || \"50rem\"};\n`;\n\nexport const Loading = styled.img`\n  width: 8rem;\n  margin: 1rem auto 1rem auto;\n  -webkit-animation: spin 4s linear infinite;\n  -moz-animation: spin 4s linear infinite;\n  animation: spin 4s linear infinite;\n  min-height: ${(props) => props.minHeight || \"50rem\"};\n`;\n","import React, { useEffect } from \"react\";\nimport { useAuth0 } from \"../services/auth\";\nimport { navigate } from \"gatsby\";\nimport Library from \"../pages/library\";\n\n// redirect\n\nexport const RedirectHome = ({ component: Component, ...rest }) => {\n  navigate(\"/\");\n  return <Library />;\n};\n\n// redirect if user isn't logged in (authenticated)\n\nexport const RedirectToLibrary = ({ component: Component, path, ...rest }) => {\n  const { loading, isAuthenticated, loginWithRedirect } = useAuth0();\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      return;\n    }\n    navigate(\"/library\");\n  }, [loading, isAuthenticated, loginWithRedirect, path]);\n\n  return isAuthenticated === true ? <Component {...rest} /> : null;\n};\n\nconst PrivateRoute = ({ component: Component, path, ...rest }) => {\n  const { loading, isAuthenticated, loginWithRedirect } = useAuth0();\n\n  useEffect(() => {\n    if (loading || isAuthenticated) {\n      return;\n    }\n    navigate(\"/\");\n  }, [loading, isAuthenticated, loginWithRedirect, path]);\n\n  return isAuthenticated === true ? <Component {...rest} /> : null;\n};\n\nexport default PrivateRoute;\n","import React, { useEffect, useState } from \"react\";\nimport Layout from \"../components/Layout\";\nimport LoadingIcon from \"../assets/loading.svg\";\nimport { useAuth0 } from \"../services/auth\";\nimport BookItem, { BookList } from \"../components/Book/LibraryBook\";\nimport { getLibrary } from \"../services/realm/API\";\nimport { Router } from \"@reach/router\";\nimport { RedirectToLibrary } from \"../components/Routing\";\nimport { Wrapper, Loading } from \"../components/Loading\";\n\nconst Library = () => {\n  const { user, isAuthenticated, isLoading } = useAuth0();\n  const [libraryBooks, setLibraryBooks] = useState([]);\n  const [isFetching, setIsFetching] = useState(false);\n\n  useEffect(() => {\n    if (user) {\n      setIsFetching(true);\n      getLibrary(user.nickname)\n        .then((response) => {\n          setLibraryBooks(response);\n          setIsFetching(false);\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    }\n  }, [user]);\n\n  if (isAuthenticated && !isLoading) {\n    return (\n      <Layout heading=\"Library\" subheading=\"All your books in one place\">\n        {isFetching ? (\n          <Wrapper minHeight=\"60vh\">\n            <Loading\n              minHeight=\"50vh\"\n              src={LoadingIcon}\n              alt=\"Loading icon\"\n              className=\"rotating\"\n            />\n          </Wrapper>\n        ) : (\n          <BookList>\n            {libraryBooks.map((book) => {\n              return (\n                <BookItem\n                  key={book.bookTitle + book.cover}\n                  isLink={true}\n                  to=\"/book/\"\n                  isbn={book.isbn}\n                  shouldHover={true}\n                  cover={book.cover}\n                  title={book.bookTitle}\n                  author={book.author.join(\", \")}\n                  date={book.year}\n                  percentageRead={book.percentageRead}\n                />\n              );\n            })}\n          </BookList>\n        )}\n      </Layout>\n    );\n  } else {\n    return (\n      <Router>\n        <RedirectToLibrary path=\"/\" component={Library} />\n      </Router>\n    );\n  }\n};\n\nexport default Library;\n","import axios from \"axios\";\nimport { baseurl } from \"../../../gatsby-browser\";\n\nexport const getLibrary = async (username) => {\n  try {\n    const books = await axios.get(`${baseurl}library?user=${username}`);\n    return books.data[0].library;\n  } catch (error) {\n    console.error(\"getLibrary error:\", error);\n  }\n};\n\nexport const addBookToLibrary = async (\n  username,\n  bookTitle,\n  author,\n  year,\n  cover,\n  addDate,\n  isbn\n) => {\n  try {\n    axios\n      .post(`${baseurl}add-book-library`, null, {\n        params: {\n          user: username,\n          title: bookTitle,\n          bookAuthor: author,\n          bookYear: year,\n          bookCover: cover,\n          bookAddedDate: addDate,\n          bookIsbn: isbn,\n        },\n      })\n      .then(console.log(\"added book to library\"));\n  } catch (error) {\n    console.error(\"error (couldn't add book to library):\", error.response);\n  }\n};\n\nexport const getToRead = async (username) => {\n  try {\n    const books = await axios.get(`${baseurl}to-read?user=${username}`);\n    return books.data[0].toRead;\n  } catch (error) {\n    console.error(\"getToRead error:\", error);\n  }\n};\n\nexport const addBookToToRead = async (\n  username,\n  bookTitle,\n  author,\n  year,\n  cover,\n  addDate,\n  isbn\n) => {\n  try {\n    axios\n      .post(`${baseurl}add-book-to-read`, null, {\n        params: {\n          user: username,\n          title: bookTitle,\n          bookAuthor: author,\n          bookYear: year,\n          bookCover: cover,\n          bookAddedDate: addDate,\n          bookIsbn: isbn,\n        },\n      })\n      .then(console.log(\"added book to to-read\"));\n  } catch (error) {\n    console.error(\"error (couldn't add book to to-read):\", error.response);\n  }\n};\n\n\nexport const updatePercentageRead = async (\n  username,\n  isbn,\n  readPercentage\n) => {\n  try {\n    axios\n      .post(`${baseurl}update-reading`, null, {\n        params: {\n          user: username,\n          bookID: isbn,\n          percentageRead: readPercentage,\n        },\n      })\n      .then(console.log(\"Updated percentage read with the value: \", readPercentage));\n  } catch (error) {\n    console.error(\"error (Couldn't update percentage read):\", error.response);\n  }\n};\n\n\nexport const getPercentageRead = async (username, isbn) => {\n  try {\n    const percentageRead = await axios.get(`${baseurl}percentageRead?user=${username}&bookID=${isbn}`);\n    return percentageRead.data;\n  } catch (error) {\n    console.error(\"getToRead error:\", error);\n  }\n};","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjQzVDNUM1Ij48cGF0aCBkPSJNMTIsMjJjNS40MjEsMCwxMC00LjU3OSwxMC0xMGgtMmMwLDQuMzM3LTMuNjYzLDgtOCw4cy04LTMuNjYzLTgtOGMwLTQuMzM2LDMuNjYzLTgsOC04VjJDNi41NzksMiwyLDYuNTgsMiwxMiBDMiwxNy40MjEsNi41NzksMjIsMTIsMjJ6Ii8+PC9zdmc+\""],"sourceRoot":""}