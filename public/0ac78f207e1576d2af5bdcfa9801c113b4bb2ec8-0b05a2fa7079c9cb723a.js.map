{"version":3,"sources":["webpack://jotter/./node_modules/core-js/internals/classof.js","webpack://jotter/./node_modules/core-js/internals/create-property.js","webpack://jotter/./node_modules/core-js/internals/function-bind-context.js","webpack://jotter/./node_modules/core-js/internals/get-iterator-method.js","webpack://jotter/./node_modules/core-js/internals/is-array-iterator-method.js","webpack://jotter/./node_modules/core-js/internals/iterate.js","webpack://jotter/./node_modules/core-js/internals/iterator-close.js","webpack://jotter/./node_modules/core-js/internals/iterators.js","webpack://jotter/./node_modules/core-js/internals/to-string-tag-support.js","webpack://jotter/./node_modules/core-js/modules/es.object.from-entries.js","webpack://jotter/./src/components/BookItem.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/AwaitValue.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/AsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js","webpack://jotter/./node_modules/@babel/runtime/helpers/esm/asyncIterator.js","webpack://jotter/./node_modules/realm-web/dist/bundle.dom.es.js","webpack://jotter/./src/services/realm/userAuth.js","webpack://jotter/./src/assets/plus.svg","webpack://jotter/./src/components/Buttons.js","webpack://jotter/./src/components/Headings.js","webpack://jotter/./src/services/realm/API.js","webpack://jotter/./src/assets/loading.svg"],"names":["TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","CORRECT_ARGUMENTS","arguments","module","exports","it","O","tag","result","undefined","key","error","tryGet","Object","callee","toPrimitive","definePropertyModule","createPropertyDescriptor","object","value","propertyKey","f","aFunction","fn","that","length","call","a","b","c","apply","classof","Iterators","ITERATOR","ArrayPrototype","Array","prototype","anObject","isArrayIteratorMethod","toLength","bind","getIteratorMethod","iteratorClose","Result","stopped","this","iterable","unboundFunction","options","iterator","iterFn","index","next","step","AS_ENTRIES","IS_ITERATOR","INTERRUPTED","stop","condition","callFn","TypeError","done","returnMethod","test","String","$","iterate","createProperty","target","stat","fromEntries","obj","k","v","Book","styled","props","hover","Info","ConditionalLink","children","to","isLink","Link","BookItem","cover","title","author","date","shouldHover","src","alt","className","BookList","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","e","_construct","Parent","args","Class","push","instance","Function","_wrapNativeSuper","_cache","Map","toString","indexOf","has","get","set","Wrapper","constructor","create","enumerable","writable","configurable","_inherits","subClass","superClass","_possibleConstructorReturn","self","ReferenceError","_slicedToArray","arr","i","isArray","_i","Symbol","_s","_e","_arr","_n","_d","err","unsupportedIterableToArray","_objectWithoutProperties","source","excluded","objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_classCallCheck","Constructor","_defineProperties","descriptor","defineProperty","_createClass","protoProps","staticProps","_AwaitValue","wrapped","_awaitAsyncGenerator","AsyncGenerator","gen","front","back","resume","arg","wrappedAwait","Promise","resolve","then","settle","type","reject","_invoke","request","_wrapAsyncGenerator","_asyncIterator","method","asyncIterator","_DATA_MAPPING","_createForOfIteratorHelper","allowArrayLike","minLen","_arrayLikeToArray","n","slice","name","from","_unsupportedIterableToArray","F","s","normalCompletion","didErr","_e2","return","len","arr2","_createSuper","Derived","hasNativeReflectConstruct","Super","NewTarget","ownKeys","enumerableOnly","keys","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","forEach","getOwnPropertyDescriptors","defineProperties","__spreadArrays","il","r","j","jl","BrowserInfo","version","os","NodeInfo","process","platform","SearchBotDeviceInfo","bot","BotInfo","ReactNativeInfo","SEARCHBOT_OS_REGEX","userAgentRules","operatingSystemRules","parseUserAgent","ua","matchedRule","reduce","matched","_a","browser","regex","uaMatch","exec","matchUserAgent","match","versionParts","split","count","output","ii","createVersionParts","join","detectOS","searchBotMatch","DefaultNetworkTransport","fetch","Error","AbortController","_fetch","handler","_ref","_callee","response","decodedBody","responseHeaders","_context","prev","text","sent","headers","abrupt","statusCode","status","body","_x","onSuccess","catch","onError","_callee2","timeoutMs","url","rest","_this$createTimeoutSi","signal","cancelTimeout","_context2","createTimeoutSignal","finish","_x2","controller","timeout","setTimeout","abort","clearTimeout","DEFAULT_HEADERS","window","commonjsGlobal","globalThis","g","basedir","UserType","DataKey","base64","global","fromUint8Array","_Base64","Base64","b64chars","b64tab","bin","t","l","charAt","fromCharCode","cb_utob","cc","charCodeAt","re_utob","utob","u","replace","cb_encode","ccc","padlen","ord","btoa","RangeError","_encode","mkUriSafe","b64","m0","encode","urisafe","encodeURI","Uint8Array","a0","a1","a2","toUint8Array","re_btou","cb_btou","cccc","offset","btou","cb_decode","chars","_atob","atob","_decode","_fromURI","decode","noConflict","VERSION","fromBase64","toBase64","noEnum","extendString","factory","path","require","base","commonjsRequire","SERIALIZATION_OPTIONS","relaxed","serialize","deserialize","map","doc","DATA_MAPPING","NAME","EMAIL","PICTURE","FIRST_NAME","LAST_NAME","GENDER","BIRTHDAY","MIN_AGE","MAX_AGE","UserProfile","Normal","identities","data","identity","id","providerType","mappedData","entries","_ref2","_ref3","PrefixedStorage","storage","keyPart","PART_SEPARATOR","remove","prefix","clear","listener","addListener","ACCESS_TOKEN_STORAGE_KEY","REFRESH_TOKEN_STORAGE_KEY","PROFILE_STORAGE_KEY","PROVIDER_TYPE_STORAGE_KEY","UserStorage","_PrefixedStorage","_super","userId","concat","profile","assign","JSON","parse","stringify","removeKeysWithUndefinedValues","entry","encodeQueryString","params","prefixed","cleanedParams","_ref4","_ref5","encodeURIComponent","RESERVED_NAMES","getOwnPropertyNames","cleanArgsAndSerialize","_step2","_iterator2","_Object$entries","_Object$entries$_i","cleanArgs","FunctionsFactory","fetcher","config","serviceName","argsTransformation","_callFunction","_callee3","_len","_key","appRoute","_args3","_context3","service","fetchJSON","functionsCall","_x3","_len2","_key2","qs","fetchStream","p","receiver","callFunction","prop","EmailPasswordAuth","providerName","_callResetPasswordFunction","_sendResetPasswordEmail","_resetPassword","_resendConfirmationEmail","_confirmUser","_registerUser","_callee4","email","password","_context4","emailPasswordAuth","register","_x4","_x5","_callee5","token","tokenId","_context5","confirm","_x6","_x7","_callee6","_context6","confirmSend","_x8","_callee7","_context7","reset","_x9","_x10","_x11","_callee8","_context8","resetSend","_x12","_callee9","_len3","_key3","_args9","_context9","resetCall","_x13","_x14","routes","api","app","appId","location","authProvider","login","auth","apiKeys","enable","disable","session","ApiKeyAuth","_disable","_enable","_delete2","tokenType","keyId","_callee10","_context10","_x15","_callee11","_context11","_x16","_callee12","_context12","_x17","environment","getEnvironment","WatchStreamState","WatchError","_Error","_super2","_ref8","_this2","message","code","WatchStream","_state","NEED_DATA","_error","_textDecoder","_buffer","_bufferOffset","_eventType","_dataBuffer","buffer","assertState","stream","advanceBufferState","line","endsWith","substr","feedSse","eventType","colon","field","startsWith","sse","firstPercentIndex","start","percentIndex","encoded","HAVE_ERROR","_EJSON$parse","errorCode","error_code","_unused2","parsed","_nextEvent","HAVE_EVENT","_unused","out","state","nextNewlineIndex","feedLine","MongoDBCollection","databaseName","collectionName","functions","find","database","collection","query","project","projection","sort","limit","findOne","update","findOneAndUpdate","upsert","returnNewDocument","replacement","findOneAndReplace","pipeline","aggregate","document","insertOne","documents","insertMany","deleteOne","deleteMany","updateOne","updateMany","_this","_ref9","ids","_callee13","watchStream","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_value","chunk","_context13","callFunctionStreaming","feedBuffer","nextEvent","t0","createCollection","createDatabase","UserState","UserType$1","User","parameters","_accessToken","accessToken","_refreshToken","refreshToken","_profile","clone","userContext","currentUser","_refreshCustomData","_refreshAccessToken","_linkCredentials","_logOut","_refreshProfile","allUsers","LoggedOut","Active","Removed","decodeAccessToken","userData","payload","deviceId","_callee14","_context14","_callee15","_context15","_callee16","credentials","details","_context16","authenticator","authenticate","refreshProfile","_x18","_callee17","_context17","access_token","_callee18","_context18","refreshAccessToken","customData","_this$functions","_len4","_key4","db","createService","parts","encodedPayload","decodedPayload","parsedPayload","expires","exp","issuedAt","iat","subject","sub","_parsedPayload$user_d","user_data","Credentials","username","derivePayload","includes","redirectUrl","authCode","idToken","id_token","redirectUrlOrAccessToken","redirectUrlOrIdToken","USER_IDS_STORAGE_KEY","DEVICE_ID_STORAGE_KEY","AppStorage","_PrefixedStorage2","_super3","userIdsString","userIds","Set","mergeWithExisting","_step3","_iterator3","getUserIds","setUserIds","REDIRECT_HASH_TO_RESULT","_stitch_client_app_id","_baas_client_app_id","_stitch_ua","_baas_ua","_stitch_link","_baas_link","_stitch_error","_baas_error","_stitch_state","_baas_state","OAuth2Helper","openWindow","_this3","stateStorage","getStateStorage","windowClosedInterval","redirectWindow","handleStorageUpdate","parsedResult","removeListener","clearInterval","close","console","warn","setInterval","closed","alphabet","Math","floor","random","generateRandomString","queryString","str","cleanStr","kvp","_ref6","_ref7","decodeURIComponent","_i2","_Object$entries2","_Object$entries2$_i","defaultStorage","parseRedirectLocation","oauth2Storage","authInfo","_parts","REDIRECT_LOCATION_HEADER","Authenticator","getDeviceInformation","oauth2","_openWindowAndWaitForAuthResponse","_getLogInUrl","_authenticate","_callee19","linkingUser","deviceInformation","isLinking","logInUrl","_response","_response$refresh_tok","_context19","generateState","getLogInUrl","redirect","providerRedirectHeader","device","user","mode","openWindowAndWaitForAuthResponse","toJSON","user_id","refresh_token","device_id","_x19","_x20","_callee20","link","extraQueryParams","loginRoute","locationUrl","_args20","_context20","_x21","_callee21","redirectResult","_context21","openWindowAndWaitForRedirect","decodeAuthInfo","userAuth","_x22","_x23","MongoDBRealmError","_Error2","_fromRequestAndResponse","_super4","statusText","_this4","summary","_callee22","_context22","json","_x24","_x25","asyncIteratorFromResponseBody","reader","getReader","read","_callee23","_context23","cancel","DeviceFields","Fetcher","_ref11","transport","locationUrlContext","_fetchStream","_fetchJSON","_fetch2","_callee24","_request$tokenType","_request$user","restOfRequest","_url","_context24","t1","buildAuthorizationHeader","ok","fromRequestAndResponse","_x26","_callee25","serializedBody","contentTypeHeaders","contentType","responseBody","_context25","buildBody","buildJsonHeader","Accept","_x27","_callee26","_yield$this$fetch","_context26","_x28","Authorization","log","DEVICE_ID_STORAGE_KEY$1","DeviceInformation","_ref12","appVersion","sdkVersion","platformVersion","App","idOrConfiguration","_this5","users","_locationUrl","configuration","baseUrl","localApp","_configuration$transp","baseStorage","hydrate","_removeUser","_logIn","nextUser","findIndex","splice","unshift","_callee27","fetchProfile","_args27","_context27","createOrUpdateUser","switchUser","_x29","_callee28","_context28","logOut","removeUserId","_x30","activeUsers","_this6","_ref13","hostname","deviceIdStr","getDeviceId","existingUser","_this7","appCache","userAgent","LocalStorage","localStorage","getItem","setItem","removeItem","_i3","_keys","_key5","addEventListener","removeEventListener","navigator","product","environment$1","open","TextDecoder","Realm","apiKey","MDB_AUTH_USER","logIn","LoginBtn","LoginButton","loginWithRedirect","useAuth0","handleSignIn","Login","onClick","AddSign","AddBtn","AddToLibraryButton","handleAddToLibrary","PlusIcon","ToReadBtn","AddToReadButton","MainHeader","SubHeader","Heading","SubHeading","getLibrary","axios","baseurl","books","library","addBooktoLibrary","bookTitle","year","addDate","isbn","bookAuthor","bookYear","bookCover","bookAddedDate","bookIsbn"],"mappings":"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","file":"0ac78f207e1576d2af5bdcfa9801c113b4bb2ec8-0b05a2fa7079c9cb723a.js","sourcesContent":["var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var classof = require('../internals/classof');\nvar Iterators = require('../internals/iterators');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar Iterators = require('../internals/iterators');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar ArrayPrototype = Array.prototype;\n\n// check on default Array iterator\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);\n};\n","var anObject = require('../internals/an-object');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar iteratorClose = require('../internals/iterator-close');\n\nvar Result = function (stopped, result) {\n  this.stopped = stopped;\n  this.result = result;\n};\n\nmodule.exports = function (iterable, unboundFunction, options) {\n  var that = options && options.that;\n  var AS_ENTRIES = !!(options && options.AS_ENTRIES);\n  var IS_ITERATOR = !!(options && options.IS_ITERATOR);\n  var INTERRUPTED = !!(options && options.INTERRUPTED);\n  var fn = bind(unboundFunction, that, 1 + AS_ENTRIES + INTERRUPTED);\n  var iterator, iterFn, index, length, result, next, step;\n\n  var stop = function (condition) {\n    if (iterator) iteratorClose(iterator);\n    return new Result(true, condition);\n  };\n\n  var callFn = function (value) {\n    if (AS_ENTRIES) {\n      anObject(value);\n      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);\n    } return INTERRUPTED ? fn(value, stop) : fn(value);\n  };\n\n  if (IS_ITERATOR) {\n    iterator = iterable;\n  } else {\n    iterFn = getIteratorMethod(iterable);\n    if (typeof iterFn != 'function') throw TypeError('Target is not iterable');\n    // optimisation for array iterators\n    if (isArrayIteratorMethod(iterFn)) {\n      for (index = 0, length = toLength(iterable.length); length > index; index++) {\n        result = callFn(iterable[index]);\n        if (result && result instanceof Result) return result;\n      } return new Result(false);\n    }\n    iterator = iterFn.call(iterable);\n  }\n\n  next = iterator.next;\n  while (!(step = next.call(iterator)).done) {\n    try {\n      result = callFn(step.value);\n    } catch (error) {\n      iteratorClose(iterator);\n      throw error;\n    }\n    if (typeof result == 'object' && result && result instanceof Result) return result;\n  } return new Result(false);\n};\n","var anObject = require('../internals/an-object');\n\nmodule.exports = function (iterator) {\n  var returnMethod = iterator['return'];\n  if (returnMethod !== undefined) {\n    return anObject(returnMethod.call(iterator)).value;\n  }\n};\n","module.exports = {};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { Link } from \"gatsby\";\n\nconst Book = styled.div`\n  /* transition: 0.2s; */\n  flex: 0 0 17rem;\n  margin-bottom: 5rem;\n\n  .cover {\n    box-shadow: var(--book-shadow);\n    border: var(--general-border);\n    max-height: 200px;\n  }\n\n  h3 {\n    font-weight: 600;\n    color: var(--book-title);\n    line-height: 1.5rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.3rem;\n  }\n\n  h4 {\n    font-size: 0.8rem;\n    font-weight: 600;\n    color: var(--book-author);\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n  }\n\n  h5 {\n    font-weight: 500;\n    color: var(--book-date);\n    margin-top: 0;\n  }\n\n  ${(props) =>\n    props.hover\n      ? `&:hover {\n    transform: scale(1.05);\n    transition: 0.2s;\n  }`\n      : \"\"}\n`;\n\nconst Info = styled.div`\n  max-width: 14rem;\n  word-wrap: break-word;\n`;\n\nconst ConditionalLink = ({ children, to, isLink }) =>\n  isLink ? <Link to={to}>{children}</Link> : <>{children}</>;\n\nexport default function BookItem({\n  cover,\n  title,\n  author,\n  date,\n  isLink,\n  shouldHover,\n  children,\n}) {\n  return (\n    <Book hover={shouldHover}>\n      <ConditionalLink isLink={isLink} to=\"/library-book\">\n        <img src={cover} alt=\"Book cover\" className=\"cover\" />\n        <Info>\n          <h3>{title}</h3>\n          <h4>{author}</h4>\n          <h5>{date}</h5>\n        </Info>\n        {children}\n      </ConditionalLink>\n    </Book>\n  );\n}\n\nexport const BookList = styled.div`\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  margin-top: 5rem;\n`;\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _AwaitValue(value) {\n  this.wrapped = value;\n}","import AwaitValue from \"./AwaitValue.js\";\nexport default function _awaitAsyncGenerator(value) {\n  return new AwaitValue(value);\n}","import AwaitValue from \"./AwaitValue.js\";\nexport default function AsyncGenerator(gen) {\n  var front, back;\n\n  function send(key, arg) {\n    return new Promise(function (resolve, reject) {\n      var request = {\n        key: key,\n        arg: arg,\n        resolve: resolve,\n        reject: reject,\n        next: null\n      };\n\n      if (back) {\n        back = back.next = request;\n      } else {\n        front = back = request;\n        resume(key, arg);\n      }\n    });\n  }\n\n  function resume(key, arg) {\n    try {\n      var result = gen[key](arg);\n      var value = result.value;\n      var wrappedAwait = value instanceof AwaitValue;\n      Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n        if (wrappedAwait) {\n          resume(key === \"return\" ? \"return\" : \"next\", arg);\n          return;\n        }\n\n        settle(result.done ? \"return\" : \"normal\", arg);\n      }, function (err) {\n        resume(\"throw\", err);\n      });\n    } catch (err) {\n      settle(\"throw\", err);\n    }\n  }\n\n  function settle(type, value) {\n    switch (type) {\n      case \"return\":\n        front.resolve({\n          value: value,\n          done: true\n        });\n        break;\n\n      case \"throw\":\n        front.reject(value);\n        break;\n\n      default:\n        front.resolve({\n          value: value,\n          done: false\n        });\n        break;\n    }\n\n    front = front.next;\n\n    if (front) {\n      resume(front.key, front.arg);\n    } else {\n      back = null;\n    }\n  }\n\n  this._invoke = send;\n\n  if (typeof gen[\"return\"] !== \"function\") {\n    this[\"return\"] = undefined;\n  }\n}\n\nAsyncGenerator.prototype[typeof Symbol === \"function\" && Symbol.asyncIterator || \"@@asyncIterator\"] = function () {\n  return this;\n};\n\nAsyncGenerator.prototype.next = function (arg) {\n  return this._invoke(\"next\", arg);\n};\n\nAsyncGenerator.prototype[\"throw\"] = function (arg) {\n  return this._invoke(\"throw\", arg);\n};\n\nAsyncGenerator.prototype[\"return\"] = function (arg) {\n  return this._invoke(\"return\", arg);\n};","import AsyncGenerator from \"./AsyncGenerator.js\";\nexport default function _wrapAsyncGenerator(fn) {\n  return function () {\n    return new AsyncGenerator(fn.apply(this, arguments));\n  };\n}","export default function _asyncIterator(iterable) {\n  var method;\n\n  if (typeof Symbol !== \"undefined\") {\n    if (Symbol.asyncIterator) method = iterable[Symbol.asyncIterator];\n    if (method == null && Symbol.iterator) method = iterable[Symbol.iterator];\n  }\n\n  if (method == null) method = iterable[\"@@asyncIterator\"];\n  if (method == null) method = iterable[\"@@iterator\"];\n  if (method == null) throw new TypeError(\"Object is not async iterable\");\n  return method.call(iterable);\n}","import _wrapNativeSuper from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _toConsumableArray from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _inherits from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _awaitAsyncGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator\";\nimport _wrapAsyncGenerator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator\";\nimport _asyncIterator from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/helpers/esm/asyncIterator\";\n\nvar _DATA_MAPPING;\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport \"core-js/modules/es.object.from-entries.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"/Users/pouria/Documents/GitHub/jotter/node_modules/@babel/runtime/regenerator\";\nimport { EJSON, ObjectId } from 'bson';\nimport * as bson from 'bson';\nexport { bson as BSON };\n\nvar __spreadArrays = undefined && undefined.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nvar BrowserInfo =\n/** @class */\nfunction () {\n  function BrowserInfo(name, version, os) {\n    this.name = name;\n    this.version = version;\n    this.os = os;\n    this.type = 'browser';\n  }\n\n  return BrowserInfo;\n}();\n\nvar NodeInfo =\n/** @class */\nfunction () {\n  function NodeInfo(version) {\n    this.version = version;\n    this.type = 'node';\n    this.name = 'node';\n    this.os = process.platform;\n  }\n\n  return NodeInfo;\n}();\n\nvar SearchBotDeviceInfo =\n/** @class */\nfunction () {\n  function SearchBotDeviceInfo(name, version, os, bot) {\n    this.name = name;\n    this.version = version;\n    this.os = os;\n    this.bot = bot;\n    this.type = 'bot-device';\n  }\n\n  return SearchBotDeviceInfo;\n}();\n\nvar BotInfo =\n/** @class */\nfunction () {\n  function BotInfo() {\n    this.type = 'bot';\n    this.bot = true; // NOTE: deprecated test name instead\n\n    this.name = 'bot';\n    this.version = null;\n    this.os = null;\n  }\n\n  return BotInfo;\n}();\n\nvar ReactNativeInfo =\n/** @class */\nfunction () {\n  function ReactNativeInfo() {\n    this.type = 'react-native';\n    this.name = 'react-native';\n    this.version = null;\n    this.os = null;\n  }\n\n  return ReactNativeInfo;\n}(); // tslint:disable-next-line:max-line-length\n\n\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\\ Jeeves\\/Teoma|ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [['aol', /AOLShield\\/([0-9\\._]+)/], ['edge', /Edge\\/([0-9\\._]+)/], ['edge-ios', /EdgiOS\\/([0-9\\._]+)/], ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/], ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/], ['samsung', /SamsungBrowser\\/([0-9\\.]+)/], ['silk', /\\bSilk\\/([0-9._-]+)\\b/], ['miui', /MiuiBrowser\\/([0-9\\.]+)$/], ['beaker', /BeakerBrowser\\/([0-9\\.]+)/], ['edge-chromium', /Edg\\/([0-9\\.]+)/], ['chromium-webview', /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/], ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/], ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/], ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/], ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/], ['fxios', /FxiOS\\/([0-9\\.]+)/], ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/], ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/], ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/], ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/], ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/], ['ie', /MSIE\\s(7\\.0)/], ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/], ['android', /Android\\s([0-9\\.]+)/], ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/], ['safari', /Version\\/([0-9\\._]+).*Safari/], ['facebook', /FBAV\\/([0-9\\.]+)/], ['instagram', /Instagram\\s([0-9\\.]+)/], ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/], ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/], ['searchbot', SEARCHBOX_UA_REGEX]];\nvar operatingSystemRules = [['iOS', /iP(hone|od|ad)/], ['Android OS', /Android/], ['BlackBerry OS', /BlackBerry|BB10/], ['Windows Mobile', /IEMobile/], ['Amazon OS', /Kindle/], ['Windows 3.11', /Win16/], ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/], ['Windows 98', /(Windows 98)|(Win98)/], ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/], ['Windows XP', /(Windows NT 5.1)|(Windows XP)/], ['Windows Server 2003', /(Windows NT 5.2)/], ['Windows Vista', /(Windows NT 6.0)/], ['Windows 7', /(Windows NT 6.1)/], ['Windows 8', /(Windows NT 6.2)/], ['Windows 8.1', /(Windows NT 6.3)/], ['Windows 10', /(Windows NT 10.0)/], ['Windows ME', /Windows ME/], ['Open BSD', /OpenBSD/], ['Sun OS', /SunOS/], ['Chrome OS', /CrOS/], ['Linux', /(Linux)|(X11)/], ['Mac OS', /(Mac_PowerPC)|(Macintosh)/], ['QNX', /QNX/], ['BeOS', /BeOS/], ['OS/2', /OS\\/2/]];\n\nfunction detect(userAgent) {\n  if (!!userAgent) {\n    return parseUserAgent(userAgent);\n  }\n\n  if (typeof document === 'undefined' && typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    return new ReactNativeInfo();\n  }\n\n  if (typeof navigator !== 'undefined') {\n    return parseUserAgent(navigator.userAgent);\n  }\n\n  return getNodeVersion();\n}\n\nfunction matchUserAgent(ua) {\n  // opted for using reduce here rather than Array#first with a regex.test call\n  // this is primarily because using the reduce we only perform the regex\n  // execution once rather than once for the test and for the exec again below\n  // probably something that needs to be benchmarked though\n  return ua !== '' && userAgentRules.reduce(function (matched, _a) {\n    var browser = _a[0],\n        regex = _a[1];\n\n    if (matched) {\n      return matched;\n    }\n\n    var uaMatch = regex.exec(ua);\n    return !!uaMatch && [browser, uaMatch];\n  }, false);\n}\n\nfunction parseUserAgent(ua) {\n  var matchedRule = matchUserAgent(ua);\n\n  if (!matchedRule) {\n    return null;\n  }\n\n  var name = matchedRule[0],\n      match = matchedRule[1];\n\n  if (name === 'searchbot') {\n    return new BotInfo();\n  }\n\n  var versionParts = match[1] && match[1].split(/[._]/).slice(0, 3);\n\n  if (versionParts) {\n    if (versionParts.length < REQUIRED_VERSION_PARTS) {\n      versionParts = __spreadArrays(versionParts, createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length));\n    }\n  } else {\n    versionParts = [];\n  }\n\n  var version = versionParts.join('.');\n  var os = detectOS(ua);\n  var searchBotMatch = SEARCHBOT_OS_REGEX.exec(ua);\n\n  if (searchBotMatch && searchBotMatch[1]) {\n    return new SearchBotDeviceInfo(name, version, os, searchBotMatch[1]);\n  }\n\n  return new BrowserInfo(name, version, os);\n}\n\nfunction detectOS(ua) {\n  for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n    var _a = operatingSystemRules[ii],\n        os = _a[0],\n        regex = _a[1];\n    var match = regex.exec(ua);\n\n    if (match) {\n      return os;\n    }\n  }\n\n  return null;\n}\n\nfunction getNodeVersion() {\n  var isNode = typeof process !== 'undefined' && process.version;\n  return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\n\nfunction createVersionParts(count) {\n  var output = [];\n\n  for (var ii = 0; ii < count; ii++) {\n    output.push('0');\n  }\n\n  return output;\n} ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar DefaultNetworkTransport = /*#__PURE__*/function () {\n  function DefaultNetworkTransport() {\n    _classCallCheck(this, DefaultNetworkTransport);\n\n    if (!DefaultNetworkTransport.fetch) {\n      throw new Error(\"DefaultNetworkTransport.fetch must be set before it's used\");\n    }\n\n    if (!DefaultNetworkTransport.AbortController) {\n      throw new Error(\"DefaultNetworkTransport.AbortController must be set before it's used\");\n    }\n  }\n\n  _createClass(DefaultNetworkTransport, [{\n    key: \"fetchWithCallbacks\",\n    value: function fetchWithCallbacks(request, handler) {\n      // tslint:disable-next-line: no-console\n      this.fetch(request).then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(response) {\n          var decodedBody, responseHeaders;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return response.text();\n\n                case 2:\n                  decodedBody = _context.sent;\n                  // Pull out the headers of the response\n                  responseHeaders = {};\n                  response.headers.forEach(function (value, key) {\n                    responseHeaders[key] = value;\n                  });\n                  return _context.abrupt(\"return\", {\n                    statusCode: response.status,\n                    headers: responseHeaders,\n                    body: decodedBody\n                  });\n\n                case 6:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).then(function (r) {\n        return handler.onSuccess(r);\n      }).catch(function (e) {\n        return handler.onError(e);\n      });\n    }\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(request) {\n        var timeoutMs, url, rest, _this$createTimeoutSi, signal, cancelTimeout;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                timeoutMs = request.timeoutMs, url = request.url, rest = _objectWithoutProperties(request, [\"timeoutMs\", \"url\"]);\n                _this$createTimeoutSi = this.createTimeoutSignal(timeoutMs), signal = _this$createTimeoutSi.signal, cancelTimeout = _this$createTimeoutSi.cancelTimeout;\n                _context2.prev = 2;\n                _context2.next = 5;\n                return DefaultNetworkTransport.fetch(url, _objectSpread({\n                  signal: signal\n                }, rest));\n\n              case 5:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 6:\n                _context2.prev = 6;\n                // Whatever happens, cancel any timeout\n                cancelTimeout();\n                return _context2.finish(6);\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2,, 6, 9]]);\n      }));\n\n      function fetch(_x2) {\n        return _fetch.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"createTimeoutSignal\",\n    value: function createTimeoutSignal(timeoutMs) {\n      if (typeof timeoutMs === \"number\") {\n        var controller = new DefaultNetworkTransport.AbortController(); // Call abort after a specific number of milliseconds\n\n        var timeout = setTimeout(function () {\n          controller.abort();\n        }, timeoutMs);\n        return {\n          signal: controller.signal,\n          cancelTimeout: function cancelTimeout() {\n            clearTimeout(timeout);\n          }\n        };\n      } else {\n        return {\n          signal: undefined,\n          cancelTimeout: function cancelTimeout() {\n            /* No-op */\n          }\n        };\n      }\n    }\n  }]);\n\n  return DefaultNetworkTransport;\n}();\n\nDefaultNetworkTransport.DEFAULT_HEADERS = {\n  \"Content-Type\": \"application/json\"\n}; ////////////////////////////////////////////////////////////////////////////\n\nDefaultNetworkTransport.fetch = window.fetch.bind(window);\nDefaultNetworkTransport.AbortController = window.AbortController;\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, basedir, module) {\n  return module = {\n    path: basedir,\n    exports: {},\n    require: function require(path, base) {\n      return commonjsRequire(path, base === undefined || base === null ? module.path : base);\n    }\n  }, fn(module, module.exports), module.exports;\n}\n\nfunction commonjsRequire() {\n  throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');\n}\n\nvar base64 = createCommonjsModule(function (module, exports) {\n  (function (global, factory) {\n    module.exports = factory(global);\n  })(typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : typeof commonjsGlobal !== 'undefined' ? commonjsGlobal : commonjsGlobal, function (global) {\n    // existing version for noConflict()\n    global = global || {};\n    var _Base64 = global.Base64;\n    var version = \"2.6.4\"; // constants\n\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n    var b64tab = function (bin) {\n      var t = {};\n\n      for (var i = 0, l = bin.length; i < l; i++) {\n        t[bin.charAt(i)] = i;\n      }\n\n      return t;\n    }(b64chars);\n\n    var fromCharCode = String.fromCharCode; // encoder stuff\n\n    var cb_utob = function cb_utob(c) {\n      if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c : cc < 0x800 ? fromCharCode(0xc0 | cc >>> 6) + fromCharCode(0x80 | cc & 0x3f) : fromCharCode(0xe0 | cc >>> 12 & 0x0f) + fromCharCode(0x80 | cc >>> 6 & 0x3f) + fromCharCode(0x80 | cc & 0x3f);\n      } else {\n        var cc = 0x10000 + (c.charCodeAt(0) - 0xD800) * 0x400 + (c.charCodeAt(1) - 0xDC00);\n        return fromCharCode(0xf0 | cc >>> 18 & 0x07) + fromCharCode(0x80 | cc >>> 12 & 0x3f) + fromCharCode(0x80 | cc >>> 6 & 0x3f) + fromCharCode(0x80 | cc & 0x3f);\n      }\n    };\n\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n\n    var utob = function utob(u) {\n      return u.replace(re_utob, cb_utob);\n    };\n\n    var cb_encode = function cb_encode(ccc) {\n      var padlen = [0, 2, 1][ccc.length % 3],\n          ord = ccc.charCodeAt(0) << 16 | (ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8 | (ccc.length > 2 ? ccc.charCodeAt(2) : 0),\n          chars = [b64chars.charAt(ord >>> 18), b64chars.charAt(ord >>> 12 & 63), padlen >= 2 ? '=' : b64chars.charAt(ord >>> 6 & 63), padlen >= 1 ? '=' : b64chars.charAt(ord & 63)];\n      return chars.join('');\n    };\n\n    var btoa = global.btoa && typeof global.btoa == 'function' ? function (b) {\n      return global.btoa(b);\n    } : function (b) {\n      if (b.match(/[^\\x00-\\xFF]/)) throw new RangeError('The string contains invalid characters.');\n      return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n\n    var _encode = function _encode(u) {\n      return btoa(utob(String(u)));\n    };\n\n    var mkUriSafe = function mkUriSafe(b64) {\n      return b64.replace(/[+\\/]/g, function (m0) {\n        return m0 == '+' ? '-' : '_';\n      }).replace(/=/g, '');\n    };\n\n    var encode = function encode(u, urisafe) {\n      return urisafe ? mkUriSafe(_encode(u)) : _encode(u);\n    };\n\n    var encodeURI = function encodeURI(u) {\n      return encode(u, true);\n    };\n\n    var fromUint8Array;\n    if (global.Uint8Array) fromUint8Array = function fromUint8Array(a, urisafe) {\n      // return btoa(fromCharCode.apply(null, a));\n      var b64 = '';\n\n      for (var i = 0, l = a.length; i < l; i += 3) {\n        var a0 = a[i],\n            a1 = a[i + 1],\n            a2 = a[i + 2];\n        var ord = a0 << 16 | a1 << 8 | a2;\n        b64 += b64chars.charAt(ord >>> 18) + b64chars.charAt(ord >>> 12 & 63) + (typeof a1 != 'undefined' ? b64chars.charAt(ord >>> 6 & 63) : '=') + (typeof a2 != 'undefined' ? b64chars.charAt(ord & 63) : '=');\n      }\n\n      return urisafe ? mkUriSafe(b64) : b64;\n    }; // decoder stuff\n\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\n\n    var cb_btou = function cb_btou(cccc) {\n      switch (cccc.length) {\n        case 4:\n          var cp = (0x07 & cccc.charCodeAt(0)) << 18 | (0x3f & cccc.charCodeAt(1)) << 12 | (0x3f & cccc.charCodeAt(2)) << 6 | 0x3f & cccc.charCodeAt(3),\n              offset = cp - 0x10000;\n          return fromCharCode((offset >>> 10) + 0xD800) + fromCharCode((offset & 0x3FF) + 0xDC00);\n\n        case 3:\n          return fromCharCode((0x0f & cccc.charCodeAt(0)) << 12 | (0x3f & cccc.charCodeAt(1)) << 6 | 0x3f & cccc.charCodeAt(2));\n\n        default:\n          return fromCharCode((0x1f & cccc.charCodeAt(0)) << 6 | 0x3f & cccc.charCodeAt(1));\n      }\n    };\n\n    var btou = function btou(b) {\n      return b.replace(re_btou, cb_btou);\n    };\n\n    var cb_decode = function cb_decode(cccc) {\n      var len = cccc.length,\n          padlen = len % 4,\n          n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0) | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0) | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0) | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\n          chars = [fromCharCode(n >>> 16), fromCharCode(n >>> 8 & 0xff), fromCharCode(n & 0xff)];\n      chars.length -= [0, 0, 2, 1][padlen];\n      return chars.join('');\n    };\n\n    var _atob = global.atob && typeof global.atob == 'function' ? function (a) {\n      return global.atob(a);\n    } : function (a) {\n      return a.replace(/\\S{1,4}/g, cb_decode);\n    };\n\n    var atob = function atob(a) {\n      return _atob(String(a).replace(/[^A-Za-z0-9\\+\\/]/g, ''));\n    };\n\n    var _decode = function _decode(a) {\n      return btou(_atob(a));\n    };\n\n    var _fromURI = function _fromURI(a) {\n      return String(a).replace(/[-_]/g, function (m0) {\n        return m0 == '-' ? '+' : '/';\n      }).replace(/[^A-Za-z0-9\\+\\/]/g, '');\n    };\n\n    var decode = function decode(a) {\n      return _decode(_fromURI(a));\n    };\n\n    var toUint8Array;\n    if (global.Uint8Array) toUint8Array = function toUint8Array(a) {\n      return Uint8Array.from(atob(_fromURI(a)), function (c) {\n        return c.charCodeAt(0);\n      });\n    };\n\n    var noConflict = function noConflict() {\n      var Base64 = global.Base64;\n      global.Base64 = _Base64;\n      return Base64;\n    }; // export Base64\n\n\n    global.Base64 = {\n      VERSION: version,\n      atob: atob,\n      btoa: btoa,\n      fromBase64: decode,\n      toBase64: encode,\n      utob: utob,\n      encode: encode,\n      encodeURI: encodeURI,\n      btou: btou,\n      decode: decode,\n      noConflict: noConflict,\n      fromUint8Array: fromUint8Array,\n      toUint8Array: toUint8Array\n    }; // if ES5 is available, make Base64.extendString() available\n\n    if (typeof Object.defineProperty === 'function') {\n      var noEnum = function noEnum(v) {\n        return {\n          value: v,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        };\n      };\n\n      global.Base64.extendString = function () {\n        Object.defineProperty(String.prototype, 'fromBase64', noEnum(function () {\n          return decode(this);\n        }));\n        Object.defineProperty(String.prototype, 'toBase64', noEnum(function (urisafe) {\n          return encode(this, urisafe);\n        }));\n        Object.defineProperty(String.prototype, 'toBase64URI', noEnum(function () {\n          return encode(this, true);\n        }));\n      };\n    } //\n    // export Base64 to the namespace\n    //\n\n\n    if (global['Meteor']) {\n      // Meteor.js\n      Base64 = global.Base64;\n    } // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n\n\n    if (module.exports) {\n      module.exports.Base64 = global.Base64;\n    } // that's it!\n\n\n    return {\n      Base64: global.Base64\n    };\n  });\n}); ////////////////////////////////////////////////////////////////////////////\n\nvar SERIALIZATION_OPTIONS = {\n  relaxed: false\n};\n/**\n * Serialize an object containing BSON types into extended-JSON.\n *\n * @param obj The object containing BSON types.\n * @returns The document in extended-JSON format.\n */\n\nfunction serialize(obj) {\n  return EJSON.serialize(obj, SERIALIZATION_OPTIONS);\n}\n/**\n * De-serialize an object or an array of object from extended-JSON into an object or an array of object with BSON types.\n *\n * @param obj The object or array of objects in extended-JSON format.\n * @returns The object or array of objects with inflated BSON types.\n */\n\n\nfunction deserialize(obj) {\n  if (Array.isArray(obj)) {\n    return obj.map(function (doc) {\n      return EJSON.deserialize(doc);\n    });\n  } else {\n    return EJSON.deserialize(obj);\n  }\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * The type of a user.\n */\n\n\nvar UserType;\n\n(function (UserType) {\n  /**\n   * A normal end-user created this user.\n   */\n  UserType[\"Normal\"] = \"normal\";\n  /**\n   * The user was created by the server.\n   */\n\n  UserType[\"Server\"] = \"server\";\n})(UserType || (UserType = {}));\n/** @ignore */\n\n\nvar DataKey;\n\n(function (DataKey) {\n  /** @ignore */\n  DataKey[\"NAME\"] = \"name\";\n  /** @ignore */\n\n  DataKey[\"EMAIL\"] = \"email\";\n  /** @ignore */\n\n  DataKey[\"PICTURE\"] = \"picture\";\n  /** @ignore */\n\n  DataKey[\"FIRST_NAME\"] = \"first_name\";\n  /** @ignore */\n\n  DataKey[\"LAST_NAME\"] = \"last_name\";\n  /** @ignore */\n\n  DataKey[\"GENDER\"] = \"gender\";\n  /** @ignore */\n\n  DataKey[\"BIRTHDAY\"] = \"birthday\";\n  /** @ignore */\n\n  DataKey[\"MIN_AGE\"] = \"min_age\";\n  /** @ignore */\n\n  DataKey[\"MAX_AGE\"] = \"max_age\";\n})(DataKey || (DataKey = {}));\n\nvar DATA_MAPPING = (_DATA_MAPPING = {}, _defineProperty(_DATA_MAPPING, DataKey.NAME, \"name\"), _defineProperty(_DATA_MAPPING, DataKey.EMAIL, \"email\"), _defineProperty(_DATA_MAPPING, DataKey.PICTURE, \"pictureUrl\"), _defineProperty(_DATA_MAPPING, DataKey.FIRST_NAME, \"firstName\"), _defineProperty(_DATA_MAPPING, DataKey.LAST_NAME, \"lastName\"), _defineProperty(_DATA_MAPPING, DataKey.GENDER, \"gender\"), _defineProperty(_DATA_MAPPING, DataKey.BIRTHDAY, \"birthday\"), _defineProperty(_DATA_MAPPING, DataKey.MIN_AGE, \"minAge\"), _defineProperty(_DATA_MAPPING, DataKey.MAX_AGE, \"maxAge\"), _DATA_MAPPING);\n/** @inheritdoc */\n\nvar UserProfile =\n/**\n * @param response The response of a call fetching the users profile.\n */\nfunction UserProfile(response) {\n  _classCallCheck(this, UserProfile);\n\n  /** @ignore */\n  this.type = UserType.Normal;\n  /** @ignore */\n\n  this.identities = [];\n\n  if (typeof response === \"object\" && response !== null) {\n    var type = response.type,\n        identities = response.identities,\n        data = response.data;\n\n    if (typeof type === \"string\") {\n      this.type = type;\n    } else {\n      throw new Error(\"Expected 'type' in the response body\");\n    }\n\n    if (Array.isArray(identities)) {\n      this.identities = identities.map(function (identity) {\n        return {\n          id: identity.id,\n          providerType: identity[\"provider_type\"]\n        };\n      });\n    } else {\n      throw new Error(\"Expected 'identities' in the response body\");\n    }\n\n    if (typeof data === \"object\" && data !== null) {\n      var mappedData = Object.fromEntries(Object.entries(data).map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n            key = _ref3[0],\n            value = _ref3[1];\n\n        if (key in DATA_MAPPING) {\n          // Translate any known data field to its JS idiomatic alias\n          return [DATA_MAPPING[key], value];\n        } else {\n          // Pass through any other values\n          return [key, value];\n        }\n      })); // We can use `any` since we trust the user supplies the correct type\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      this.data = deserialize(mappedData);\n    } else {\n      throw new Error(\"Expected 'data' in the response body\");\n    }\n  } else {\n    this.data = {};\n  }\n}; ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * A `Storage` which will prefix a key part to every operation.\n */\n\n\nvar PrefixedStorage = /*#__PURE__*/function () {\n  /**\n   * Construct a `Storage` which will prefix a key part to every operation.\n   *\n   * @param storage The underlying storage to use for operations.\n   * @param keyPart The part of the key to prefix when performing operations.\n   */\n  function PrefixedStorage(storage, keyPart) {\n    _classCallCheck(this, PrefixedStorage);\n\n    this.storage = storage;\n    this.keyPart = keyPart;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(PrefixedStorage, [{\n    key: \"get\",\n    value: function get(key) {\n      return this.storage.get(this.keyPart + PrefixedStorage.PART_SEPARATOR + key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      return this.storage.set(this.keyPart + PrefixedStorage.PART_SEPARATOR + key, value);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"remove\",\n    value: function remove(key) {\n      return this.storage.remove(this.keyPart + PrefixedStorage.PART_SEPARATOR + key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"prefix\",\n    value: function prefix(keyPart) {\n      return new PrefixedStorage(this, keyPart);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      return this.storage.clear(this.keyPart + PrefixedStorage.PART_SEPARATOR + prefix);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"addListener\",\n    value: function addListener(listener) {\n      return this.storage.addListener(listener);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(listener) {\n      return this.storage.addListener(listener);\n    }\n  }]);\n\n  return PrefixedStorage;\n}();\n/**\n * The string separating two parts.\n */\n\n\nPrefixedStorage.PART_SEPARATOR = \":\"; ////////////////////////////////////////////////////////////////////////////\n\nvar ACCESS_TOKEN_STORAGE_KEY = \"accessToken\";\nvar REFRESH_TOKEN_STORAGE_KEY = \"refreshToken\";\nvar PROFILE_STORAGE_KEY = \"profile\";\nvar PROVIDER_TYPE_STORAGE_KEY = \"providerType\";\n/**\n * Storage specific to the app.\n */\n\nvar UserStorage = /*#__PURE__*/function (_PrefixedStorage) {\n  _inherits(UserStorage, _PrefixedStorage);\n\n  var _super = _createSuper(UserStorage);\n\n  /**\n   * Construct a storage for a `User`.\n   *\n   * @param storage The underlying storage to wrap.\n   * @param userId The id of the user.\n   */\n  function UserStorage(storage, userId) {\n    _classCallCheck(this, UserStorage);\n\n    return _super.call(this, storage, \"user(\".concat(userId, \")\"));\n  }\n  /**\n   * Get the access token from storage.\n   *\n   * @returns Access token (null if unknown).\n   */\n\n\n  _createClass(UserStorage, [{\n    key: \"accessToken\",\n    get: function get() {\n      return this.get(ACCESS_TOKEN_STORAGE_KEY);\n    }\n    /**\n     * Set the access token in storage.\n     *\n     * @param value Access token (null if unknown).\n     */\n    ,\n    set: function set(value) {\n      if (value === null) {\n        this.remove(ACCESS_TOKEN_STORAGE_KEY);\n      } else {\n        this.set(ACCESS_TOKEN_STORAGE_KEY, value);\n      }\n    }\n    /**\n     * Get the refresh token from storage.\n     *\n     * @returns Refresh token (null if unknown and user is logged out).\n     */\n\n  }, {\n    key: \"refreshToken\",\n    get: function get() {\n      return this.get(REFRESH_TOKEN_STORAGE_KEY);\n    }\n    /**\n     * Set the refresh token in storage.\n     *\n     * @param value Refresh token (null if unknown and user is logged out).\n     */\n    ,\n    set: function set(value) {\n      if (value === null) {\n        this.remove(REFRESH_TOKEN_STORAGE_KEY);\n      } else {\n        this.set(REFRESH_TOKEN_STORAGE_KEY, value);\n      }\n    }\n    /**\n     * Get the user profile from storage.\n     *\n     * @returns User profile (undefined if its unknown).\n     */\n\n  }, {\n    key: \"profile\",\n    get: function get() {\n      var value = this.get(PROFILE_STORAGE_KEY);\n\n      if (value) {\n        var profile = new UserProfile(); // Patch in the values\n\n        Object.assign(profile, JSON.parse(value));\n        return profile;\n      }\n    }\n    /**\n     * Set the user profile in storage.\n     *\n     * @param value User profile (undefined if its unknown).\n     */\n    ,\n    set: function set(value) {\n      if (value) {\n        this.set(PROFILE_STORAGE_KEY, JSON.stringify(value));\n      } else {\n        this.remove(PROFILE_STORAGE_KEY);\n      }\n    }\n    /**\n     * Get the type of authentication provider used to authenticate\n     *\n     * @returns User profile (undefined if its unknown).\n     */\n\n  }, {\n    key: \"providerType\",\n    get: function get() {\n      var value = this.get(PROVIDER_TYPE_STORAGE_KEY);\n\n      if (value) {\n        return value;\n      }\n    }\n    /**\n     * Set the type of authentication provider used to authenticate\n     *\n     * @param value Type of authentication provider.\n     */\n    ,\n    set: function set(value) {\n      if (value) {\n        this.set(PROVIDER_TYPE_STORAGE_KEY, value);\n      } else {\n        this.remove(PROVIDER_TYPE_STORAGE_KEY);\n      }\n    }\n  }]);\n\n  return UserStorage;\n}(PrefixedStorage); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * @param obj The object to remove keys (and undefined values from)\n * @returns A new object without the keys where the value is undefined.\n */\n\n\nfunction removeKeysWithUndefinedValues(obj) {\n  return Object.fromEntries(Object.entries(obj).filter(function (entry) {\n    return typeof entry[1] !== \"undefined\";\n  }));\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Generate a random sequence of characters.\n *\n * @param length The length of the string.\n * @param alphabet The alphabet of characters to pick from.\n * @returns A string of characters picked randomly from `alphabet`.\n */\n\n\nfunction generateRandomString(length, alphabet) {\n  var result = \"\";\n\n  for (var i = 0; i < length; i++) {\n    result += alphabet[Math.floor(Math.random() * alphabet.length)];\n  }\n\n  return result;\n}\n/**\n * Encode an object mapping from string to string, into a query string to be appended a URL.\n *\n * @param params The parameters to include in the string.\n * @param prefixed Should the \"?\" prefix be added if values exists?\n * @returns A URL encoded representation of the parameters (omitting a \"?\" prefix).\n */\n\n\nfunction encodeQueryString(params) {\n  var prefixed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  // Filter out undefined values\n  var cleanedParams = removeKeysWithUndefinedValues(params); // Determine if a prefixed \"?\" is appropreate\n\n  var prefix = prefixed && Object.keys(cleanedParams).length > 0 ? \"?\" : \"\"; // Transform keys and values to a query string\n\n  return prefix + Object.entries(cleanedParams).map(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        k = _ref5[0],\n        v = _ref5[1];\n\n    return \"\".concat(k, \"=\").concat(encodeURIComponent(v));\n  }).join(\"&\");\n}\n/**\n * Decodes a query string into an object.\n *\n * @param str The query string to decode.\n * @returns The decoded query string.\n */\n\n\nfunction decodeQueryString(str) {\n  var cleanStr = str[0] === \"?\" ? str.substr(1) : str;\n  return Object.fromEntries(cleanStr.split(\"&\").filter(function (s) {\n    return s.length > 0;\n  }).map(function (kvp) {\n    return kvp.split(\"=\");\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        k = _ref7[0],\n        v = _ref7[1];\n\n    return [k, decodeURIComponent(v)];\n  }));\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * A list of names that functions cannot have to be callable through the functions proxy.\n */\n\n\nvar RESERVED_NAMES = [\"inspect\", \"callFunction\", \"callFunctionStreaming\"].concat(_toConsumableArray(Object.getOwnPropertyNames(Object.prototype)));\n/**\n * Remove the key for any fields with undefined values.\n *\n * @param args The arguments to clean.\n * @returns The cleaned arguments.\n */\n\nfunction cleanArgs(args) {\n  var _iterator2 = _createForOfIteratorHelper(args),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var arg = _step2.value;\n\n      if (typeof arg === \"object\") {\n        for (var _i = 0, _Object$entries = Object.entries(arg); _i < _Object$entries.length; _i++) {\n          var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n              key = _Object$entries$_i[0],\n              value = _Object$entries$_i[1];\n\n          if (value === undefined) {\n            delete arg[key];\n          }\n        }\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  return args;\n}\n/**\n * Remove keys for any undefined values and serialize to EJSON.\n *\n * @param args The arguments to clean and serialize.\n * @returns The cleaned and serialized arguments.\n */\n\n\nfunction cleanArgsAndSerialize(args) {\n  var cleaned = cleanArgs(args);\n  return cleaned.map(function (arg) {\n    return typeof arg === \"object\" ? serialize(arg) : arg;\n  });\n}\n/**\n * Defines how functions are called.\n */\n\n\nvar FunctionsFactory = /*#__PURE__*/function () {\n  /**\n   * @param fetcher The underlying fetcher to use when sending requests.\n   * @param config Additional configuration parameters.\n   */\n  function FunctionsFactory(fetcher) {\n    var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, FunctionsFactory);\n\n    this.fetcher = fetcher;\n    this.serviceName = config.serviceName;\n    this.argsTransformation = config.argsTransformation || cleanArgsAndSerialize;\n  }\n  /**\n   * Create a factory of functions, wrapped in a Proxy that returns bound copies of `callFunction` on any property.\n   *\n   * @param fetcher The underlying fetcher to use when requesting.\n   * @param config Additional configuration parameters.\n   * @returns The newly created factory of functions.\n   */\n\n\n  _createClass(FunctionsFactory, [{\n    key: \"callFunction\",\n    value:\n    /**\n     * Call a remote function by it's name.\n     *\n     * @param name Name of the remote function.\n     * @param args Arguments to pass to the remote function.\n     * @returns A promise of the value returned when executing the remote function.\n     */\n    function () {\n      var _callFunction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(name) {\n        var _len,\n            args,\n            _key,\n            body,\n            appRoute,\n            _args3 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                for (_len = _args3.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                  args[_key - 1] = _args3[_key];\n                }\n\n                // See https://github.com/mongodb/stitch-js-sdk/blob/master/packages/core/sdk/src/services/internal/CoreStitchServiceClientImpl.ts\n                body = {\n                  name: name,\n                  arguments: this.argsTransformation ? this.argsTransformation(args) : args\n                };\n\n                if (this.serviceName) {\n                  body.service = this.serviceName;\n                }\n\n                appRoute = this.fetcher.appRoute;\n                return _context3.abrupt(\"return\", this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.functionsCall().path,\n                  body: body\n                }));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function callFunction(_x3) {\n        return _callFunction.apply(this, arguments);\n      }\n\n      return callFunction;\n    }()\n    /**\n     * Call a remote function by it's name.\n     *\n     * @param name Name of the remote function.\n     * @param args Arguments to pass to the remote function.\n     * @returns A promise of the value returned when executing the remote function.\n     */\n\n  }, {\n    key: \"callFunctionStreaming\",\n    value: function callFunctionStreaming(name) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      var body = {\n        name: name,\n        arguments: this.argsTransformation ? this.argsTransformation(args) : args\n      };\n\n      if (this.serviceName) {\n        body.service = this.serviceName;\n      }\n\n      var appRoute = this.fetcher.appRoute;\n      var qs = encodeQueryString(_defineProperty({}, \"baas_request\", Base64.encode(JSON.stringify(body))));\n      return this.fetcher.fetchStream({\n        method: \"GET\",\n        path: appRoute.functionsCall().path + qs\n      });\n    }\n  }], [{\n    key: \"create\",\n    value: function create(fetcher) {\n      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      // Create a proxy, wrapping a simple object returning methods that calls functions\n      // TODO: Lazily fetch available functions and return these from the ownKeys() trap\n      var factory = new FunctionsFactory(fetcher, config); // Wrap the factory in a proxy that calls the internal call method\n\n      return new Proxy(factory, {\n        get: function get(target, p, receiver) {\n          if (typeof p === \"string\" && RESERVED_NAMES.indexOf(p) === -1) {\n            return target.callFunction.bind(target, p);\n          } else {\n            var prop = Reflect.get(target, p, receiver);\n            return typeof prop === \"function\" ? prop.bind(target) : prop;\n          }\n        }\n      });\n    }\n  }]);\n\n  return FunctionsFactory;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/** @inheritdoc */\n\n\nvar EmailPasswordAuth = /*#__PURE__*/function () {\n  /**\n   * Construct an interface to the email / password authentication provider.\n   *\n   * @param fetcher The underlying fetcher used to request the services.\n   * @param providerName Optional custom name of the authentication provider.\n   */\n  function EmailPasswordAuth(fetcher) {\n    var providerName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"local-userpass\";\n\n    _classCallCheck(this, EmailPasswordAuth);\n\n    this.fetcher = fetcher;\n    this.providerName = providerName;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(EmailPasswordAuth, [{\n    key: \"registerUser\",\n    value: function () {\n      var _registerUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(email, password) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context4.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).register().path,\n                  body: {\n                    email: email,\n                    password: password\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function registerUser(_x4, _x5) {\n        return _registerUser.apply(this, arguments);\n      }\n\n      return registerUser;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"confirmUser\",\n    value: function () {\n      var _confirmUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(token, tokenId) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context5.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).confirm().path,\n                  body: {\n                    token: token,\n                    tokenId: tokenId\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function confirmUser(_x6, _x7) {\n        return _confirmUser.apply(this, arguments);\n      }\n\n      return confirmUser;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"resendConfirmationEmail\",\n    value: function () {\n      var _resendConfirmationEmail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(email) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context6.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).confirmSend().path,\n                  body: {\n                    email: email\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function resendConfirmationEmail(_x8) {\n        return _resendConfirmationEmail.apply(this, arguments);\n      }\n\n      return resendConfirmationEmail;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"resetPassword\",\n    value: function () {\n      var _resetPassword = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(token, tokenId, password) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context7.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).reset().path,\n                  body: {\n                    token: token,\n                    tokenId: tokenId,\n                    password: password\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function resetPassword(_x9, _x10, _x11) {\n        return _resetPassword.apply(this, arguments);\n      }\n\n      return resetPassword;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"sendResetPasswordEmail\",\n    value: function () {\n      var _sendResetPasswordEmail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(email) {\n        var appRoute;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n                _context8.next = 3;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).resetSend().path,\n                  body: {\n                    email: email\n                  }\n                });\n\n              case 3:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function sendResetPasswordEmail(_x12) {\n        return _sendResetPasswordEmail.apply(this, arguments);\n      }\n\n      return sendResetPasswordEmail;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"callResetPasswordFunction\",\n    value: function () {\n      var _callResetPasswordFunction = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(email, password) {\n        var appRoute,\n            _len3,\n            args,\n            _key3,\n            _args9 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                appRoute = this.fetcher.appRoute;\n\n                for (_len3 = _args9.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n                  args[_key3 - 2] = _args9[_key3];\n                }\n\n                _context9.next = 4;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: appRoute.emailPasswordAuth(this.providerName).resetCall().path,\n                  body: {\n                    email: email,\n                    password: password,\n                    arguments: args\n                  }\n                });\n\n              case 4:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function callResetPasswordFunction(_x13, _x14) {\n        return _callResetPasswordFunction.apply(this, arguments);\n      }\n\n      return callResetPasswordFunction;\n    }()\n  }]);\n\n  return EmailPasswordAuth;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * @returns The base api route.\n */\n\n\nfunction api() {\n  return {\n    path: \"/api/client/v2.0\",\n\n    /**\n     * @param appId The id of the app.\n     * @returns The URL of the app endpoint.\n     */\n    app: function app(appId) {\n      return {\n        path: this.path + \"/app/\".concat(appId),\n\n        /**\n         * @returns The URL of the app location endpoint.\n         */\n        location: function location() {\n          return {\n            path: this.path + \"/location\"\n          };\n        },\n\n        /**\n         * @param providerName The name of the provider.\n         * @returns The app url concatinated with the /auth/providers/{providerName}\n         */\n        authProvider: function authProvider(providerName) {\n          return {\n            path: this.path + \"/auth/providers/\".concat(providerName),\n\n            /**\n             * @returns Get the URL of an authentication provider.\n             */\n            login: function login() {\n              return {\n                path: this.path + \"/login\"\n              };\n            }\n          };\n        },\n\n        /**\n         * @param providerName The name of the provider.\n         * @returns The app url concatinated with the /auth/providers/{providerName}\n         */\n        emailPasswordAuth: function emailPasswordAuth(providerName) {\n          var authProviderRoutes = this.authProvider(providerName);\n          return _objectSpread(_objectSpread({}, authProviderRoutes), {}, {\n            register: function register() {\n              return {\n                path: this.path + \"/register\"\n              };\n            },\n            confirm: function confirm() {\n              return {\n                path: this.path + \"/confirm\"\n              };\n            },\n            confirmSend: function confirmSend() {\n              return {\n                path: this.path + \"/confirm/send\"\n              };\n            },\n            reset: function reset() {\n              return {\n                path: this.path + \"/reset\"\n              };\n            },\n            resetSend: function resetSend() {\n              return {\n                path: this.path + \"/reset/send\"\n              };\n            },\n            resetCall: function resetCall() {\n              return {\n                path: this.path + \"/reset/call\"\n              };\n            }\n          });\n        },\n        functionsCall: function functionsCall() {\n          return {\n            path: this.path + \"/functions/call\"\n          };\n        }\n      };\n    },\n    auth: function auth() {\n      return {\n        path: this.path + \"/auth\",\n        apiKeys: function apiKeys() {\n          return {\n            path: this.path + \"/api_keys\",\n            key: function key(id) {\n              return {\n                path: this.path + \"/\".concat(id),\n                enable: function enable() {\n                  return {\n                    path: this.path + \"/enable\"\n                  };\n                },\n                disable: function disable() {\n                  return {\n                    path: this.path + \"/disable\"\n                  };\n                }\n              };\n            }\n          };\n        },\n        profile: function profile() {\n          return {\n            path: this.path + \"/profile\"\n          };\n        },\n        session: function session() {\n          return {\n            path: this.path + \"/session\"\n          };\n        }\n      };\n    }\n  };\n}\n\nvar routes = {\n  api: api\n}; ////////////////////////////////////////////////////////////////////////////\n\n/** @inheritdoc */\n\nvar ApiKeyAuth = /*#__PURE__*/function () {\n  /**\n   * Construct an interface to the API-key authentication provider.\n   *\n   * @param fetcher The fetcher used to send requests to services.\n   * @param providerName Optional custom name of the authentication provider.\n   */\n  function ApiKeyAuth(fetcher) {\n    var providerName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"api-key\";\n\n    _classCallCheck(this, ApiKeyAuth);\n\n    this.fetcher = fetcher;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(ApiKeyAuth, [{\n    key: \"create\",\n    value: function create(name) {\n      return this.fetcher.fetchJSON({\n        method: \"POST\",\n        body: {\n          name: name\n        },\n        path: routes.api().auth().apiKeys().path,\n        tokenType: \"refresh\"\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"fetch\",\n    value: function fetch(keyId) {\n      return this.fetcher.fetchJSON({\n        method: \"GET\",\n        path: routes.api().auth().apiKeys().key(keyId).path,\n        tokenType: \"refresh\"\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"fetchAll\",\n    value: function fetchAll() {\n      return this.fetcher.fetchJSON({\n        method: \"GET\",\n        tokenType: \"refresh\",\n        path: routes.api().auth().apiKeys().path\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(keyId) {\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"DELETE\",\n                  path: routes.api().auth().apiKeys().key(keyId).path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function _delete(_x15) {\n        return _delete2.apply(this, arguments);\n      }\n\n      return _delete;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(keyId) {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"PUT\",\n                  path: routes.api().auth().apiKeys().key(keyId).enable().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function enable(_x16) {\n        return _enable.apply(this, arguments);\n      }\n\n      return enable;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"disable\",\n    value: function () {\n      var _disable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12(keyId) {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _context12.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"PUT\",\n                  path: routes.api().auth().apiKeys().key(keyId).disable().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function disable(_x17) {\n        return _disable.apply(this, arguments);\n      }\n\n      return disable;\n    }()\n  }]);\n\n  return ApiKeyAuth;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar environment = null;\n/**\n * Set the environment of execution.\n * Note: This should be called as the first thing before executing any code which calls getEnvironment()\n *\n * @param e An object containing environment specific implementations.\n */\n\nfunction setEnvironment(e) {\n  environment = e;\n}\n/**\n * Get the environment of execution.\n *\n * @returns An object containing environment specific implementations.\n */\n\n\nfunction getEnvironment() {\n  if (environment) {\n    return environment;\n  } else {\n    throw new Error(\"Cannot get environment before it's set\");\n  }\n} ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n/**\n * An error occured during the parsing of a watch stream.\n */\n\n\nvar WatchError = /*#__PURE__*/function (_Error) {\n  _inherits(WatchError, _Error);\n\n  var _super2 = _createSuper(WatchError);\n\n  function WatchError(_ref8) {\n    var _this2;\n\n    var message = _ref8.message,\n        code = _ref8.code;\n\n    _classCallCheck(this, WatchError);\n\n    _this2 = _super2.call(this, message);\n    /**\n     * The name of this type of error\n     */\n\n    _this2.name = \"WatchError\";\n    _this2.code = code;\n    return _this2;\n  }\n\n  return WatchError;\n}( /*#__PURE__*/_wrapNativeSuper(Error)); ////////////////////////////////////////////////////////////////////////////\n// NOTE: this is a fully processed event, not a single \"data: foo\" line!\n\n/**\n * The state of a WatchStream.\n */\n\n\nvar WatchStreamState;\n\n(function (WatchStreamState) {\n  /**\n   * Need to call one of the feed functions.\n   */\n  WatchStreamState[\"NEED_DATA\"] = \"NEED_DATA\";\n  /**\n   * Call nextEvent() to consume an event.\n   */\n\n  WatchStreamState[\"HAVE_EVENT\"] = \"HAVE_EVENT\";\n  /**\n   * Call error().\n   */\n\n  WatchStreamState[\"HAVE_ERROR\"] = \"HAVE_ERROR\";\n})(WatchStreamState || (WatchStreamState = {}));\n/**\n * Represents a stream of events\n */\n\n\nvar WatchStream = /*#__PURE__*/function () {\n  function WatchStream() {\n    _classCallCheck(this, WatchStream);\n\n    this._state = WatchStreamState.NEED_DATA;\n    this._error = null; // Used by feedBuffer to construct lines\n\n    this._textDecoder = new (getEnvironment().TextDecoder)();\n    this._buffer = \"\";\n    this._bufferOffset = 0; // Used by feedLine for building the next SSE\n\n    this._eventType = \"\";\n    this._dataBuffer = \"\";\n  } // Call these when you have data, in whatever shape is easiest for your SDK to get.\n  // Pick one, mixing and matching on a single instance isn't supported.\n  // These can only be called in NEED_DATA state, which is the initial state.\n\n\n  _createClass(WatchStream, [{\n    key: \"feedBuffer\",\n    value: function feedBuffer(buffer) {\n      this.assertState(WatchStreamState.NEED_DATA);\n      this._buffer += this._textDecoder.decode(buffer, {\n        stream: true\n      });\n      this.advanceBufferState();\n    }\n  }, {\n    key: \"feedLine\",\n    value: function feedLine(line) {\n      this.assertState(WatchStreamState.NEED_DATA); // This is an implementation of the algorithm described at\n      // https://html.spec.whatwg.org/multipage/server-sent-events.html#event-stream-interpretation.\n      // Currently the server does not use id or retry lines, so that processing isn't implemented.\n      // ignore trailing LF if not removed by SDK.\n\n      if (line.endsWith(\"\\n\")) line = line.substr(0, line.length - 1); // ignore trailing CR from CRLF\n\n      if (line.endsWith(\"\\r\")) line = line.substr(0, line.length - 1);\n\n      if (line.length === 0) {\n        // This is the \"dispatch the event\" portion of the algorithm.\n        if (this._dataBuffer.length === 0) {\n          this._eventType = \"\";\n          return;\n        }\n\n        if (this._dataBuffer.endsWith(\"\\n\")) this._dataBuffer = this._dataBuffer.substr(0, this._dataBuffer.length - 1);\n        this.feedSse({\n          data: this._dataBuffer,\n          eventType: this._eventType\n        });\n        this._dataBuffer = \"\";\n        this._eventType = \"\";\n      }\n\n      if (line[0] === \":\") return;\n      var colon = line.indexOf(\":\");\n      var field = line.substr(0, colon);\n      var value = colon === -1 ? \"\" : line.substr(colon + 1);\n      if (value.startsWith(\" \")) value = value.substr(1);\n\n      if (field === \"event\") {\n        this._eventType = value;\n      } else if (field === \"data\") {\n        this._dataBuffer += value;\n        this._dataBuffer += \"\\n\";\n      } else ;\n    }\n  }, {\n    key: \"feedSse\",\n    value: function feedSse(sse) {\n      this.assertState(WatchStreamState.NEED_DATA);\n      var firstPercentIndex = sse.data.indexOf(\"%\");\n\n      if (firstPercentIndex !== -1) {\n        // For some reason, the stich server decided to add percent-encoding for '%', '\\n', and '\\r' to its\n        // event-stream replies. But it isn't real urlencoding, since most characters pass through, so we can't use\n        // uri_percent_decode() here.\n        var buffer = \"\";\n        var start = 0;\n\n        for (var percentIndex = firstPercentIndex; percentIndex !== -1; percentIndex = sse.data.indexOf(\"%\", start)) {\n          buffer += sse.data.substr(start, percentIndex - start);\n          var encoded = sse.data.substr(percentIndex, 3); // may be smaller than 3 if string ends with %\n\n          if (encoded === \"%25\") {\n            buffer += \"%\";\n          } else if (encoded === \"%0A\") {\n            buffer += \"\\x0A\"; // '\\n'\n          } else if (encoded === \"%0D\") {\n            buffer += \"\\x0D\"; // '\\r'\n          } else {\n            buffer += encoded; // propagate as-is\n          }\n\n          start = percentIndex + encoded.length;\n        } // Advance the buffer with the last part\n\n\n        buffer += sse.data.substr(start);\n        sse.data = buffer;\n      }\n\n      if (!sse.eventType || sse.eventType === \"message\") {\n        try {\n          var parsed = EJSON.parse(sse.data);\n\n          if (typeof parsed === \"object\") {\n            // ???\n            this._nextEvent = parsed;\n            this._state = WatchStreamState.HAVE_EVENT;\n            return;\n          }\n        } catch (_unused) {// fallthrough to same handling as for non-document value.\n        }\n\n        this._state = WatchStreamState.HAVE_ERROR;\n        this._error = new WatchError({\n          message: \"server returned malformed event: \" + sse.data,\n          code: \"bad bson parse\"\n        });\n      } else if (sse.eventType === \"error\") {\n        this._state = WatchStreamState.HAVE_ERROR; // default error message if we have issues parsing the reply.\n\n        this._error = new WatchError({\n          message: sse.data,\n          code: \"unknown\"\n        });\n\n        try {\n          var _EJSON$parse = EJSON.parse(sse.data),\n              errorCode = _EJSON$parse.error_code,\n              error = _EJSON$parse.error;\n\n          if (typeof errorCode !== \"string\") return;\n          if (typeof error !== \"string\") return; // XXX in realm-js, object-store will error if the error_code is not one of the known\n          // error code enum values.\n\n          this._error = new WatchError({\n            message: error,\n            code: errorCode\n          });\n        } catch (_unused2) {\n          return; // Use the default state.\n        }\n      } else ;\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this._state;\n    } // Consumes the returned event. If you used feedBuffer(), there may be another event or error after this one,\n    // so you need to call state() again to see what to do next.\n\n  }, {\n    key: \"nextEvent\",\n    value: function nextEvent() {\n      this.assertState(WatchStreamState.HAVE_EVENT); // We can use \"as ChangeEvent<T>\" since we just asserted the state.\n\n      var out = this._nextEvent;\n      this._state = WatchStreamState.NEED_DATA;\n      this.advanceBufferState();\n      return out;\n    } // Once this enters the error state, it stays that way. You should not feed any more data.\n\n  }, {\n    key: \"error\",\n    get: function get() {\n      return this._error;\n    } ////////////////////////////////////////////\n\n  }, {\n    key: \"advanceBufferState\",\n    value: function advanceBufferState() {\n      this.assertState(WatchStreamState.NEED_DATA);\n\n      while (this.state === WatchStreamState.NEED_DATA) {\n        if (this._bufferOffset === this._buffer.length) {\n          this._buffer = \"\";\n          this._bufferOffset = 0;\n          return;\n        } // NOTE not supporting CR-only newlines, just LF and CRLF.\n\n\n        var nextNewlineIndex = this._buffer.indexOf(\"\\n\", this._bufferOffset);\n\n        if (nextNewlineIndex === -1) {\n          // We have a partial line.\n          if (this._bufferOffset !== 0) {\n            // Slide the partial line down to the front of the buffer.\n            this._buffer = this._buffer.substr(this._bufferOffset, this._buffer.length - this._bufferOffset);\n            this._bufferOffset = 0;\n          }\n\n          return;\n        }\n\n        this.feedLine(this._buffer.substr(this._bufferOffset, nextNewlineIndex - this._bufferOffset));\n        this._bufferOffset = nextNewlineIndex + 1; // Advance past this line, including its newline.\n      }\n    }\n  }, {\n    key: \"assertState\",\n    value: function assertState(state) {\n      if (this._state !== state) {\n        throw Error(\"Expected WatchStream to be in state \".concat(state, \", but in state \").concat(this._state));\n      }\n    }\n  }]);\n\n  return WatchStream;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * A remote collection of documents.\n */\n\n\nvar MongoDBCollection = /*#__PURE__*/function () {\n  /**\n   * Construct a remote collection of documents.\n   *\n   * @param fetcher The fetcher to use when requesting the service.\n   * @param serviceName The name of the remote service.\n   * @param databaseName The name of the database.\n   * @param collectionName The name of the remote collection.\n   */\n  function MongoDBCollection(fetcher, serviceName, databaseName, collectionName) {\n    _classCallCheck(this, MongoDBCollection);\n\n    this.functions = FunctionsFactory.create(fetcher, {\n      serviceName: serviceName\n    });\n    this.databaseName = databaseName;\n    this.collectionName = collectionName;\n    this.serviceName = serviceName;\n    this.fetcher = fetcher;\n  }\n  /** @inheritdoc */\n\n\n  _createClass(MongoDBCollection, [{\n    key: \"find\",\n    value: function find() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.find({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        project: options.projection,\n        sort: options.sort,\n        limit: options.limit\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOne\",\n    value: function findOne() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.findOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        project: options.projection,\n        sort: options.sort\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndUpdate\",\n    value: function findOneAndUpdate() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var update = arguments.length > 1 ? arguments[1] : undefined;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.findOneAndUpdate({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        update: update,\n        sort: options.sort,\n        projection: options.projection,\n        upsert: options.upsert,\n        returnNewDocument: options.returnNewDocument\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndReplace\",\n    value: function findOneAndReplace() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var replacement = arguments.length > 1 ? arguments[1] : undefined;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.findOneAndReplace({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        update: replacement,\n        sort: options.sort,\n        projection: options.projection,\n        upsert: options.upsert,\n        returnNewDocument: options.returnNewDocument\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"findOneAndDelete\",\n    value: function findOneAndDelete() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.findOneAndReplace({\n        database: this.databaseName,\n        collection: this.collectionName,\n        filter: filter,\n        sort: options.sort,\n        projection: options.projection\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"aggregate\",\n    value: function aggregate(pipeline) {\n      return this.functions.aggregate({\n        database: this.databaseName,\n        collection: this.collectionName,\n        pipeline: pipeline\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"count\",\n    value: function count() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.functions.count({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        limit: options.limit\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"insertOne\",\n    value: function insertOne(document) {\n      return this.functions.insertOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        document: document\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"insertMany\",\n    value: function insertMany(documents) {\n      return this.functions.insertMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        documents: documents\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"deleteOne\",\n    value: function deleteOne() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return this.functions.deleteOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"deleteMany\",\n    value: function deleteMany() {\n      var filter = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return this.functions.deleteMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"updateOne\",\n    value: function updateOne(filter, update) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.updateOne({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        update: update,\n        upsert: options.upsert\n      });\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"updateMany\",\n    value: function updateMany(filter, update) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.functions.updateMany({\n        database: this.databaseName,\n        collection: this.collectionName,\n        query: filter,\n        update: update,\n        upsert: options.upsert\n      });\n    }\n  }, {\n    key: \"watch\",\n    value: function watch() {\n      var _this = this;\n\n      var _ref9 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          ids = _ref9.ids,\n          filter = _ref9.filter;\n\n      return _wrapAsyncGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n        var iterator, watchStream, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _value, chunk;\n\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                _context13.next = 2;\n                return _awaitAsyncGenerator(_this.functions.callFunctionStreaming(\"watch\", {\n                  database: _this.databaseName,\n                  collection: _this.collectionName,\n                  ids: ids,\n                  filter: filter\n                }));\n\n              case 2:\n                iterator = _context13.sent;\n                watchStream = new WatchStream();\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _context13.prev = 6;\n                _iterator = _asyncIterator(iterator);\n\n              case 8:\n                _context13.next = 10;\n                return _awaitAsyncGenerator(_iterator.next());\n\n              case 10:\n                _step = _context13.sent;\n                _iteratorNormalCompletion = _step.done;\n                _context13.next = 14;\n                return _awaitAsyncGenerator(_step.value);\n\n              case 14:\n                _value = _context13.sent;\n\n                if (_iteratorNormalCompletion) {\n                  _context13.next = 30;\n                  break;\n                }\n\n                chunk = _value;\n\n                if (chunk) {\n                  _context13.next = 19;\n                  break;\n                }\n\n                return _context13.abrupt(\"continue\", 27);\n\n              case 19:\n                watchStream.feedBuffer(chunk);\n\n              case 20:\n                if (!(watchStream.state == WatchStreamState.HAVE_EVENT)) {\n                  _context13.next = 25;\n                  break;\n                }\n\n                _context13.next = 23;\n                return watchStream.nextEvent();\n\n              case 23:\n                _context13.next = 20;\n                break;\n\n              case 25:\n                if (!(watchStream.state == WatchStreamState.HAVE_ERROR)) {\n                  _context13.next = 27;\n                  break;\n                }\n\n                throw watchStream.error;\n\n              case 27:\n                _iteratorNormalCompletion = true;\n                _context13.next = 8;\n                break;\n\n              case 30:\n                _context13.next = 36;\n                break;\n\n              case 32:\n                _context13.prev = 32;\n                _context13.t0 = _context13[\"catch\"](6);\n                _didIteratorError = true;\n                _iteratorError = _context13.t0;\n\n              case 36:\n                _context13.prev = 36;\n                _context13.prev = 37;\n\n                if (!(!_iteratorNormalCompletion && _iterator.return != null)) {\n                  _context13.next = 41;\n                  break;\n                }\n\n                _context13.next = 41;\n                return _awaitAsyncGenerator(_iterator.return());\n\n              case 41:\n                _context13.prev = 41;\n\n                if (!_didIteratorError) {\n                  _context13.next = 44;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 44:\n                return _context13.finish(41);\n\n              case 45:\n                return _context13.finish(36);\n\n              case 46:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, null, [[6, 32, 36, 46], [37,, 41, 45]]);\n      }))();\n    }\n  }]);\n\n  return MongoDBCollection;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Creates an Remote MongoDB Collection.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher.\n * @param serviceName A service name.\n * @param databaseName A database name.\n * @param collectionName A collection name.\n * @returns The collection.\n */\n\n\nfunction createCollection(fetcher, serviceName, databaseName, collectionName) {\n  return new MongoDBCollection(fetcher, serviceName, databaseName, collectionName);\n}\n/**\n * Creates a Remote MongoDB Database.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher\n * @param serviceName A service name\n * @param databaseName A database name\n * @returns The database.\n */\n\n\nfunction createDatabase(fetcher, serviceName, databaseName) {\n  return {\n    collection: createCollection.bind(null, fetcher, serviceName, databaseName)\n  };\n}\n/**\n * Creates a Remote MongoDB Service.\n * Note: This method exists to enable function binding.\n *\n * @param fetcher The underlying fetcher.\n * @param serviceName An optional service name.\n * @returns The service.\n */\n\n\nfunction createService(fetcher) {\n  var serviceName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"mongo-db\";\n  return {\n    db: createDatabase.bind(null, fetcher, serviceName)\n  };\n} ////////////////////////////////////////////////////////////////////////////\n\n\nvar DEFAULT_DEVICE_ID = \"000000000000000000000000\";\n/** The state of a user within the app */\n\nvar UserState;\n\n(function (UserState) {\n  /** Active, with both access and refresh tokens */\n  UserState[\"Active\"] = \"active\";\n  /** Logged out, but there might still be data persisted about the user, in the browser. */\n\n  UserState[\"LoggedOut\"] = \"logged-out\";\n  /** Logged out and all data about the user has been removed. */\n\n  UserState[\"Removed\"] = \"removed\";\n})(UserState || (UserState = {}));\n/** The type of a user. */\n\n\nvar UserType$1;\n\n(function (UserType) {\n  /** Created by the user itself. */\n  UserType[\"Normal\"] = \"normal\";\n  /** Created by an administrator of the app. */\n\n  UserType[\"Server\"] = \"server\";\n})(UserType$1 || (UserType$1 = {}));\n/**\n * Representation of an authenticated user of an app.\n */\n\n\nvar User = /*#__PURE__*/function () {\n  /**\n   * @param parameters Parameters of the user.\n   */\n  function User(parameters) {\n    _classCallCheck(this, User);\n\n    this.app = parameters.app;\n    this.id = parameters.id;\n    this.storage = new UserStorage(this.app.storage, this.id);\n\n    if (\"accessToken\" in parameters && \"refreshToken\" in parameters && \"providerType\" in parameters) {\n      this._accessToken = parameters.accessToken;\n      this._refreshToken = parameters.refreshToken;\n      this.providerType = parameters.providerType; // Save the parameters to storage, for future instances to be hydrated from\n\n      this.storage.accessToken = parameters.accessToken;\n      this.storage.refreshToken = parameters.refreshToken;\n      this.storage.providerType = parameters.providerType;\n    } else {\n      // Hydrate the rest of the parameters from storage\n      this._accessToken = this.storage.accessToken;\n      this._refreshToken = this.storage.refreshToken;\n      var providerType = this.storage.providerType;\n      this._profile = this.storage.profile;\n\n      if (providerType) {\n        this.providerType = providerType;\n      } else {\n        throw new Error(\"Storage is missing a provider type\");\n      }\n    }\n\n    this.fetcher = this.app.fetcher.clone({\n      userContext: {\n        currentUser: this\n      }\n    });\n    this.apiKeys = new ApiKeyAuth(this.fetcher);\n    this.functions = FunctionsFactory.create(this.fetcher);\n  }\n  /**\n   * @returns The access token used to authenticate the user towards MongoDB Realm.\n   */\n\n\n  _createClass(User, [{\n    key: \"accessToken\",\n    get: function get() {\n      return this._accessToken;\n    }\n    /**\n     * @param token The new access token.\n     */\n    ,\n    set: function set(token) {\n      this._accessToken = token;\n      this.storage.accessToken = token;\n    }\n    /**\n     * @returns The refresh token used to issue new access tokens.\n     */\n\n  }, {\n    key: \"refreshToken\",\n    get: function get() {\n      return this._refreshToken;\n    }\n    /**\n     * @param token The new refresh token.\n     */\n    ,\n    set: function set(token) {\n      this._refreshToken = token;\n      this.storage.refreshToken = token;\n    }\n    /**\n     * @returns The current state of the user.\n     */\n\n  }, {\n    key: \"state\",\n    get: function get() {\n      if (this.id in this.app.allUsers) {\n        return this.refreshToken === null ? UserState.LoggedOut : UserState.Active;\n      } else {\n        return UserState.Removed;\n      }\n    }\n    /**\n     * @returns The logged in state of the user.\n     */\n\n  }, {\n    key: \"isLoggedIn\",\n    get: function get() {\n      return this.state === UserState.Active;\n    }\n  }, {\n    key: \"customData\",\n    get: function get() {\n      if (this.accessToken) {\n        var decodedToken = this.decodeAccessToken();\n        return decodedToken.userData;\n      } else {\n        throw new Error(\"Cannot read custom data without an access token\");\n      }\n    }\n    /**\n     * @returns Profile containing detailed information about the user.\n     */\n\n  }, {\n    key: \"profile\",\n    get: function get() {\n      if (this._profile) {\n        return this._profile.data;\n      } else {\n        throw new Error(\"A profile was never fetched for this user\");\n      }\n    }\n  }, {\n    key: \"identities\",\n    get: function get() {\n      if (this._profile) {\n        return this._profile.identities;\n      } else {\n        throw new Error(\"A profile was never fetched for this user\");\n      }\n    }\n  }, {\n    key: \"deviceId\",\n    get: function get() {\n      if (this.accessToken) {\n        var payload = this.accessToken.split(\".\")[1];\n\n        if (payload) {\n          var parsedPayload = JSON.parse(base64.Base64.decode(payload));\n          var deviceId = parsedPayload[\"baas_device_id\"];\n\n          if (typeof deviceId === \"string\" && deviceId !== DEFAULT_DEVICE_ID) {\n            return deviceId;\n          }\n        }\n      }\n\n      return null;\n    }\n    /**\n     * Refresh the users profile data.\n     */\n\n  }, {\n    key: \"refreshProfile\",\n    value: function () {\n      var _refreshProfile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"GET\",\n                  path: routes.api().auth().profile().path\n                });\n\n              case 2:\n                response = _context14.sent;\n                // Create a profile instance\n                this._profile = new UserProfile(response); // Store this for later hydration\n\n                this.storage.profile = this._profile;\n\n              case 5:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function refreshProfile() {\n        return _refreshProfile.apply(this, arguments);\n      }\n\n      return refreshProfile;\n    }()\n    /**\n     * Log out the user, invalidating the session (and its refresh token).\n     */\n\n  }, {\n    key: \"logOut\",\n    value: function () {\n      var _logOut = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.prev = 0;\n\n                if (!(this._refreshToken !== null)) {\n                  _context15.next = 4;\n                  break;\n                }\n\n                _context15.next = 4;\n                return this.fetcher.fetchJSON({\n                  method: \"DELETE\",\n                  path: routes.api().auth().session().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 4:\n                _context15.prev = 4;\n                // Forget the access and refresh token\n                this.accessToken = null;\n                this.refreshToken = null;\n                return _context15.finish(4);\n\n              case 8:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this, [[0,, 4, 8]]);\n      }));\n\n      function logOut() {\n        return _logOut.apply(this, arguments);\n      }\n\n      return logOut;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"linkCredentials\",\n    value: function () {\n      var _linkCredentials = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16(credentials) {\n        var response, details;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return this.app.authenticator.authenticate(credentials, this);\n\n              case 2:\n                response = _context16.sent;\n\n                if (!(this.id !== response.userId)) {\n                  _context16.next = 6;\n                  break;\n                }\n\n                details = \"got user id \".concat(response.userId, \" expected \").concat(this.id);\n                throw new Error(\"Link response ment for another user (\".concat(details, \")\"));\n\n              case 6:\n                // Update the access token\n                this.accessToken = response.accessToken; // Refresh the profile to include the new identity\n\n                _context16.next = 9;\n                return this.refreshProfile();\n\n              case 9:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function linkCredentials(_x18) {\n        return _linkCredentials.apply(this, arguments);\n      }\n\n      return linkCredentials;\n    }()\n    /**\n     * Request a new access token, using the refresh token.\n     */\n\n  }, {\n    key: \"refreshAccessToken\",\n    value: function () {\n      var _refreshAccessToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17() {\n        var response, accessToken;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                _context17.next = 2;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  path: routes.api().auth().session().path,\n                  tokenType: \"refresh\"\n                });\n\n              case 2:\n                response = _context17.sent;\n                accessToken = response.access_token;\n\n                if (!(typeof accessToken === \"string\")) {\n                  _context17.next = 8;\n                  break;\n                }\n\n                this.accessToken = accessToken;\n                _context17.next = 9;\n                break;\n\n              case 8:\n                throw new Error(\"Expected an 'access_token' in the response\");\n\n              case 9:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function refreshAccessToken() {\n        return _refreshAccessToken.apply(this, arguments);\n      }\n\n      return refreshAccessToken;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"refreshCustomData\",\n    value: function () {\n      var _refreshCustomData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                _context18.next = 2;\n                return this.refreshAccessToken();\n\n              case 2:\n                return _context18.abrupt(\"return\", this.customData);\n\n              case 3:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function refreshCustomData() {\n        return _refreshCustomData.apply(this, arguments);\n      }\n\n      return refreshCustomData;\n    }()\n    /** @inheritdoc */\n\n  }, {\n    key: \"callFunction\",\n    value: function callFunction(name) {\n      var _this$functions;\n\n      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n\n      return (_this$functions = this.functions).callFunction.apply(_this$functions, [name].concat(args));\n    }\n    /**\n     * @returns A plain ol' JavaScript object representation of the user.\n     */\n\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        id: this.id,\n        accessToken: this.accessToken,\n        refreshToken: this.refreshToken,\n        profile: this._profile,\n        state: this.state,\n        customData: this.customData\n      };\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"push\",\n    value: function push() {\n      var serviceName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      throw new Error(\"Not yet implemented\");\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"mongoClient\",\n    value: function mongoClient(serviceName) {\n      return createService(this.fetcher, serviceName);\n    }\n  }, {\n    key: \"decodeAccessToken\",\n    value: function decodeAccessToken() {\n      if (this.accessToken) {\n        // Decode and spread the token\n        var parts = this.accessToken.split(\".\");\n\n        if (parts.length !== 3) {\n          throw new Error(\"Expected an access token with three parts\");\n        } // Decode the payload\n\n\n        var encodedPayload = parts[1];\n        var decodedPayload = base64.Base64.decode(encodedPayload);\n        var parsedPayload = JSON.parse(decodedPayload);\n        var expires = parsedPayload.exp,\n            issuedAt = parsedPayload.iat,\n            subject = parsedPayload.sub,\n            _parsedPayload$user_d = parsedPayload.user_data,\n            userData = _parsedPayload$user_d === void 0 ? {} : _parsedPayload$user_d; // Validate the types\n\n        if (typeof expires !== \"number\") {\n          throw new Error(\"Failed to decode access token 'exp'\");\n        } else if (typeof issuedAt !== \"number\") {\n          throw new Error(\"Failed to decode access token 'iat'\");\n        }\n\n        return {\n          expires: expires,\n          issuedAt: issuedAt,\n          subject: subject,\n          userData: userData\n        };\n      } else {\n        throw new Error(\"Missing an access token\");\n      }\n    }\n  }]);\n\n  return User;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n// TODO: Ensure the static interface of the Credentials class implements the static interface of Realm.Credentials\n// See https://stackoverflow.com/a/43484801\n\n/**\n * Instances of this class can be passed to the `app.logIn` method to authenticate an end-user.\n */\n\n\nvar Credentials = /*#__PURE__*/function () {\n  /**\n   * Constructs an instance of credentials.\n   *\n   * @param providerName The name of the authentication provider used when authenticating.\n   * @param providerType The type of the authentication provider used when authenticating.\n   * @param payload The data being sent to the service when authenticating.\n   */\n  function Credentials(providerName, providerType, payload) {\n    _classCallCheck(this, Credentials);\n\n    this.providerName = providerName;\n    this.providerType = providerType;\n    this.payload = payload;\n  }\n  /**\n   * Creates credentials that logs in using the [Anonymous Provider](https://docs.mongodb.com/realm/authentication/anonymous/).\n   *\n   * @returns The credentials instance, which can be passed to `app.logIn`.\n   */\n\n\n  _createClass(Credentials, null, [{\n    key: \"anonymous\",\n    value: function anonymous() {\n      return new Credentials(\"anon-user\", \"anon-user\", {});\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @deprecated Use `Credentials.apiKey`.\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"userApiKey\",\n    value: function userApiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @deprecated Use `Credentials.apiKey`.\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"serverApiKey\",\n    value: function serverApiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [API Key Provider](https://docs.mongodb.com/realm/authentication/api-key/).\n     *\n     * @param key The secret content of the API key.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"apiKey\",\n    value: function apiKey(key) {\n      return new Credentials(\"api-key\", \"api-key\", {\n        key: key\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Email/Password Provider](https://docs.mongodb.com/realm/authentication/email-password/).\n     * Note: This was formerly known as the \"Username/Password\" provider.\n     *\n     * @param email The end-users email address.\n     * @param password The end-users password.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"emailPassword\",\n    value: function emailPassword(email, password) {\n      return new Credentials(\"local-userpass\", \"local-userpass\", {\n        username: email,\n        password: password\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Custom Function Provider](https://docs.mongodb.com/realm/authentication/custom-function/).\n     *\n     * @param payload The custom payload as expected by the server.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"function\",\n    value: function _function(payload) {\n      return new Credentials(\"custom-function\", \"custom-function\", payload);\n    }\n    /**\n     * Creates credentials that logs in using the [Custom JWT Provider](https://docs.mongodb.com/realm/authentication/custom-jwt/).\n     *\n     * @param token The JSON Web Token (JWT).\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"jwt\",\n    value: function jwt(token) {\n      return new Credentials(\"custom-token\", \"custom-token\", {\n        token: token\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Google Provider](https://docs.mongodb.com/realm/authentication/google/).\n     *\n     * @param payload The URL that users should be redirected to, the auth code or id token from Google.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"google\",\n    value: function google(payload) {\n      return new Credentials(\"oauth2-google\", \"oauth2-google\", Credentials.derivePayload(payload));\n    }\n    /**\n     * @param payload The payload string.\n     * @returns A payload object based on the string.\n     */\n\n  }, {\n    key: \"derivePayload\",\n    value: function derivePayload(payload) {\n      if (typeof payload === \"string\") {\n        if (payload.includes(\"://\")) {\n          return this.derivePayload({\n            redirectUrl: payload\n          });\n        } else if (payload.startsWith(\"4/\")) {\n          return this.derivePayload({\n            authCode: payload\n          });\n        } else if (payload.startsWith(\"ey\")) {\n          // eslint-disable-next-line @typescript-eslint/camelcase\n          return this.derivePayload({\n            idToken: payload\n          });\n        } else {\n          throw new Error(\"Unexpected payload: \".concat(payload));\n        }\n      } else if (Object.keys(payload).length === 1) {\n        if (\"authCode\" in payload || \"redirectUrl\" in payload) {\n          return payload;\n        } else if (\"idToken\" in payload) {\n          // eslint-disable-next-line @typescript-eslint/camelcase\n          return {\n            id_token: payload.idToken\n          };\n        } else {\n          throw new Error(\"Unexpected payload: \" + JSON.stringify(payload));\n        }\n      } else {\n        throw new Error(\"Expected only one property in payload, got \" + JSON.stringify(payload));\n      }\n    }\n    /**\n     * Creates credentials that logs in using the [Facebook Provider](https://docs.mongodb.com/realm/authentication/facebook/).\n     *\n     * @param redirectUrlOrAccessToken The URL that users should be redirected to or the auth code returned from Facebook.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"facebook\",\n    value: function facebook(redirectUrlOrAccessToken) {\n      return new Credentials(\"oauth2-facebook\", \"oauth2-facebook\", redirectUrlOrAccessToken.includes(\"://\") ? {\n        redirectUrl: redirectUrlOrAccessToken\n      } : {\n        accessToken: redirectUrlOrAccessToken\n      });\n    }\n    /**\n     * Creates credentials that logs in using the [Apple ID Provider](https://docs.mongodb.com/realm/authentication/apple/).\n     *\n     * @param redirectUrlOrIdToken The URL that users should be redirected to or the id_token returned from Apple.\n     * @returns The credentials instance, which can be passed to `app.logIn`.\n     */\n\n  }, {\n    key: \"apple\",\n    value: function apple(redirectUrlOrIdToken) {\n      return new Credentials(\"oauth2-apple\", \"oauth2-apple\", redirectUrlOrIdToken.includes(\"://\") ? {\n        redirectUrl: redirectUrlOrIdToken\n      } : {\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        id_token: redirectUrlOrIdToken\n      });\n    }\n  }]);\n\n  return Credentials;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar USER_IDS_STORAGE_KEY = \"userIds\";\nvar DEVICE_ID_STORAGE_KEY = \"deviceId\";\n/**\n * Storage specific to the app.\n */\n\nvar AppStorage = /*#__PURE__*/function (_PrefixedStorage2) {\n  _inherits(AppStorage, _PrefixedStorage2);\n\n  var _super3 = _createSuper(AppStorage);\n\n  /**\n   * @param storage The underlying storage to wrap.\n   * @param appId The id of the app.\n   */\n  function AppStorage(storage, appId) {\n    _classCallCheck(this, AppStorage);\n\n    return _super3.call(this, storage, \"app(\".concat(appId, \")\"));\n  }\n  /**\n   * Reads out the list of user ids from storage.\n   *\n   * @returns A list of user ids.\n   */\n\n\n  _createClass(AppStorage, [{\n    key: \"getUserIds\",\n    value: function getUserIds() {\n      var userIdsString = this.get(USER_IDS_STORAGE_KEY);\n      var userIds = userIdsString ? JSON.parse(userIdsString) : [];\n\n      if (Array.isArray(userIds)) {\n        // Remove any duplicates that might have been added\n        // The Set preserves insertion order\n        return _toConsumableArray(new Set(userIds));\n      } else {\n        throw new Error(\"Expected the user ids to be an array\");\n      }\n    }\n    /**\n     * Sets the list of ids in storage.\n     * Optionally merging with existing ids stored in the storage, by prepending these while voiding duplicates.\n     *\n     * @param userIds The list of ids to store.\n     * @param mergeWithExisting Prepend existing ids to avoid data-races with other apps using this storage.\n     */\n\n  }, {\n    key: \"setUserIds\",\n    value: function setUserIds(userIds, mergeWithExisting) {\n      if (mergeWithExisting) {\n        // Add any existing user id to the end of this list, avoiding duplicates\n        var existingIds = this.getUserIds();\n\n        var _iterator3 = _createForOfIteratorHelper(existingIds),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var id = _step3.value;\n\n            if (userIds.indexOf(id) === -1) {\n              userIds.push(id);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      } // Store the list of ids\n\n\n      this.set(USER_IDS_STORAGE_KEY, JSON.stringify(userIds));\n    }\n    /**\n     * Remove an id from the list of ids.\n     *\n     * @param userId The id of a User to be removed.\n     */\n\n  }, {\n    key: \"removeUserId\",\n    value: function removeUserId(userId) {\n      var existingIds = this.getUserIds();\n      var userIds = existingIds.filter(function (id) {\n        return id !== userId;\n      }); // Store the list of ids\n\n      this.setUserIds(userIds, false);\n    }\n    /**\n     * @returns id of this device (if any exists)\n     */\n\n  }, {\n    key: \"getDeviceId\",\n    value: function getDeviceId() {\n      return this.get(DEVICE_ID_STORAGE_KEY);\n    }\n    /**\n     * @param deviceId The id of this device, to send on subsequent authentication requests.\n     */\n\n  }, {\n    key: \"setDeviceId\",\n    value: function setDeviceId(deviceId) {\n      this.set(DEVICE_ID_STORAGE_KEY, deviceId);\n    }\n  }]);\n\n  return AppStorage;\n}(PrefixedStorage); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n\n\nvar LOWERCASE_LETTERS = \"abcdefghijklmnopqrstuvwxyz\";\nvar CLOSE_CHECK_INTERVAL = 100; // 10 times per second\n\n/* eslint-disable @typescript-eslint/camelcase */\n\nvar REDIRECT_HASH_TO_RESULT = {\n  _stitch_client_app_id: \"appId\",\n  _baas_client_app_id: \"appId\",\n  _stitch_ua: \"userAuth\",\n  _baas_ua: \"userAuth\",\n  _stitch_link: \"link\",\n  _baas_link: \"link\",\n  _stitch_error: \"error\",\n  _baas_error: \"error\",\n  _stitch_state: \"state\",\n  _baas_state: \"state\"\n};\n/* eslint-enable @typescript-eslint/camelcase */\n\n/**\n * A collection of methods helping implement the OAuth2 flow.\n */\n\nvar OAuth2Helper = /*#__PURE__*/function () {\n  /**\n   * @param storage The underlying storage to use when storing and retriving secrets.\n   * @param openWindow An optional function called when a browser window needs to open.\n   */\n  function OAuth2Helper(storage) {\n    var openWindow = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getEnvironment().openWindow;\n\n    _classCallCheck(this, OAuth2Helper);\n\n    this.storage = storage.prefix(\"oauth2\");\n    this.openWindow = openWindow;\n  }\n  /**\n   * Parses the query string from the final step of the OAuth flow.\n   *\n   * @param queryString The query string passed through in location.hash.\n   * @returns The result of the OAuth flow.\n   */\n\n\n  _createClass(OAuth2Helper, [{\n    key: \"openWindowAndWaitForRedirect\",\n    value:\n    /**\n     * Open a window and wait for the redirect to be handled.\n     *\n     * @param url The URL to open.\n     * @param state The state which will be used to listen for storage updates.\n     * @returns The result passed through the redirect.\n     */\n    function openWindowAndWaitForRedirect(url, state) {\n      var _this3 = this;\n\n      var stateStorage = OAuth2Helper.getStateStorage(this.storage, state); // Return a promise that resolves when the  gets known\n\n      return new Promise(function (resolve, reject) {\n        var redirectWindow = null; // We're declaring the interval now to enable referencing before its initialized\n\n        var windowClosedInterval; // eslint-disable-line prefer-const\n\n        var handleStorageUpdate = function handleStorageUpdate() {\n          // Trying to get the secret from storage\n          var result = stateStorage.get(\"result\");\n\n          if (result) {\n            var parsedResult = JSON.parse(result); // The secret got updated!\n\n            stateStorage.removeListener(handleStorageUpdate); // Clear the storage to prevent others from reading this\n\n            stateStorage.clear(); // Try closing the newly created window\n\n            try {\n              if (redirectWindow) {\n                // Stop checking if the window closed\n                clearInterval(windowClosedInterval);\n                redirectWindow.close();\n              }\n            } catch (err) {\n              console.warn(\"Failed closing redirect window: \".concat(err));\n            } finally {\n              resolve(parsedResult);\n            }\n          }\n        }; // Add a listener to the state storage, awaiting an update to the secret\n\n\n        stateStorage.addListener(handleStorageUpdate); // Open up a window\n\n        redirectWindow = _this3.openWindow(url); // Not using a const, because we need the two listeners to reference each other when removing the other.\n\n        windowClosedInterval = setInterval(function () {\n          // Polling \"closed\" because registering listeners on the window violates cross-origin policies\n          if (!redirectWindow) {\n            // No need to keep polling for a window that we can't check\n            clearInterval(windowClosedInterval);\n          } else if (redirectWindow.closed) {\n            // Stop polling the window state\n            clearInterval(windowClosedInterval); // Stop listening for changes to the storage\n\n            stateStorage.removeListener(handleStorageUpdate); // Reject the promise\n\n            var err = new Error(\"Window closed\");\n            reject(err);\n          }\n        }, CLOSE_CHECK_INTERVAL);\n      });\n    }\n    /**\n     * Generate a random state string.\n     *\n     * @returns The random state string.\n     */\n\n  }, {\n    key: \"generateState\",\n    value: function generateState() {\n      return generateRandomString(12, LOWERCASE_LETTERS);\n    }\n  }], [{\n    key: \"parseRedirectLocation\",\n    value: function parseRedirectLocation(queryString) {\n      var params = decodeQueryString(queryString);\n      var result = {};\n\n      for (var _i2 = 0, _Object$entries2 = Object.entries(REDIRECT_HASH_TO_RESULT); _i2 < _Object$entries2.length; _i2++) {\n        var _Object$entries2$_i = _slicedToArray(_Object$entries2[_i2], 2),\n            p = _Object$entries2$_i[0],\n            r = _Object$entries2$_i[1];\n\n        var value = params[p];\n\n        if (value) {\n          result[r] = value;\n        }\n      }\n\n      return result;\n    }\n    /**\n     * Handle the redirect querystring by parsing it and storing it for others to consume.\n     *\n     * @param queryString The query string containing the encoded result from the OAuth provider.\n     * @param storage The underlying storage used to persist the result.\n     */\n\n  }, {\n    key: \"handleRedirect\",\n    value: function handleRedirect(queryString) {\n      var storage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getEnvironment().defaultStorage;\n      var result = OAuth2Helper.parseRedirectLocation(queryString);\n      var state = result.state,\n          error = result.error;\n\n      if (typeof state === \"string\") {\n        var oauth2Storage = storage.prefix(\"oauth2\");\n        var stateStorage = OAuth2Helper.getStateStorage(oauth2Storage, state);\n        stateStorage.set(\"result\", JSON.stringify(result));\n      } else if (error) {\n        throw new Error(\"Failed to handle OAuth 2.0 redirect: \".concat(error));\n      } else {\n        throw new Error(\"Failed to handle OAuth 2.0 redirect.\");\n      }\n    }\n    /**\n     * Decodes the authInfo string into its seperate parts.\n     *\n     * @param authInfo An authInfo string returned from the server.\n     * @returns An object containing the separate parts of the authInfo string.\n     */\n\n  }, {\n    key: \"decodeAuthInfo\",\n    value: function decodeAuthInfo(authInfo) {\n      var parts = (authInfo || \"\").split(\"$\");\n\n      if (parts.length === 4) {\n        var _parts = _slicedToArray(parts, 4),\n            accessToken = _parts[0],\n            refreshToken = _parts[1],\n            userId = _parts[2],\n            deviceId = _parts[3];\n\n        return {\n          accessToken: accessToken,\n          refreshToken: refreshToken,\n          userId: userId,\n          deviceId: deviceId\n        };\n      } else {\n        throw new Error(\"Failed to decode 'authInfo' into ids and tokens\");\n      }\n    }\n    /**\n     * Get the storage key associated of an secret associated with a state.\n     *\n     * @param storage The root storage used to derive a \"state namespaced\" storage.\n     * @param state The random state.\n     * @returns The storage associated with a particular state.\n     */\n\n  }, {\n    key: \"getStateStorage\",\n    value: function getStateStorage(storage, state) {\n      return storage.prefix(\"state(\".concat(state, \")\"));\n    }\n  }]);\n\n  return OAuth2Helper;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar REDIRECT_LOCATION_HEADER = \"x-baas-location\";\n/**\n * Handles authentication and linking of users.\n */\n\nvar Authenticator = /*#__PURE__*/function () {\n  /**\n   * @param fetcher The fetcher used to fetch responses from the server.\n   * @param storage The storage used when completing OAuth 2.0 flows (should not be scoped to a specific app).\n   * @param getDeviceInformation Called to get device information to be sent to the server.\n   */\n  function Authenticator(fetcher, storage, getDeviceInformation) {\n    _classCallCheck(this, Authenticator);\n\n    this.fetcher = fetcher;\n    this.oauth2 = new OAuth2Helper(storage);\n    this.getDeviceInformation = getDeviceInformation;\n  }\n  /**\n   * @param credentials Credentials to use when logging in.\n   * @param linkingUser A user requesting to link.\n   */\n\n\n  _createClass(Authenticator, [{\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(credentials, linkingUser) {\n        var deviceInformation, isLinking, state, url, response, redirectUrl, logInUrl, _response, userId, accessToken, _response$refresh_tok, refreshToken, deviceId;\n\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                deviceInformation = this.getDeviceInformation();\n                isLinking = typeof linkingUser === \"object\";\n\n                if (!(credentials.providerType.startsWith(\"oauth2\") && typeof credentials.payload.redirectUrl === \"string\")) {\n                  _context19.next = 22;\n                  break;\n                }\n\n                // Initiate the OAuth2 flow by generating a state and fetch a redirect URL\n                state = this.oauth2.generateState();\n                _context19.next = 6;\n                return this.getLogInUrl(credentials, isLinking, {\n                  state: state,\n                  redirect: credentials.payload.redirectUrl,\n                  // Ensure redirects are communicated in a header different from \"Location\" and status remains 200 OK\n                  providerRedirectHeader: isLinking ? true : undefined,\n                  // Add the device information, only if we're not linking - since that request won't have a body of its own.\n                  device: !isLinking ? deviceInformation.encode() : undefined\n                });\n\n              case 6:\n                url = _context19.sent;\n\n                if (!isLinking) {\n                  _context19.next = 19;\n                  break;\n                }\n\n                _context19.next = 10;\n                return this.fetcher.fetch({\n                  method: \"GET\",\n                  url: url,\n                  tokenType: isLinking ? \"access\" : \"none\",\n                  user: linkingUser,\n                  // The response will set a cookie that we need to tell the browser to store\n                  mode: \"cors\",\n                  credentials: \"include\"\n                });\n\n              case 10:\n                response = _context19.sent;\n                // If a response header contains a redirect URL: Open a window and wait for the redirect to be handled\n                redirectUrl = response.headers.get(REDIRECT_LOCATION_HEADER);\n\n                if (!redirectUrl) {\n                  _context19.next = 16;\n                  break;\n                }\n\n                return _context19.abrupt(\"return\", this.openWindowAndWaitForAuthResponse(redirectUrl, state));\n\n              case 16:\n                throw new Error(\"Missing \".concat(REDIRECT_LOCATION_HEADER, \" header\"));\n\n              case 17:\n                _context19.next = 20;\n                break;\n\n              case 19:\n                return _context19.abrupt(\"return\", this.openWindowAndWaitForAuthResponse(url, state));\n\n              case 20:\n                _context19.next = 34;\n                break;\n\n              case 22:\n                _context19.next = 24;\n                return this.getLogInUrl(credentials, isLinking);\n\n              case 24:\n                logInUrl = _context19.sent;\n                _context19.next = 27;\n                return this.fetcher.fetchJSON({\n                  method: \"POST\",\n                  url: logInUrl,\n                  body: _objectSpread(_objectSpread({}, credentials.payload), {}, {\n                    options: {\n                      device: deviceInformation.toJSON()\n                    }\n                  }),\n                  tokenType: isLinking ? \"access\" : \"none\",\n                  user: linkingUser\n                });\n\n              case 27:\n                _response = _context19.sent;\n                // Spread out values from the response and ensure they're valid\n                userId = _response.user_id, accessToken = _response.access_token, _response$refresh_tok = _response.refresh_token, refreshToken = _response$refresh_tok === void 0 ? null : _response$refresh_tok, deviceId = _response.device_id;\n\n                if (!(typeof userId !== \"string\")) {\n                  _context19.next = 31;\n                  break;\n                }\n\n                throw new Error(\"Expected a user id in the response\");\n\n              case 31:\n                if (!(typeof accessToken !== \"string\")) {\n                  _context19.next = 33;\n                  break;\n                }\n\n                throw new Error(\"Expected an access token in the response\");\n\n              case 33:\n                return _context19.abrupt(\"return\", {\n                  userId: userId,\n                  accessToken: accessToken,\n                  refreshToken: refreshToken,\n                  deviceId: deviceId\n                });\n\n              case 34:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      function authenticate(_x19, _x20) {\n        return _authenticate.apply(this, arguments);\n      }\n\n      return authenticate;\n    }()\n    /**\n     * @param credentials Credentials to use when logging in.\n     * @param link Should the request link with the current user?\n     * @param extraQueryParams Any extra parameters to include in the query string\n     */\n\n  }, {\n    key: \"getLogInUrl\",\n    value: function () {\n      var _getLogInUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee20(credentials) {\n        var link,\n            extraQueryParams,\n            appRoute,\n            loginRoute,\n            qs,\n            locationUrl,\n            _args20 = arguments;\n        return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                link = _args20.length > 1 && _args20[1] !== undefined ? _args20[1] : false;\n                extraQueryParams = _args20.length > 2 && _args20[2] !== undefined ? _args20[2] : {};\n                // See https://github.com/mongodb/stitch-js-sdk/blob/310f0bd5af80f818cdfbc3caf1ae29ffa8e9c7cf/packages/core/sdk/src/auth/internal/CoreStitchAuth.ts#L746-L780\n                appRoute = this.fetcher.appRoute;\n                loginRoute = appRoute.authProvider(credentials.providerName).login();\n                qs = encodeQueryString(_objectSpread({\n                  link: link ? \"true\" : undefined\n                }, extraQueryParams));\n                _context20.next = 7;\n                return this.fetcher.locationUrl;\n\n              case 7:\n                locationUrl = _context20.sent;\n                return _context20.abrupt(\"return\", locationUrl + loginRoute.path + qs);\n\n              case 9:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20, this);\n      }));\n\n      function getLogInUrl(_x21) {\n        return _getLogInUrl.apply(this, arguments);\n      }\n\n      return getLogInUrl;\n    }()\n  }, {\n    key: \"openWindowAndWaitForAuthResponse\",\n    value: function () {\n      var _openWindowAndWaitForAuthResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee21(redirectUrl, state) {\n        var redirectResult;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                _context21.next = 2;\n                return this.oauth2.openWindowAndWaitForRedirect(redirectUrl, state);\n\n              case 2:\n                redirectResult = _context21.sent;\n                return _context21.abrupt(\"return\", OAuth2Helper.decodeAuthInfo(redirectResult.userAuth));\n\n              case 4:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n\n      function openWindowAndWaitForAuthResponse(_x22, _x23) {\n        return _openWindowAndWaitForAuthResponse.apply(this, arguments);\n      }\n\n      return openWindowAndWaitForAuthResponse;\n    }()\n  }]);\n\n  return Authenticator;\n}(); ////////////////////////////////////////////////////////////////////////////\n//\n// Copyright 2020 Realm Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n////////////////////////////////////////////////////////////////////////////\n// TODO: Determine if the shape of an error response is specific to each service or widely used.\n\n/**\n * An error produced while communicating with the MongoDB Realm server.\n */\n\n\nvar MongoDBRealmError = /*#__PURE__*/function (_Error2) {\n  _inherits(MongoDBRealmError, _Error2);\n\n  var _super4 = _createSuper(MongoDBRealmError);\n\n  function MongoDBRealmError(method, url, statusCode, statusText, error, errorCode, link) {\n    var _this4;\n\n    _classCallCheck(this, MongoDBRealmError);\n\n    var summary = statusText ? \"status \".concat(statusCode, \" \").concat(statusText) : \"status \".concat(statusCode);\n\n    if (typeof error === \"string\") {\n      _this4 = _super4.call(this, \"Request failed (\".concat(method, \" \").concat(url, \"): \").concat(error, \" (\").concat(summary, \")\"));\n    } else {\n      _this4 = _super4.call(this, \"Request failed (\".concat(method, \" \").concat(url, \"): (\").concat(summary, \")\"));\n    }\n\n    _this4.method = method;\n    _this4.url = url;\n    _this4.statusText = statusText;\n    _this4.statusCode = statusCode;\n    _this4.error = error;\n    _this4.errorCode = errorCode;\n    _this4.link = link;\n    return _possibleConstructorReturn(_this4);\n  }\n  /**\n   * Constructs and returns an error from a request and a response.\n   * Note: The caller must throw this error themselves.\n   *\n   * @param request The request sent to the server.\n   * @param response A raw response, as returned from the server.\n   */\n\n\n  _createClass(MongoDBRealmError, null, [{\n    key: \"fromRequestAndResponse\",\n    value: function () {\n      var _fromRequestAndResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee22(request, response) {\n        var _a, url, method, status, statusText, body, error, errorCode, link;\n\n        return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                url = request.url, method = request.method;\n                status = response.status, statusText = response.statusText;\n\n                if (!((_a = response.headers.get(\"content-type\")) === null || _a === void 0 ? void 0 : _a.startsWith(\"application/json\"))) {\n                  _context22.next = 12;\n                  break;\n                }\n\n                _context22.next = 5;\n                return response.json();\n\n              case 5:\n                body = _context22.sent;\n                error = body.error || \"No message\";\n                errorCode = body.error_code;\n                link = body.link;\n                return _context22.abrupt(\"return\", new MongoDBRealmError(method, url, status, statusText, error, errorCode, link));\n\n              case 12:\n                return _context22.abrupt(\"return\", new MongoDBRealmError(method, url, status, statusText));\n\n              case 13:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22);\n      }));\n\n      function fromRequestAndResponse(_x24, _x25) {\n        return _fromRequestAndResponse.apply(this, arguments);\n      }\n\n      return fromRequestAndResponse;\n    }()\n  }]);\n\n  return MongoDBRealmError;\n}( /*#__PURE__*/_wrapNativeSuper(Error)); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * @param body A possible resonse body.\n * @returns An async iterator.\n */\n\n\nfunction asyncIteratorFromResponseBody(body) {\n  if (typeof body !== \"object\" || body === null) {\n    throw new Error(\"Expected a non-null object\");\n  } else if (Symbol.asyncIterator in body) {\n    return body;\n  } else if (\"getReader\" in body) {\n    var stream = body;\n    return _defineProperty({}, Symbol.asyncIterator, function () {\n      var reader = stream.getReader();\n      return {\n        next: function next() {\n          return reader.read();\n        },\n        return: function _return() {\n          return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee23() {\n            return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n              while (1) {\n                switch (_context23.prev = _context23.next) {\n                  case 0:\n                    _context23.next = 2;\n                    return reader.cancel();\n\n                  case 2:\n                    return _context23.abrupt(\"return\", {\n                      done: true,\n                      value: null\n                    });\n\n                  case 3:\n                  case \"end\":\n                    return _context23.stop();\n                }\n              }\n            }, _callee23);\n          }))();\n        }\n      };\n    });\n  } else {\n    throw new Error(\"Expected an AsyncIterable or a ReadableStream\");\n  }\n}\n/**\n * Wraps a NetworkTransport from the \"realm-network-transport\" package.\n * Extracts error messages and throws `MongoDBRealmError` objects upon failures.\n * Injects access or refresh tokens for a current or specific user.\n * Refreshes access tokens if requests fails due to a 401 error.\n * Optionally parses response as JSON before returning it.\n * Fetches and exposes an app's location url.\n */\n\n\nvar Fetcher = /*#__PURE__*/function () {\n  /**\n   * @param config A configuration of the fetcher.\n   */\n  function Fetcher(_ref11) {\n    var appId = _ref11.appId,\n        transport = _ref11.transport,\n        userContext = _ref11.userContext,\n        locationUrlContext = _ref11.locationUrlContext;\n\n    _classCallCheck(this, Fetcher);\n\n    this.appId = appId;\n    this.transport = transport;\n    this.userContext = userContext;\n    this.locationUrlContext = locationUrlContext;\n  }\n  /**\n   * @param user An optional user to generate the header for.\n   * @param tokenType The type of token (access or refresh).\n   * @returns An object containing the user's token as \"Authorization\" header or undefined if no user is given.\n   */\n\n\n  _createClass(Fetcher, [{\n    key: \"clone\",\n    value: function clone(config) {\n      return new Fetcher(_objectSpread({\n        appId: this.appId,\n        transport: this.transport,\n        userContext: this.userContext,\n        locationUrlContext: this.locationUrlContext\n      }, config));\n    }\n    /**\n     * Fetch a network resource as an authenticated user.\n     *\n     * @param request The request which should be sent to the server.\n     * @returns The response from the server.\n     */\n\n  }, {\n    key: \"fetch\",\n    value: function () {\n      var _fetch2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee24(request) {\n        var path, url, _request$tokenType, tokenType, _request$user, user, restOfRequest, _url, response;\n\n        return _regeneratorRuntime.wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                path = request.path, url = request.url, _request$tokenType = request.tokenType, tokenType = _request$tokenType === void 0 ? \"access\" : _request$tokenType, _request$user = request.user, user = _request$user === void 0 ? this.userContext.currentUser : _request$user, restOfRequest = _objectWithoutProperties(request, [\"path\", \"url\", \"tokenType\", \"user\"]);\n\n                if (!(typeof path === \"string\" && typeof url === \"string\")) {\n                  _context24.next = 5;\n                  break;\n                }\n\n                throw new Error(\"Use of 'url' and 'path' mutually exclusive\");\n\n              case 5:\n                if (!(typeof path === \"string\")) {\n                  _context24.next = 14;\n                  break;\n                }\n\n                _context24.next = 8;\n                return this.locationUrlContext.locationUrl;\n\n              case 8:\n                _context24.t0 = _context24.sent;\n                _context24.t1 = path;\n                _url = _context24.t0 + _context24.t1;\n                return _context24.abrupt(\"return\", this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  path: undefined,\n                  url: _url\n                })));\n\n              case 14:\n                if (!(typeof url === \"string\")) {\n                  _context24.next = 34;\n                  break;\n                }\n\n                _context24.next = 17;\n                return this.transport.fetch(_objectSpread(_objectSpread({}, restOfRequest), {}, {\n                  url: url,\n                  headers: _objectSpread(_objectSpread({}, Fetcher.buildAuthorizationHeader(user, tokenType)), request.headers)\n                }));\n\n              case 17:\n                response = _context24.sent;\n\n                if (!response.ok) {\n                  _context24.next = 22;\n                  break;\n                }\n\n                return _context24.abrupt(\"return\", response);\n\n              case 22:\n                if (!(user && response.status === 401 && tokenType === \"access\")) {\n                  _context24.next = 28;\n                  break;\n                }\n\n                _context24.next = 25;\n                return user.refreshAccessToken();\n\n              case 25:\n                return _context24.abrupt(\"return\", this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  user: user\n                })));\n\n              case 28:\n                if (user && response.status === 401 && tokenType === \"refresh\") {\n                  // A 401 error while using the refresh token indicates the token has an issue.\n                  // Reset the tokens to prevent a lock.\n                  user.accessToken = null;\n                  user.refreshToken = null;\n                } // Throw an error with a message extracted from the body\n\n\n                _context24.next = 31;\n                return MongoDBRealmError.fromRequestAndResponse(request, response);\n\n              case 31:\n                throw _context24.sent;\n\n              case 32:\n                _context24.next = 35;\n                break;\n\n              case 34:\n                throw new Error(\"Expected either 'url' or 'path'\");\n\n              case 35:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      function fetch(_x26) {\n        return _fetch2.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n    /**\n     * Fetch a network resource as an authenticated user and parse the result as extended JSON.\n     *\n     * @param request The request which should be sent to the server.\n     * @returns The response from the server, parsed as extended JSON.\n     */\n\n  }, {\n    key: \"fetchJSON\",\n    value: function () {\n      var _fetchJSON = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee25(request) {\n        var body, serializedBody, contentTypeHeaders, response, contentType, responseBody;\n        return _regeneratorRuntime.wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                body = request.body;\n                serializedBody = Fetcher.buildBody(body);\n                contentTypeHeaders = Fetcher.buildJsonHeader(serializedBody);\n                _context25.next = 5;\n                return this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  body: serializedBody,\n                  headers: _objectSpread(_objectSpread({\n                    Accept: \"application/json\"\n                  }, contentTypeHeaders), request.headers)\n                }));\n\n              case 5:\n                response = _context25.sent;\n                contentType = response.headers.get(\"content-type\");\n\n                if (!(contentType === null || contentType === void 0 ? void 0 : contentType.startsWith(\"application/json\"))) {\n                  _context25.next = 14;\n                  break;\n                }\n\n                _context25.next = 10;\n                return response.json();\n\n              case 10:\n                responseBody = _context25.sent;\n                return _context25.abrupt(\"return\", deserialize(responseBody));\n\n              case 14:\n                if (!(contentType === null)) {\n                  _context25.next = 18;\n                  break;\n                }\n\n                return _context25.abrupt(\"return\", null);\n\n              case 18:\n                throw new Error(\"Expected JSON response, got \\\"\".concat(contentType, \"\\\"\"));\n\n              case 19:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25, this);\n      }));\n\n      function fetchJSON(_x27) {\n        return _fetchJSON.apply(this, arguments);\n      }\n\n      return fetchJSON;\n    }()\n    /**\n     * Fetch an \"event-stream\" resource as an authenticated user.\n     *\n     * @param request The request which should be sent to the server.\n     */\n\n  }, {\n    key: \"fetchStream\",\n    value: function () {\n      var _fetchStream = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee26(request) {\n        var _yield$this$fetch, body;\n\n        return _regeneratorRuntime.wrap(function _callee26$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n                _context26.next = 2;\n                return this.fetch(_objectSpread(_objectSpread({}, request), {}, {\n                  headers: _objectSpread({\n                    Accept: \"text/event-stream\"\n                  }, request.headers)\n                }));\n\n              case 2:\n                _yield$this$fetch = _context26.sent;\n                body = _yield$this$fetch.body;\n                return _context26.abrupt(\"return\", asyncIteratorFromResponseBody(body));\n\n              case 5:\n              case \"end\":\n                return _context26.stop();\n            }\n          }\n        }, _callee26, this);\n      }));\n\n      function fetchStream(_x28) {\n        return _fetchStream.apply(this, arguments);\n      }\n\n      return fetchStream;\n    }()\n    /**\n     * @returns The path of the app route.\n     */\n\n  }, {\n    key: \"appRoute\",\n    get: function get() {\n      return routes.api().app(this.appId);\n    }\n    /**\n     * @returns A promise of the location URL of the app.\n     */\n\n  }, {\n    key: \"locationUrl\",\n    get: function get() {\n      return this.locationUrlContext.locationUrl;\n    }\n  }], [{\n    key: \"buildAuthorizationHeader\",\n    value: function buildAuthorizationHeader(user, tokenType) {\n      if (!user || tokenType === \"none\") {\n        return {};\n      } else if (tokenType === \"access\") {\n        return {\n          Authorization: \"Bearer \".concat(user.accessToken)\n        };\n      } else if (tokenType === \"refresh\") {\n        return {\n          Authorization: \"Bearer \".concat(user.refreshToken)\n        };\n      } else {\n        throw new Error(\"Unexpected token type (\".concat(tokenType, \")\"));\n      }\n    }\n    /**\n     * @param body The body string or object passed from a request.\n     * @returns An object optionally specifying the \"Content-Type\" header.\n     */\n\n  }, {\n    key: \"buildBody\",\n    value: function buildBody(body) {\n      if (!body) {\n        return;\n      } else if (typeof body === \"object\" && body !== null) {\n        return JSON.stringify(serialize(body));\n      } else if (typeof body === \"string\") {\n        return body;\n      } else {\n        console.log(\"body is\", body);\n        throw new Error(\"Unexpected type of body\");\n      }\n    }\n    /**\n     * @param body The body string or object passed from a request.\n     * @returns An object optionally specifying the \"Content-Type\" header.\n     */\n\n  }, {\n    key: \"buildJsonHeader\",\n    value: function buildJsonHeader(body) {\n      if (body && body.length > 0) {\n        return {\n          \"Content-Type\": \"application/json\"\n        };\n      } else {\n        return {};\n      }\n    }\n  }]);\n\n  return Fetcher;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * The key in a storage on which the device id is stored.\n */\n\n\nvar DEVICE_ID_STORAGE_KEY$1 = \"deviceId\";\nvar DeviceFields;\n\n(function (DeviceFields) {\n  DeviceFields[\"DEVICE_ID\"] = \"deviceId\";\n  DeviceFields[\"APP_ID\"] = \"appId\";\n  DeviceFields[\"APP_VERSION\"] = \"appVersion\";\n  DeviceFields[\"PLATFORM\"] = \"platform\";\n  DeviceFields[\"PLATFORM_VERSION\"] = \"platformVersion\";\n  DeviceFields[\"SDK_VERSION\"] = \"sdkVersion\";\n})(DeviceFields || (DeviceFields = {}));\n/**\n * Information describing the device, app and SDK.\n */\n\n\nvar DeviceInformation = /*#__PURE__*/function () {\n  /**\n   * @param params Construct the device information from these parameters.\n   */\n  function DeviceInformation(_ref12) {\n    var appId = _ref12.appId,\n        appVersion = _ref12.appVersion,\n        deviceId = _ref12.deviceId;\n\n    _classCallCheck(this, DeviceInformation);\n\n    /**\n     * The version of the Realm Web SDK (constant provided by Rollup).\n     */\n    this.sdkVersion = \"1.2.1\";\n    var environment = getEnvironment();\n    this.platform = environment.platform;\n    this.platformVersion = environment.platformVersion;\n    this.appId = appId;\n    this.appVersion = appVersion;\n    this.deviceId = deviceId;\n  }\n  /**\n   * @returns An base64 URI encoded representation of the device information.\n   */\n\n\n  _createClass(DeviceInformation, [{\n    key: \"encode\",\n    value: function encode() {\n      var obj = removeKeysWithUndefinedValues(this);\n      return base64.Base64.encode(JSON.stringify(obj));\n    }\n    /**\n     * @returns The defaults\n     */\n\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return removeKeysWithUndefinedValues(this);\n    }\n  }]);\n\n  return DeviceInformation;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Default base url to prefix all requests if no baseUrl is specified in the configuration.\n */\n\n\nvar DEFAULT_BASE_URL = \"https://stitch.mongodb.com\";\n/**\n * MongoDB Realm App\n */\n\nvar App = /*#__PURE__*/function () {\n  /**\n   * Construct a Realm App, either from the Realm App id visible from the MongoDB Realm UI or a configuration.\n   *\n   * @param idOrConfiguration The Realm App id or a configuration to use for this app.\n   */\n  function App(idOrConfiguration) {\n    var _this5 = this;\n\n    _classCallCheck(this, App);\n\n    /**\n     * An array of active and logged-out users.\n     * Elements in the beginning of the array is considered more recent than the later elements.\n     */\n    this.users = [];\n    /**\n     * A promise resolving to the App's location url.\n     */\n\n    this._locationUrl = null; // If the argument is a string, convert it to a simple configuration object.\n\n    var configuration = typeof idOrConfiguration === \"string\" ? {\n      id: idOrConfiguration\n    } : idOrConfiguration; // Initialize properties from the configuration\n\n    if (typeof configuration === \"object\" && typeof configuration.id === \"string\") {\n      this.id = configuration.id;\n    } else {\n      throw new Error(\"Missing a MongoDB Realm app-id\");\n    }\n\n    this.baseUrl = configuration.baseUrl || DEFAULT_BASE_URL;\n    this.localApp = configuration.app;\n    var storage = configuration.storage,\n        _configuration$transp = configuration.transport,\n        transport = _configuration$transp === void 0 ? new DefaultNetworkTransport() : _configuration$transp; // Construct a fetcher wrapping the network transport\n\n    this.fetcher = new Fetcher({\n      appId: this.id,\n      userContext: this,\n      locationUrlContext: this,\n      transport: transport\n    }); // Construct the auth providers\n\n    this.emailPasswordAuth = new EmailPasswordAuth(this.fetcher); // Construct the storage\n\n    var baseStorage = storage || getEnvironment().defaultStorage;\n    this.storage = new AppStorage(baseStorage, this.id);\n    this.authenticator = new Authenticator(this.fetcher, baseStorage, function () {\n      return _this5.deviceInformation;\n    }); // Hydrate the app state from storage\n\n    try {\n      this.hydrate();\n    } catch (err) {\n      // The storage was corrupted\n      this.storage.clear(); // A failed hydration shouldn't throw and break the app experience\n      // Since this is \"just\" persisted state that unfortunately got corrupted or partially lost\n\n      console.warn(\"Realm app hydration failed:\", err.message);\n    }\n  }\n  /**\n   * Get or create a singleton Realm App from an id.\n   * Calling this function multiple times with the same id will return the same instance.\n   *\n   * @param id The Realm App id visible from the MongoDB Realm UI or a configuration.\n   * @returns The Realm App instance.\n   */\n\n\n  _createClass(App, [{\n    key: \"switchUser\",\n    value:\n    /**\n     * Switch user.\n     *\n     * @param nextUser The user or id of the user to switch to.\n     */\n    function switchUser(nextUser) {\n      var index = this.users.findIndex(function (u) {\n        return u === nextUser;\n      });\n\n      if (index === -1) {\n        throw new Error(\"The user was never logged into this app\");\n      } // Remove the user from the stack\n\n\n      var _this$users$splice = this.users.splice(index, 1),\n          _this$users$splice2 = _slicedToArray(_this$users$splice, 1),\n          user = _this$users$splice2[0]; // Insert the user in the beginning of the stack\n\n\n      this.users.unshift(user);\n    }\n    /**\n     * Log in a user.\n     *\n     * @param credentials Credentials to use when logging in.\n     * @param fetchProfile Should the users profile be fetched? (default: true)\n     */\n\n  }, {\n    key: \"logIn\",\n    value: function () {\n      var _logIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee27(credentials) {\n        var fetchProfile,\n            response,\n            user,\n            deviceId,\n            _args27 = arguments;\n        return _regeneratorRuntime.wrap(function _callee27$(_context27) {\n          while (1) {\n            switch (_context27.prev = _context27.next) {\n              case 0:\n                fetchProfile = _args27.length > 1 && _args27[1] !== undefined ? _args27[1] : true;\n                _context27.next = 3;\n                return this.authenticator.authenticate(credentials);\n\n              case 3:\n                response = _context27.sent;\n                user = this.createOrUpdateUser(response, credentials.providerType); // Let's ensure this will be the current user, in case the user object was reused.\n\n                this.switchUser(user); // If neeeded, fetch and set the profile on the user\n\n                if (!fetchProfile) {\n                  _context27.next = 9;\n                  break;\n                }\n\n                _context27.next = 9;\n                return user.refreshProfile();\n\n              case 9:\n                // Persist the user id in the storage,\n                // merging to avoid overriding logins from other apps using the same underlying storage\n                this.storage.setUserIds(this.users.map(function (u) {\n                  return u.id;\n                }), true); // Read out and store the device id from the server\n\n                deviceId = response.deviceId;\n\n                if (deviceId && deviceId !== \"000000000000000000000000\") {\n                  this.storage.set(DEVICE_ID_STORAGE_KEY$1, deviceId);\n                } // Return the user\n\n\n                return _context27.abrupt(\"return\", user);\n\n              case 13:\n              case \"end\":\n                return _context27.stop();\n            }\n          }\n        }, _callee27, this);\n      }));\n\n      function logIn(_x29) {\n        return _logIn.apply(this, arguments);\n      }\n\n      return logIn;\n    }()\n    /**\n     * @inheritdoc\n     */\n\n  }, {\n    key: \"removeUser\",\n    value: function () {\n      var _removeUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee28(user) {\n        var index;\n        return _regeneratorRuntime.wrap(function _callee28$(_context28) {\n          while (1) {\n            switch (_context28.prev = _context28.next) {\n              case 0:\n                // Remove the user from the list of users\n                index = this.users.findIndex(function (u) {\n                  return u === user;\n                });\n\n                if (!(index === -1)) {\n                  _context28.next = 3;\n                  break;\n                }\n\n                throw new Error(\"The user was never logged into this app\");\n\n              case 3:\n                this.users.splice(index, 1); // Log out the user - this removes access and refresh tokens from storage\n\n                _context28.next = 6;\n                return user.logOut();\n\n              case 6:\n                // Remove the users profile from storage\n                this.storage.remove(\"user(\".concat(user.id, \"):profile\")); // Remove the user from the storage\n\n                this.storage.removeUserId(user.id);\n\n              case 8:\n              case \"end\":\n                return _context28.stop();\n            }\n          }\n        }, _callee28, this);\n      }));\n\n      function removeUser(_x30) {\n        return _removeUser.apply(this, arguments);\n      }\n\n      return removeUser;\n    }()\n    /**\n     * The currently active user (or null if no active users exists).\n     *\n     * @returns the currently active user or null.\n     */\n\n  }, {\n    key: \"currentUser\",\n    get: function get() {\n      var activeUsers = this.users.filter(function (user) {\n        return user.state === UserState.Active;\n      });\n\n      if (activeUsers.length === 0) {\n        return null;\n      } else {\n        // Current user is the top of the stack\n        return activeUsers[0];\n      }\n    }\n    /**\n     * All active and logged-out users:\n     *  - First in the list are active users (ordered by most recent call to switchUser or login)\n     *  - Followed by logged out users (also ordered by most recent call to switchUser or login).\n     *\n     * @returns An array of users active or loggedout users (current user being the first).\n     */\n\n  }, {\n    key: \"allUsers\",\n    get: function get() {\n      // Returning a freezed copy of the list of users to prevent outside changes\n      return Object.fromEntries(this.users.map(function (user) {\n        return [user.id, user];\n      }));\n    }\n    /**\n     * @returns A promise of the app URL, with the app location resolved.\n     */\n\n  }, {\n    key: \"locationUrl\",\n    get: function get() {\n      var _this6 = this;\n\n      if (!this._locationUrl) {\n        var path = routes.api().app(this.id).location().path;\n        this._locationUrl = this.fetcher.fetchJSON({\n          method: \"GET\",\n          url: this.baseUrl + path,\n          tokenType: \"none\"\n        }).then(function (_ref13) {\n          var hostname = _ref13.hostname;\n\n          if (typeof hostname !== \"string\") {\n            throw new Error(\"Expected response to contain a 'hostname'\");\n          } else {\n            return hostname;\n          }\n        }).catch(function (err) {\n          // Reset the location to allow another request to fetch again.\n          _this6._locationUrl = null;\n          throw err;\n        });\n      }\n\n      return this._locationUrl;\n    }\n    /**\n     * @returns Information about the current device, sent to the server when authenticating.\n     */\n\n  }, {\n    key: \"deviceInformation\",\n    get: function get() {\n      var deviceIdStr = this.storage.getDeviceId();\n      var deviceId = typeof deviceIdStr === \"string\" && deviceIdStr !== \"000000000000000000000000\" ? new ObjectId(deviceIdStr) : undefined;\n      return new DeviceInformation({\n        appId: this.localApp ? this.localApp.name : undefined,\n        appVersion: this.localApp ? this.localApp.version : undefined,\n        deviceId: deviceId\n      });\n    }\n    /**\n     * Create (and store) a new user or update an existing user's access and refresh tokens.\n     * This helps de-duplicating users in the list of users known to the app.\n     *\n     * @param response A response from the Authenticator.\n     * @param providerType The type of the authentication provider used.\n     * @returns A new or an existing user.\n     */\n\n  }, {\n    key: \"createOrUpdateUser\",\n    value: function createOrUpdateUser(response, providerType) {\n      var existingUser = this.users.find(function (u) {\n        return u.id === response.userId;\n      });\n\n      if (existingUser) {\n        // Update the users access and refresh tokens\n        existingUser.accessToken = response.accessToken;\n        existingUser.refreshToken = response.refreshToken;\n        return existingUser;\n      } else {\n        // Create and store a new user\n        if (!response.refreshToken) {\n          throw new Error(\"No refresh token in response from server\");\n        }\n\n        var user = new User({\n          app: this,\n          id: response.userId,\n          accessToken: response.accessToken,\n          refreshToken: response.refreshToken,\n          providerType: providerType\n        });\n        this.users.unshift(user);\n        return user;\n      }\n    }\n    /**\n     * Restores the state of the app (active and logged-out users) from the storage\n     */\n\n  }, {\n    key: \"hydrate\",\n    value: function hydrate() {\n      var _this7 = this;\n\n      var userIds = this.storage.getUserIds();\n      this.users = userIds.map(function (id) {\n        return new User({\n          app: _this7,\n          id: id\n        });\n      });\n    }\n  }], [{\n    key: \"getApp\",\n    value: function getApp(id) {\n      if (id in App.appCache) {\n        return App.appCache[id];\n      } else {\n        var instance = new App(id);\n        App.appCache[id] = instance;\n        return instance;\n      }\n    }\n  }]);\n\n  return App;\n}();\n/**\n * A map of app instances returned from calling getApp.\n */\n\n\nApp.appCache = {};\n/**\n * Instances of this class can be passed to the `app.logIn` method to authenticate an end-user.\n */\n\nApp.Credentials = Credentials; ////////////////////////////////////////////////////////////////////////////\n\n/**\n * Get or create a singleton Realm App from an id.\n * Calling this function multiple times with the same id will return the same instance.\n *\n * @param id The Realm App id visible from the MongoDB Realm UI or a configuration.\n * @returns The Realm App instance.\n */\n\nfunction getApp(id) {\n  return App.getApp(id);\n} ////////////////////////////////////////////////////////////////////////////\n\n/**\n * In-memory storage that will not be persisted.\n */\n\n\nvar LocalStorage = /*#__PURE__*/function () {\n  /**\n   * Constructs a LocalStorage using the global window.\n   */\n  function LocalStorage() {\n    _classCallCheck(this, LocalStorage);\n\n    if (typeof window === \"object\") {\n      this.window = window;\n    } else {\n      throw new Error(\"Cannot use LocalStorage without a global window object\");\n    }\n  }\n  /** @inheritdoc */\n\n\n  _createClass(LocalStorage, [{\n    key: \"get\",\n    value: function get(key) {\n      return this.window.localStorage.getItem(key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      return this.window.localStorage.setItem(key, value);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"remove\",\n    value: function remove(key) {\n      return this.window.localStorage.removeItem(key);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"prefix\",\n    value: function prefix(keyPart) {\n      return new PrefixedStorage(this, keyPart);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"clear\",\n    value: function clear(prefix) {\n      var keys = []; // Iterate all keys to find the once have a matching prefix.\n\n      for (var i = 0; i < this.window.localStorage.length; i++) {\n        var key = this.window.localStorage.key(i);\n\n        if (key && (!prefix || key.startsWith(prefix))) {\n          keys.push(key);\n        }\n      } // Remove the items in a seperate loop to avoid updating while iterating.\n\n\n      for (var _i3 = 0, _keys = keys; _i3 < _keys.length; _i3++) {\n        var _key5 = _keys[_i3];\n        this.window.localStorage.removeItem(_key5);\n      }\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"addListener\",\n    value: function addListener(listener) {\n      return this.window.addEventListener(\"storage\", listener);\n    }\n    /** @inheritdoc */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(listener) {\n      return this.window.removeEventListener(\"storage\", listener);\n    }\n  }]);\n\n  return LocalStorage;\n}(); ////////////////////////////////////////////////////////////////////////////\n\n\nvar browser = detect();\nvar environment$1 = {\n  defaultStorage: new LocalStorage().prefix(\"realm-web\"),\n  openWindow: function openWindow(url) {\n    return window.open(url);\n  },\n  platform: (browser === null || browser === void 0 ? void 0 : browser.name) || \"web\",\n  platformVersion: (browser === null || browser === void 0 ? void 0 : browser.version) || \"0.0.0\",\n  TextDecoder: TextDecoder\n};\nsetEnvironment(environment$1);\n/**\n * Handle an OAuth 2.0 redirect.\n *\n * @param location An optional location to use (defaults to the windows current location).\n * @param storage Optional storage used to save any results from the location.\n */\n\nfunction handleAuthRedirect() {\n  var location = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : window.location;\n  var storage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : environment$1.defaultStorage;\n\n  try {\n    var queryString = location.hash.substr(1); // Strip the initial # from the hash\n\n    OAuth2Helper.handleRedirect(queryString, storage);\n  } catch (err) {\n    // Ensure calling this never throws: It should not interrupt a users flow.\n    console.warn(err);\n  }\n}\n\nexport { App, Credentials, DEFAULT_BASE_URL, LocalStorage, MongoDBRealmError, User, UserState, UserType$1 as UserType, getApp, getEnvironment, handleAuthRedirect, setEnvironment };","import * as Realm from \"realm-web\";\n\nconst REALM_APP_ID = \"jotter-bdqbf\";\nconst app = new Realm.App({ id: REALM_APP_ID });\n\n\n// Get the API key from the local environment\nconst apiKey = process.env.MDB_AUTH_USER;\nif (!apiKey) {\n  throw new Error(\"Could not find a Realm Server API Key.\");\n}\n// Create an api key credential\nconst credentials = Realm.Credentials.serverApiKey(apiKey);\n\nexport default async function Login() {\n  try {\n    const user = await app.logIn(credentials);\n    return user;    \n  } catch (err) {\n    console.error(\"Failed to log in\", err.message);\n  }\n}\n","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzLjU2OTggOC4xNzVIOC41MTk4NFYxMy4zNUg1Ljg2OTg0VjguMTc1SDAuODE5ODQyVjUuNzc1SDUuODY5ODRWMC41OTk5OTlIOC41MTk4NFY1Ljc3NUgxMy41Njk4VjguMTc1WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==\"","import React from \"react\";\nimport { useAuth0 } from \"../services/auth\";\nimport styled from \"styled-components\";\nimport Login from \"../services/realm/userAuth\";\nimport PlusIcon from \"../assets/plus.svg\";\n\nconst LoginBtn = styled.button`\n  padding: 0.8rem 2rem;\n  border-radius: 2rem;\n  background-color: ${(props) => (props.logOut ? `var(--red)` : \"#1BD692\")};\n  color: white;\n  font-size: 1rem;\n  font-weight: 600;\n\n  &:hover {\n    background-color: ${(props) => (props.logOut ? `var(--red)` : \"#1acf8d\")};\n  }\n`;\n\nexport const LoginButton = () => {\n  const { loginWithRedirect } = useAuth0();\n  const handleSignIn = () => {\n    loginWithRedirect({});\n    Login();\n  };\n\n  return <LoginBtn onClick={() => handleSignIn()}>Sign in</LoginBtn>;\n};\n\nconst AddSign = styled.img`\n  width: 0.8rem;\n`;\n\nconst AddBtn = styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  column-gap: 0.3rem;\n  padding: 0.4rem 0.7rem;\n  border-radius: 2rem;\n  background-color: var(--mid-gray);\n  color: white;\n  font-size: 0.9rem;\n\n  &:hover {\n    background-color: var(--button-hover);\n  }\n`;\n\nexport const AddToLibraryButton = ({handleAddToLibrary}) => {\n  return (\n    <AddBtn onClick={handleAddToLibrary}>\n      <AddSign src={PlusIcon} alt=\"Add icon\" />\n      Library\n    </AddBtn>\n  );\n};\n\nconst ToReadBtn = styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  column-gap: 0.3rem;\n  padding: 0.4rem 0.7rem;\n  border-radius: 2rem;\n  background-color: var(--purple);\n  color: white;\n  font-size: 0.9rem;\n\n  &:hover {\n    background-color: var(--button-hover);\n  }\n`;\n\nexport const AddToReadButton = () => {\n  return (\n    <ToReadBtn>\n      <AddSign src={PlusIcon} alt=\"Add icon\" />\n      To-read\n    </ToReadBtn>\n  );\n};\n","import React from 'react'\nimport styled from \"styled-components\";\n\nconst MainHeader = styled.h1`\n    font-size: 3rem;\n    margin-bottom: 0.5rem;\n`\n\nconst SubHeader = styled.h2`\n    font-weight: 600;   \n    margin-top: 0; \n    margin-bottom: 0;\n`\n\nexport function Heading(props) {\n    return (\n       <MainHeader>{props.children}</MainHeader>\n    )\n}\n\nexport function SubHeading(props) {\n    return (\n        <SubHeader>{props.children}</SubHeader>\n    )\n}\n","import axios from \"axios\";\nimport { baseurl } from \"../../../gatsby-browser\";\n\nexport const getLibrary = async (username) => {\n  try {\n    const books = await axios.get(`${baseurl}library?user=${username}`);\n    return books.data[0].library;\n  } catch (error) {\n    console.error(\"getLibrary error:\", error);\n  }\n};\n\nexport const addBooktoLibrary = async (\n  username,\n  bookTitle,\n  author,\n  year,\n  cover,\n  addDate,\n  isbn\n) => {\n  try {\n    axios\n      .post(`${baseurl}add-book-library`, null, {\n        params: {\n          user: username,\n          title: bookTitle,\n          bookAuthor: author,\n          bookYear: year,\n          bookCover: cover,\n          bookAddedDate: addDate,\n          bookIsbn: isbn,\n        },\n      })\n      .then(console.log(\"added book to library\"));\n  } catch (error) {\n    console.error(\"error (couldn't add book to library):\", error.response);\n  }\n};\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjQzVDNUM1Ij48cGF0aCBkPSJNMTIsMjJjNS40MjEsMCwxMC00LjU3OSwxMC0xMGgtMmMwLDQuMzM3LTMuNjYzLDgtOCw4cy04LTMuNjYzLTgtOGMwLTQuMzM2LDMuNjYzLTgsOC04VjJDNi41NzksMiwyLDYuNTgsMiwxMiBDMiwxNy40MjEsNi41NzksMjIsMTIsMjJ6Ii8+PC9zdmc+\""],"sourceRoot":""}