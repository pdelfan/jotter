{"version":3,"sources":["webpack://jotter/./src/hooks/useFetchPercentageRead.js","webpack://jotter/./src/components/Book/ReadingProgress.js","webpack://jotter/./src/pages/book.js"],"names":["user","id","useState","hasFetched","setHasFetched","data","setData","error","setError","useEffect","getPercentageRead","email","result","console","log","message","fetchData","Container","styled","Info","Title","ProgressBar","Description","Modal","props","out","fadeOut","fadeIn","keyframes","Input","Label","UpdateButton","Submit","percentage","isbn","isOpen","setIsOpen","outside","useRef","progress","setProgress","inputValue","setInputValue","document","addEventListener","e","current","contains","target","ref","value","max","handlePercentage","onClick","placeholder","onChange","preventDefault","updatePercentageRead","then","success","generalError","specificError","location","useAuth0","isAuthenticated","state","useFetchGoogleBook","book","hasFetchedBook","useFetchPercentageRead","read","fetchedPercentageRead","Layout","heading","subheading","BookContainer","cover","title","author","date","desc","category","length","avgRating","ratings","language","username","deleteButton","redirectAfterDelete","minHeight","Loading","src","LoadingIcon","alt","className","Router","path","component","Index"],"mappings":"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","file":"component---src-pages-book-js-642080e70662d01d6ebc.js","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { getPercentageRead } from \"../services/realm/API\";\n\nconst useFetchPercentageRead = (user, id) => {\n  const [hasFetched, setHasFetched] = useState(false);\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (user) {\n        try {\n          setHasFetched(false);\n          let result = await getPercentageRead(user.email, id);\n          setData(result);\n          setHasFetched(true);\n        } catch (error) {\n          console.log(error.message);\n          setError(error.message);\n        }\n      }\n    };\n    fetchData();\n  }, [user, id, data]);\n\n  return { data, hasFetched, error };\n};\n\nexport default useFetchPercentageRead;\n","import React, { useState, useRef, useEffect } from \"react\";\nimport styled, { keyframes } from \"styled-components\";\nimport { updatePercentageRead } from \"../../services/realm/API\";\nimport {\n  generalError,\n  specificError,\n  success,\n} from \"../Notification & Error/Notifications\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  flex: 1;\n  flex-grow: 1;\n  justify-content: space-between;\n  align-items: center;\n  background-color: white;\n  padding: 0.8rem 1.8rem;\n  border: var(--general-border);\n  border-radius: var(--round);\n  box-shadow: var(--general-shadow);\n`;\n\nconst Info = styled.div`\n  flex-grow: 0.7;\n`;\n\nconst Title = styled.h5`\n  font-size: 1.3rem;\n  color: #374151;\n  margin: 0;\n`;\n\nconst ProgressBar = styled.progress`\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  overflow: hidden;\n  border-radius: var(--round);\n  height: 0.7rem;\n  width: 100%;\n  background-color: #c4f1d8; // firefox\n  &::-webkit-progress-bar {\n    background-color: #c4f1d8;\n  }\n\n  &::-webkit-progress-value {\n    background-color: #3aae5b;\n  }\n\n  &::-moz-progress-bar {\n    background-color: #3aae5b;\n  }\n`;\n\nconst Description = styled.p`\n  color: #3aae5b;\n  font-weight: 500;\n  margin: 0;\n`;\n\nconst Modal = styled.div`\n  display: flex;\n  justify-content: space-between;\n  float: right;\n  background-color: white;\n  padding: 0.8rem 1.8rem;\n  margin-top: 0.5rem;\n  border: var(--general-border);\n  border-radius: var(--round);\n  box-shadow: var(--general-shadow);\n  visibility: ${(props) => (props.out ? \"hidden\" : \"visible\")};\n  animation: ${(props) => (props.out ? fadeOut : fadeIn)} 0.1s linear;\n  transition: visibility 0.1s linear;\n`;\n\nconst fadeIn = keyframes`\n  from {\n    transform: scale(0.25);\n    opacity: 0;\n  }\n\n  to {\n    transform: scale(1);\n    opacity: 1;\n  }\n`;\n\nconst fadeOut = keyframes`\n  from {\n    transform: scale(1);\n    opacity: 1;\n  }\n\n  to {\n    transform: scale(.25);\n    opacity: 0;\n  }\n`;\n\nconst Input = styled.input`\n  border-radius: 10rem;\n  border: var(--general-border);\n  font-weight: 600;\n  font-size: 1rem;\n  text-align: center;\n  width: 5rem;\n  color: gray;\n\n  ::placeholder {\n    text-align: center;\n    color: darkgray;\n  }\n`;\n\nconst Label = styled.label`\n  align-self: center;\n  margin-left: 0.3rem;\n  margin-right: 1rem;\n  color: #949494;\n  font-weight: 600;\n`;\n\nconst UpdateButton = styled.button`\n  background-color: #e9edf1;\n  color: #5a5c62;\n  font-weight: 600;\n  font-size: 1rem;\n  padding: 0.4rem 0.7rem;\n  border-radius: 0.9rem;\n\n  &:hover {\n    background-color: #d6dce0;\n  }\n`;\n\nconst Submit = styled.button`\n  background-color: #3aae5b;\n  color: white;\n  font-weight: 600;\n  font-size: 1rem;\n  padding: 0.4rem 0.7rem;\n  margin-left: 1rem;\n  border-radius: 0.9rem;\n\n  &:hover {\n    background-color: #37a556;\n  }\n`;\n\nconst ReadingProgress = ({ percentage, user, isbn }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const outside = useRef();\n  const [progress, setProgress] = useState(percentage);\n  const [inputValue, setInputValue] = useState(\"\");\n  const onChange = (e) => {\n    setInputValue(e.target.value);\n  };\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    updatePercentageRead(user, isbn, inputValue).then(\n      () => {\n        setIsOpen(false);\n        setProgress(inputValue);\n        setInputValue(\"\");\n        success(\"Your reading progress has been updated\");\n      },\n      (error) => {\n        if (error === 400) {\n          generalError(\n            \"Invalid request: Couldn't update your reading progress.\"\n          );\n        } else {\n          specificError(\n            error,\n            \"Something went wrong. Check your internet connection and try again.\"\n          );\n        }\n      }\n    );\n  };\n\n  useEffect(() => {\n    const handleClick = (e) => {\n      if (!outside?.current?.contains(e.target)) {\n        setIsOpen(false);\n        setInputValue(\"\");\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClick);\n  }, [outside, progress]);\n\n  function handlePercentage(progress) {\n    if (progress === \"0\") {\n      return \"Not read\";\n    } else if (progress === \"100\") {\n      return \"Completed\";\n    } else {\n      return `${progress}% read`;\n    }\n  }\n  return (\n    <div ref={outside}>\n      <Container>\n        <Info>\n          <Title>Reading Progress</Title>\n          <ProgressBar value={progress} max=\"100\" />\n          <Description>{handlePercentage(progress)}</Description>\n        </Info>\n        <UpdateButton onClick={() => setIsOpen(!isOpen)}>Update</UpdateButton>\n      </Container>\n      <Modal out={!isOpen}>\n        <Input placeholder={progress} onChange={onChange} value={inputValue} />\n        <Label>%</Label>\n        <Submit onClick={handleSubmit}>Submit</Submit>\n      </Modal>\n    </div>\n  );\n};\n\nexport default ReadingProgress;\n","import React from \"react\";\nimport Layout from \"../components/Page/Layout\";\nimport Header from \"../components/Page/Headings\";\nimport { useAuth0 } from \"../services/auth\";\nimport LoadingIcon from \"../assets/loading.svg\";\nimport PrivateRoute, { RedirectHome } from \"../components/Routing\";\nimport Index from \"../pages/index\";\nimport { Router } from \"@reach/router\";\nimport { BookContainer } from \"../components/Book/BookContainer\";\nimport { Wrapper, Loading } from \"../components/Notification & Error/Loading\";\nimport useFetchGoogleBook from \"../hooks/useFetchGoogleBook\";\nimport useFetchPercentageRead from \"../hooks/useFetchPercentageRead\";\nimport ReadingProgress from \"../components/Book/ReadingProgress\";\n\nconst Book = ({ location }) => {\n  const { isAuthenticated, user } = useAuth0();\n  const isbn = location.state ? location.state.isbn : \"\";\n  const { data: book, hasFetched: hasFetchedBook } = useFetchGoogleBook(isbn);\n  const { data: read, hasFetched: fetchedPercentageRead } =\n    useFetchPercentageRead(user, isbn);\n\n  if (location.state === null) {\n    return <RedirectHome />;\n  } else if (isAuthenticated && isbn !== null) {\n    return (\n      <Layout heading=\"Book\" subheading=\"In your library\">\n        {hasFetchedBook && fetchedPercentageRead && (\n          <BookContainer\n            cover={book.cover}\n            title={book.title}\n            author={book.author}\n            date={book.date}\n            desc={book.desc}\n            category={book.category}\n            length={book.length}\n            avgRating={book.avgRating}\n            ratings={book.ratings}\n            language={book.language}\n            isbn={book.isbn}\n            username={user.email}\n            deleteButton={true}\n            redirectAfterDelete={\"/library\"}\n          >\n            <ReadingProgress\n              percentage={read}\n              isbn={book.isbn}\n              user={user.email}\n            />\n          </BookContainer>\n        )}\n\n        {!hasFetchedBook && (\n          <Wrapper minHeight=\"50vh\">\n            <Loading\n              minHeight=\"30vh\"\n              src={LoadingIcon}\n              alt=\"Loading icon\"\n              className=\"rotating\"\n            />\n          </Wrapper>\n        )}\n        <Header heading=\"Notes\" subheading=\"All your notes on this book\" />\n      </Layout>\n    );\n  } else {\n    return (\n      <Router>\n        <PrivateRoute path=\"/book\" component={Index} />\n      </Router>\n    );\n  }\n};\n\nexport default Book;\n"],"sourceRoot":""}