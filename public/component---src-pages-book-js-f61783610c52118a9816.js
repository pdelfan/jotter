(self.webpackChunkjotter=self.webpackChunkjotter||[]).push([[353],{233:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return K}});var n=r(7294),o=r(655),a=r(3835),i=r(2352),l=r(9450),d=r(3650),s=r(7766),c=r(2137),m=r(7757),u=r.n(m),g=function(e,t,r){var o=(0,n.useState)(!1),i=o[0],l=o[1],d=(0,n.useState)(null),s=d[0],m=d[1],g=(0,n.useState)(null),p=g[0],f=g[1],h=(0,n.useState)(!1),b=h[0],v=h[1],y=(0,a.D3)().user;return(0,n.useEffect)((function(){var n=function(){var r=(0,c.Z)(u().mark((function r(){var n;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l(!1),v(!0),r.prev=2,r.next=5,t(y.email,e);case 5:n=r.sent,m(n),l(!0),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(2),f(r.t0.message);case 13:v(!1);case 14:case"end":return r.stop()}}),r,null,[[2,10]])})));return function(){return r.apply(this,arguments)}}();r?null!=y&&y.email&&n():v(!0)}),[t,e,r,null==y?void 0:y.email]),{data:s,hasFetched:i,error:p,loading:b}},p=r(508),f=r(9925),h=r(863),b=r(2891),v=f.ZP.div.withConfig({displayName:"ReadingProgress__Container",componentId:"zzd239-0"})(["display:flex;flex-wrap:wrap;flex:1;flex-grow:1;row-gap:1rem;justify-content:space-between;align-items:center;background-color:#fdfdfd;padding:0.8rem 1.8rem;border:var(--gray-border);border-radius:var(--round);"]),y=f.ZP.div.withConfig({displayName:"ReadingProgress__Info",componentId:"zzd239-1"})(["flex-grow:0.7;"]),w=f.ZP.h5.withConfig({displayName:"ReadingProgress__Title",componentId:"zzd239-2"})(["font-size:1.3rem;color:#333;margin-bottom:0.5rem;margin-top:0;"]),_=f.ZP.p.withConfig({displayName:"ReadingProgress__Description",componentId:"zzd239-3"})(["color:#3aae5b;font-weight:700;margin-top:0.5rem;margin-bottom:0;"]),E=f.ZP.div.withConfig({displayName:"ReadingProgress__Modal",componentId:"zzd239-4"})(["display:flex;justify-content:space-between;float:right;background-color:#fdfdfd;padding:0.8rem 1.8rem;margin-top:0.5rem;border:var(--gray-border);box-shadow:var(--general-shadow);visibility:",";animation:"," 0.1s linear;transition:visibility 0.1s linear;"],(function(e){return e.out?"hidden":"visible"}),(function(e){return e.out?x:k})),k=(0,f.F4)(["from{transform:scale(0.25);opacity:0;}to{transform:scale(1);opacity:1;}"]),x=(0,f.F4)(["from{transform:scale(1);opacity:1;}to{transform:scale(.25);opacity:0;}"]),C=f.ZP.input.withConfig({displayName:"ReadingProgress__Input",componentId:"zzd239-5"})(["border:var(--gray-border);font-weight:bold;font-size:1rem;text-align:center;max-width:5rem;color:gray;::placeholder{text-align:center;color:darkgray;}"]),z=f.ZP.label.withConfig({displayName:"ReadingProgress__Label",componentId:"zzd239-6"})(["align-self:center;margin-left:0.3rem;margin-right:1rem;color:#949494;font-weight:600;"]),I=f.ZP.button.withConfig({displayName:"ReadingProgress__UpdateButton",componentId:"zzd239-7"})(["background-color:transparent;border:2px solid #888;color:#888;font-size:1rem;font-weight:bold;padding:0.4rem 0.7rem;&:hover{border:2px solid #555;color:#555;}"]),N=f.ZP.button.withConfig({displayName:"ReadingProgress__Submit",componentId:"zzd239-8"})(["background-color:transparent;border:2px solid #3aae5b;color:#3aae5b;font-weight:bold;font-size:1rem;padding:0.4rem 0.7rem;margin-left:1rem;&:hover{border:2px solid #31944d;color:#31944d;}"]),P=function(e){var t=e.percentage,r=e.user,o=e.isbn,a=(0,n.useState)(!1),i=a[0],l=a[1],d=(0,n.useRef)(),s=(0,n.useState)(parseInt(t)),c=s[0],m=s[1],u=(0,n.useState)(""),g=u[0],f=u[1];return(0,n.useEffect)((function(){document.addEventListener("mousedown",(function(e){var t;null!=d&&null!==(t=d.current)&&void 0!==t&&t.contains(e.target)||(l(!1),f(""))}))}),[d,c]),n.createElement("div",{ref:d},n.createElement(v,null,n.createElement(y,null,n.createElement(w,null,"Reading Progress"),n.createElement(b.k,{value:c,max:"100"}),n.createElement(_,null,function(e){return 0===e?"Not read":100===e?"Completed":e+"% read"}(c))),n.createElement(I,{onClick:function(){return l(!i)}},"Update")),n.createElement(E,{out:!i},n.createElement(C,{type:"text",pattern:"^[0-9]*$",placeholder:c,onChange:function(e){e.target.validity.patternMismatch||f(e.target.value)},value:g}),n.createElement(z,null,"%"),n.createElement(N,{onClick:function(e){e.preventDefault(),""===g?(0,h.Kp)("You must enter a number before submitting."):g<0||g>100?(0,h.Kp)("Make sure your input is a number and between 0 to 100."):(0,p._J)(r,o,g).then((function(){l(!1),m(parseInt(g)),f(""),(0,h.Vp)("Your reading progress has been updated")}),(function(e){400===e?(0,h.GU)("Invalid request: Couldn't update your reading progress."):(0,h.HJ)(e,"Something went wrong. Check your internet connection and try again.")}))}},"Submit")))},Z=r(6471),R=r(5444),D=f.ZP.div.withConfig({displayName:"Note__NoteContainer",componentId:"sc-1ptx9dd-0"})(["display:flex;flex-wrap:wrap;margin-top:3rem;gap:1rem;"]),S=(0,f.ZP)(R.Link).withConfig({displayName:"Note__Wrapper",componentId:"sc-1ptx9dd-1"})(["   padding:1rem;border:var(--purple-border);border-radius:var(--round);&:hover{border:var(--purple-border-hover);}"]),F=f.ZP.h5.withConfig({displayName:"Note__Title",componentId:"sc-1ptx9dd-2"})(["color:#4C3E67;font-size:1.3rem;font-weight:600;margin:0;max-width:25rem;"]),L=f.ZP.h6.withConfig({displayName:"Note__Date",componentId:"sc-1ptx9dd-3"})(["color:#4C3E67;font-size:0.9rem;font-weight:normal;margin-top:1rem;margin-bottom:0;"]),j=function(e){var t=e.title,r=e.date,o=e.noteID,a=e.bookID;return n.createElement(S,{to:"/note?book="+a+"&note="+o},n.createElement(F,null,t),n.createElement(L,null,r))},A=r(9188),B=r(4816),H=r(2163),M=(0,f.ZP)(R.Link).withConfig({displayName:"book__AddNoteButton",componentId:"sc-14e1zmi-0"})(["display:flex;align-items:center;justify-content:space-between;column-gap:0.3rem;background-color:white;color:#6b6b6b;font-weight:bold;padding:0.5rem 1rem;border:var(--gray-border);box-shadow:var(--general-shadow);&:hover{border:var(--gray-border-hover);color:#555;}"]),T=f.ZP.h3.withConfig({displayName:"book__NoNotesMessage",componentId:"sc-14e1zmi-1"})(["color:#888;font-weight:normal;font-size:1.3rem;margin:2rem auto;"]),K=function(e){var t=e.location,r=H.parse(t.search).id,c=(0,a.D3)(),m=c.isAuthenticated,u=c.user,f=(0,s.Z)(r),h=f.data,b=f.hasFetched,v=g(r,p.T_,m),y=v.data,w=v.hasFetched,_=g(r,p.Kk,m),E=_.data,k=_.hasFetched;return null===r?n.createElement(B.Cq,null):n.createElement(o.Z,{title:"Library â€” Book"},n.createElement(Z.Z,{header:"Book",subheader:"In your library"}),b&&n.createElement(l.H,{cover:h.cover,title:h.title,author:h.author,date:h.date,desc:h.desc,category:h.category,length:h.length,avgRating:h.avgRating,ratings:h.ratings,language:h.language,isbn:h.isbn,username:u.email,deleteButton:!0,redirectAfterDelete:"/"},w&&n.createElement(P,{percentage:y,isbn:h.isbn,user:u.email})),!b&&n.createElement(d.i,{minHeight:"50vh"},n.createElement(d.g,{minHeight:"30vh",src:i.Z,alt:"Loading icon",className:"rotating"})),n.createElement(Z.Z,{header:"Notes",subheader:"All your notes on this book"},n.createElement(M,{to:"/add-note",state:{isbn:r,user:u}},n.createElement(A.dt,{color:"#6b6b6b"}),"Add Note")),k&&n.createElement(D,null,E.map((function(e){return n.createElement(j,{title:e.noteTitle,date:e.date,key:e._noteID,noteID:e._noteID,bookID:r})})),0===E.length&&n.createElement(T,null,"You don't have any notes for this book yet.")))}}}]);
//# sourceMappingURL=component---src-pages-book-js-f61783610c52118a9816.js.map